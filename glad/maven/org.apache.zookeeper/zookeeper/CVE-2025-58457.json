{
  "Identifier": "CVE-2025-58457",
  "PackageSlug": "maven/org.apache.zookeeper/zookeeper",
  "Title": "Apache ZooKeeper: Insufficient Permission Check in AdminServer Snapshot/Restore Commands",
  "Description": "Improper permission checks in the AdminServer allow an authenticated client with insufficient privileges to invoke the `snapshot` and `restore` commands. The intended requirement is authentication and authorization on the root path (`/`) with **ALL** permission for these operations; however, affected versions permit invocation without that level of authorization. The primary risk is disclosure of cluster state via snapshots to a lesser-privileged client.\n\n*   **Affected:** `org.apache.zookeeper:zookeeper` 3.9.0 through 3.9.3.\n*   **Fixed:** 3.9.4 (ZOOKEEPER-4964 “check permissions individually during admin server auth”).\n*   **Mitigations:**\n*   Disable both commands (`admin.snapshot.enabled`, `admin.restore.enabled`).\n*   Disable AdminServer (`admin.enableServer`).\n*   Ensure the root ACL is not open; note that ZooKeeper ACLs are not recursive.\n*   Upgrade to 3.9.4.",
  "Date": "2025-09-26",
  "Pubdate": "2025-09-24",
  "AffectedRange": "[3.9.0,3.9.4)",
  "FixedVersions": [
    "3.9.4"
  ],
  "AffectedVersions": "All versions starting from 3.9.0 before 3.9.4",
  "NotImpacted": "All versions before 3.9.0, all versions starting from 3.9.4",
  "Solution": "Upgrade to version 3.9.4 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-58457",
    "https://github.com/advisories/GHSA-2hmj-97jw-28jh",
    "https://github.com/apache/zookeeper",
    "https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx",
    "https://zookeeper.apache.org/doc/current/zookeeperSnapshotAndRestore.html",
    "https://zookeeper.apache.org/doc/r3.9.4/releasenotes.html",
    "https://zookeeper.apache.org/security.html#CVE-2025-58457"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
  "UUID": "460399c9-5829-41f7-b47f-a6fba7970238"
}