{
  "Identifier": "CVE-2024-37899",
  "PackageSlug": "maven/org.xwiki.platform/xwiki-platform-oldcore",
  "Title": "XWiki Platform allows remote code execution from user account",
  "Description": "When an admin disables a user account, the user's profile is executed with the admin's rights. This allows a user to place malicious code in the user profile before getting an admin to disable the user account.\n\nTo reproduce, as a user without script nor programming rights, edit the about section of your user profile and add `{{groovy}}services.logging.getLogger(\"attacker\").error(\"Hello from Groovy!\"){{/groovy}}`.\nAs an admin, go to the user profile and click the \"Disable this account\" button.\nThen, reload the page. If the logs show `attacker - Hello from Groovy!` then the instance is vulnerable.",
  "Date": "2025-02-05",
  "Pubdate": "2024-06-20",
  "AffectedRange": "[13.4.7,14.10.21),[13.10.3,14.10.21),[15.0-rc-1,15.5.5),[15.6-rc-1,15.10.6),[16.0.0-rc-1,16.0.0)",
  "FixedVersions": [
    "14.10.21",
    "14.10.21",
    "15.5.5",
    "15.10.6",
    "16.0.0"
  ],
  "AffectedVersions": "All versions starting from 15.0-rc-1 before 15.5.5, all versions starting from 15.6-rc-1 before 15.10.6, all versions starting from 13.4.7 before 14.10.21, all versions starting from 13.10.3 before 14.10.21, all versions starting from 16.0.0-rc-1 before 16.0.0",
  "NotImpacted": "All versions before 15.0-rc-1, all versions starting from 15.5.5 before 15.6-rc-1, all versions starting from 15.10.6 before 13.4.7, all versions starting from 14.10.21 before 13.10.3, all versions starting from 14.10.21 before 16.0.0-rc-1, all versions starting from 16.0.0",
  "Solution": "Upgrade to versions 14.10.21, 14.10.21, 15.10.6, 15.5.5, 16.0.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-37899",
    "https://github.com/advisories/GHSA-j584-j2vj-3f93",
    "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j584-j2vj-3f93",
    "https://github.com/xwiki/xwiki-platform/commit/046c36519a2df392c922c16d0d38472b98c414d0",
    "https://github.com/xwiki/xwiki-platform/commit/233b08b26580df4b7a595882dac65ed4e4a2419c",
    "https://github.com/xwiki/xwiki-platform/commit/2b55c29562ccd20f8f0f85075f0c95b4ee9cd9be",
    "https://github.com/xwiki/xwiki-platform/commit/f8409419c5d0ddefe1bee55e73629a54275fa735",
    "https://github.com/xwiki/xwiki-platform/commit/f89c8f47fad6e5cc7e68c69a7e0acde07f5eed5a",
    "https://github.com/xwiki/xwiki-platform",
    "https://jira.xwiki.org/browse/XWIKI-21611"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
  "UUID": "b279b709-850d-45d4-9f45-4996418349ef"
}