{
  "Identifier": "CVE-2024-31987",
  "PackageSlug": "maven/org.xwiki.platform/xwiki-platform-oldcore",
  "Title": "XWiki Platform remote code execution from account via custom skins support",
  "Description": "Any user who can edit any page like their profile can create a custom skin with a template override that is executed with programming right, thus allowing remote code execution.\n\nTo reproduce, as a user without edit, script or admin right, add an object of class `XWiki.XWikiSkins` to your profile. Name it whatever you want and set the Base Skin to `flamingo`.\nAdd an object of class `XWikiSkinFileOverrideClass` and set the path to `macros.vm` and the content to:\n```",
  "Date": "2024-04-10",
  "Pubdate": "2024-04-10",
  "AffectedRange": "[6.4-milestone-1,14.10.19),[15.0-rc-1,15.5.4),[15.6-rc-1,15.10-rc-1)",
  "FixedVersions": [
    "14.10.19",
    "15.5.4",
    "15.10-rc-1"
  ],
  "AffectedVersions": "All versions starting from 6.4-milestone-1 before 14.10.19, all versions starting from 15.0-rc-1 before 15.5.4, all versions starting from 15.6-rc-1 before 15.10-rc-1",
  "NotImpacted": "All versions before 6.4-milestone-1, all versions starting from 14.10.19 before 15.0-rc-1, all versions starting from 15.5.4 before 15.6-rc-1, all versions starting from 15.10-rc-1",
  "Solution": "Upgrade to versions 14.10.19, 15.10-rc-1, 15.5.4 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-31987",
    "https://github.com/advisories/GHSA-cv55-v6rw-7r5v",
    "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cv55-v6rw-7r5v",
    "https://github.com/xwiki/xwiki-platform/commit/3d4dbb41f52d1a6e39835cfb1695ca6668605a39",
    "https://github.com/xwiki/xwiki-platform/commit/626d2a5dbf95b4e719ae13bf1a0a9c76e4edd5a2",
    "https://github.com/xwiki/xwiki-platform/commit/da177c3c972e797d92c1a31e278f946012c41b56",
    "https://github.com/xwiki/xwiki-platform",
    "https://jira.xwiki.org/browse/XWIKI-21478"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
  "UUID": "e0503432-b85c-4661-ac34-1879af89370f"
}