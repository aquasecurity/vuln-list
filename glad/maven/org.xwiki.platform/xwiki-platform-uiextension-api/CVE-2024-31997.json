{
  "Identifier": "CVE-2024-31997",
  "PackageSlug": "maven/org.xwiki.platform/xwiki-platform-uiextension-api",
  "Title": "XWiki Platform remote code execution from account through UIExtension parameters",
  "Description": "Parameters of UI extensions are always interpreted as Velocity code and executed with programming rights. Any user with edit right on any document like the user's own profile can create UI extensions. This allows remote code execution and thereby impacts the confidentiality, integrity and availability of the whole XWiki installation.\n\nTo reproduce, edit your user profile with the object editor and add a UIExtension object with the following values:\n```\nExtension Point ID: org.xwiki.platform.panels.Applications\nExtension ID: platform.panels.myFakeApplication\nExtension parameters:\nlabel=I got programming right: $services.security.authorization.hasAccess('programming')\ntarget=Main.WebHome\ntargetQueryString=\nicon=icon:bomb\nExtension Scope: \"Current User\".\n```\n\nSave the document and open any document. If an application entry with the text \"I got programming right: true\" is displayed, the attack succeeded, if the code in \"label\" is displayed literally, the XWiki installation isn't vulnerable.",
  "Date": "2024-04-10",
  "Pubdate": "2024-04-10",
  "AffectedRange": "[,14.10.19),[15.0-rc-1,15.5.4),[15.6-rc-1,15.9-rc-1)",
  "FixedVersions": [
    "14.10.19",
    "15.5.4",
    "15.9-rc-1"
  ],
  "AffectedVersions": "All versions starting from 15.0-rc-1 before 15.5.4, all versions starting from 15.6-rc-1 before 15.9-rc-1, all versions before 14.10.19",
  "NotImpacted": "All versions before 15.0-rc-1, all versions starting from 15.5.4 before 15.6-rc-1, all versions starting from 15.9-rc-1 before 0, all versions starting from 14.10.19",
  "Solution": "Upgrade to versions 14.10.19, 15.5.4, 15.9-rc-1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-31997",
    "https://github.com/advisories/GHSA-c2gg-4gq4-jv5j",
    "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-c2gg-4gq4-jv5j",
    "https://github.com/xwiki/xwiki-platform/commit/171e7c7d0e56deaa7b3678657ae26ef95379b1ea",
    "https://github.com/xwiki/xwiki-platform/commit/1b2574eb966457ca4ef34e557376b8751d1be90d",
    "https://github.com/xwiki/xwiki-platform/commit/56748e154a9011f0d6239bec0823eaaeab6ec3f7",
    "https://github.com/xwiki/xwiki-platform",
    "https://jira.xwiki.org/browse/XWIKI-21335"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
  "UUID": "85e0c098-d4af-4819-80d5-a256d662a9d2"
}