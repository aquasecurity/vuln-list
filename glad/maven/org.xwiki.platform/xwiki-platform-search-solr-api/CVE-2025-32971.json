{
  "Identifier": "CVE-2025-32971",
  "PackageSlug": "maven/org.xwiki.platform/xwiki-platform-search-solr-api",
  "Title": "Solr script service doesn't take dropped programming right into account",
  "Description": "The Solr script service that is accessible in XWiki's scripting API normally requires programming right to be called. Due to using the wrong API for checking rights, it doesn't take the fact into account that programming rights might have been dropped by calling `$xcontext.dropPermissions()`. If some code relies on this for the safety of executing Velocity code with the wrong author context, this could allow a user with script right to either cause a high load by indexing documents or to temporarily remove documents from the search index. We're not aware that this is exploitable in XWiki itself.\n\nTo reproduce, a user with programming right can add the following XWiki syntax to a page:\n```\n{{velocity}}\n$xcontext.dropPermissions()\n$services.solr.index('document:xwiki:Main.WebHome')\n{{/velocity}}\n```\n\nThis should trigger an error in XWiki's log, otherwise the installation is vulnerable.",
  "Date": "2025-04-30",
  "Pubdate": "2025-04-29",
  "AffectedRange": "[4.5.1,15.10.13),[16.0.0-rc-1,16.4.4),[16.5.0-rc-1,16.8.0-rc-1)",
  "FixedVersions": [
    "15.10.13",
    "16.4.4",
    "16.8.0-rc-1"
  ],
  "AffectedVersions": "All versions starting from 4.5.1 before 15.10.13, all versions starting from 16.0.0-rc-1 before 16.4.4, all versions starting from 16.5.0-rc-1 before 16.8.0-rc-1",
  "NotImpacted": "All versions before 4.5.1, all versions starting from 15.10.13 before 16.0.0-rc-1, all versions starting from 16.4.4 before 16.5.0-rc-1, all versions starting from 16.8.0-rc-1",
  "Solution": "Upgrade to versions 15.10.13, 16.4.4, 16.8.0-rc-1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-32971",
    "https://github.com/advisories/GHSA-987p-r3jc-8c8v",
    "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-987p-r3jc-8c8v",
    "https://github.com/xwiki/xwiki-platform/commit/6570f40f976aec82baf388b5239d1412cab238c9",
    "https://github.com/xwiki/xwiki-platform",
    "https://jira.xwiki.org/browse/XWIKI-22474"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L",
  "UUID": "34703dea-ee16-4b23-b127-5e52ce600e26"
}