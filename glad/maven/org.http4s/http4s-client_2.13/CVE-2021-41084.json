{
  "Identifier": "CVE-2021-41084",
  "PackageSlug": "maven/org.http4s/http4s-client_2.13",
  "Title": "Response Splitting from unsanitized headers",
  "Description": "http4s is vulnerable to response-splitting or request-splitting attacks when untrusted user input is used to create any of the following fields:\n\n* Header names (`Header.name`å\n* Header values (`Header.value`)\n* Status reason phrases (`Status.reason`)\n* URI paths (`Uri.Path`)\n* URI authority registered names (`URI.RegName`) (through 0.21)\n\nThe following backends render invalid carriage return, newline, or null characters in an unsafe fashion.\n\n|                | blaze-server | ember-server | blaze-client | ember-client | jetty-client |\n|:---------------|:-------------|:-------------|:-------------|--------------|--------------|\n| header names   | ⚠            | ⚠            | ⚠            | ⚠            |   ⚠            |\n| header values  | ⚠            | ⚠            | ⚠            | ⚠            |              |\n| status reasons | ⚠            | ⚠            |              |              |              |\n| URI paths      |              |              |  ⚠             |  ⚠             |              |\n| URI regnames   |              |              |  ⚠ \u003c 0.22           |  ⚠ \u003c 0.22            |              |\n\nFor example, given the following service:\n\n```scala\nimport cats.effect._\nimport org.http4s._\nimport org.http4s.dsl.io._\nimport org.http4s.server.blaze.BlazeServerBuilder\nimport scala.concurrent.ExecutionContext.global\n\nobject ResponseSplit extends IOApp {\noverride def run(args: List[String]): IO[ExitCode] =\nBlazeServerBuilder[IO](global)\n.bindHttp(8080)\n.withHttpApp(httpApp)\n.resource\n.use(_ =\u003e IO.never)\n\nval httpApp: HttpApp[IO] =\nHttpApp[IO] { req =\u003e\nreq.params.get(\"author\") match {\ncase Some(author) =\u003e\nOk(\"The real content\")\n.map(_.putHeaders(Header(\"Set-Cookie\", s\"author=${author}\")))\ncase None =\u003e\nBadRequest(\"No author parameter\")\n}\n}\n}\n```\n\nA clean `author` parameter returns a clean response:\n\n```sh\ncurl -i 'http://localhost:8080/?author=Ross'\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: text/plain; charset=UTF-8\nSet-Cookie: author=Ross\nDate: Mon, 20 Sep 2021 04:12:10 GMT\nContent-Length: 16\n\nThe real content\n```\n\nA malicious `author` parameter allows a user-agent to hijack the response from our server and return different content:\n\n```sh\ncurl -i 'http://localhost:8080/?author=hax0r%0d%0aContent-Length:+13%0d%0a%0aI+hacked+you'\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: text/plain; charset=UTF-8\nSet-Cookie: author=hax0r\nContent-Length: 13\n\nI hacked you\n```",
  "Date": "2025-12-11",
  "Pubdate": "2021-09-22",
  "AffectedRange": "[,0.21.29),[0.22.0,0.22.5),[0.23.0,0.23.4)",
  "FixedVersions": [
    "0.21.29",
    "0.22.5",
    "0.23.4"
  ],
  "AffectedVersions": "All versions before 0.21.29, all versions starting from 0.22.0 before 0.22.5, all versions starting from 0.23.0 before 0.23.4",
  "NotImpacted": "All versions starting from 0.21.29 before 0.22.0, all versions starting from 0.22.5 before 0.23.0, all versions starting from 0.23.4",
  "Solution": "Upgrade to versions 0.21.29, 0.22.5, 0.23.4 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-41084",
    "https://github.com/advisories/GHSA-5vcm-3xc3-w7x3",
    "https://github.com/http4s/http4s/security/advisories/GHSA-5vcm-3xc3-w7x3",
    "https://github.com/http4s/http4s/commit/d02007db1da4f8f3df2dbf11f1db9ac7afc3f9d8",
    "https://github.com/http4s/http4s",
    "https://httpwg.org/http-core/draft-ietf-httpbis-semantics-latest.html#fields.values",
    "https://owasp.org/www-community/attacks/HTTP_Response_Splitting"
  ],
  "CvssV2": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N",
  "UUID": "e73dee3f-e2c8-4b2f-8ccc-14cac09b03fb"
}