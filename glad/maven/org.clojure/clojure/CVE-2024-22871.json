{
  "Identifier": "CVE-2024-22871",
  "PackageSlug": "maven/org.clojure/clojure",
  "Title": "Reading specially crafted serializable objects from an untrusted source may cause an infinite loop and denial of service",
  "Description": "Any program on the JVM may read serialized objects via [java.io.ObjectInputStream.readObject()](https://docs.oracle.com/javase/8/docs/api/java/io/ObjectInputStream.html#readObject--). Reading serialized objects from an untrusted source is **inherently unsafe** (this affects any program running on any version of the JVM) and is a prerequisite for this vulnerability.\n\nClojure classes that represent infinite seqs (Cycle, infinite Repeat, and Iterate) do not define hashCode() and use the parent ASeq.hashCode(), which walks the seq to compute the hash, yielding an infinite loop. Classes like java.util.HashMap call hashCode() on keys during deserialization of a serialized map. \n\nThe exploit requires:\n\n1. Crafting a serialized HashMap object with an infinite seq object as a key.\n2. Sending that to a program that reads serialized objects via ObjectInputStream.readObject().\n\nThis will cause the program to enter an infinite loop on the reading thread and thus a denial of service (DoS).\n\nThe affected Clojure classes (Cycle, Repeat, Iterate) exist in Clojure 1.2.0-1.12.0-alpha8.",
  "Date": "2024-03-05",
  "Pubdate": "2024-02-29",
  "AffectedRange": "[1.2.0,1.12.0-alpha8]",
  "FixedVersions": [],
  "AffectedVersions": "All versions starting from 1.2.0 up to 1.12.0-alpha8",
  "NotImpacted": "",
  "Solution": "Unfortunately, there is no solution available yet.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-22871",
    "https://github.com/advisories/GHSA-vr64-r9qj-h27f",
    "https://clojure.atlassian.net/browse/CLJ-2839",
    "https://github.com/clojure/clojure",
    "https://hackmd.io/%40fe1w0/rymmJGida"
  ],
  "CvssV2": "",
  "CvssV3": "",
  "UUID": "ab6d6184-9af2-4390-97cc-e842015100d0"
}