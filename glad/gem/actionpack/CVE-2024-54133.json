{
  "Identifier": "CVE-2024-54133",
  "PackageSlug": "gem/actionpack",
  "Title": "Possible Content Security Policy bypass in Action Dispatch",
  "Description": "There is a possible Cross Site Scripting (XSS) vulnerability  in the `content_security_policy` helper in Action Pack.\n\nImpact\n------\nApplications which set Content-Security-Policy (CSP) headers dynamically from untrusted user input may be vulnerable to carefully crafted inputs being able to inject new directives into the CSP. This could lead to a bypass of the CSP and its protection against XSS and other attacks.\n\nReleases\n--------\nThe fixed releases are available at the normal locations.\n\nWorkarounds\n-----------\nApplications can avoid setting CSP headers dynamically from untrusted input, or can validate/sanitize that input.\n\nCredits\n-------\nThanks to [ryotak](https://hackerone.com/ryotak) for the report!",
  "Date": "2025-03-07",
  "Pubdate": "2024-12-10",
  "AffectedRange": "\u003e=5.2.0 \u003c7.0.8.7||\u003e=7.1.0 \u003c7.1.5.1||\u003e=7.2.0 \u003c7.2.2.1||\u003e=8.0.0 \u003c8.0.0.1",
  "FixedVersions": [
    "7.0.8.7",
    "7.1.5.1",
    "7.2.2.1",
    "8.0.0.1"
  ],
  "AffectedVersions": "All versions starting from 5.2.0 before 7.0.8.7, all versions starting from 7.1.0 before 7.1.5.1, all versions starting from 7.2.0 before 7.2.2.1, all versions starting from 8.0.0 before 8.0.0.1",
  "NotImpacted": "All versions before 5.2.0, all versions starting from 7.0.8.7 before 7.1.0, all versions starting from 7.1.5.1 before 7.2.0, all versions starting from 7.2.2.1 before 8.0.0, all versions starting from 8.0.0.1",
  "Solution": "Upgrade to versions 7.0.8.7, 7.1.5.1, 7.2.2.1, 8.0.0.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-54133",
    "https://github.com/advisories/GHSA-vfm5-rmrh-j26v",
    "https://github.com/rails/rails/security/advisories/GHSA-vfm5-rmrh-j26v",
    "https://github.com/rails/rails/commit/2e3f41e4538b9ca1044357f6644f037bbb7c6c49",
    "https://github.com/rails/rails/commit/3da2479cfe1e00177114b17e496213c40d286b3a",
    "https://github.com/rails/rails/commit/5558e72f22fc69c1c407b31ac5fb3b4ce087b542",
    "https://github.com/rails/rails/commit/cb16a3bb515b5d769f73926d9757270ace691f1d",
    "https://github.com/rails/rails",
    "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-54133.yml",
    "https://security.netapp.com/advisory/ntap-20250306-0010"
  ],
  "CvssV2": "",
  "CvssV3": "",
  "UUID": "2d731998-ae11-4e68-aab0-2d8c9bd5ab60"
}