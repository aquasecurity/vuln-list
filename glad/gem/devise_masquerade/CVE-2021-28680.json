{
  "Identifier": "CVE-2021-28680",
  "PackageSlug": "gem/devise_masquerade",
  "Title": "Improper Access Control",
  "Description": "The devise_masquerade gem allows certain attacks when a password's salt is unknown. An application that uses this gem to let administrators masquerade/impersonate users loses one layer of security protection compared to a situation where Devise (without this extension) is used. If the server-side `secret_key_base` value became publicly known (for instance if it is committed to a public repository by mistake), there are still other protections in place that prevent an attacker from impersonating any user on the site. When masquerading is not used in a plain Devise application, one must know the password salt of the target user if one wants to encrypt and sign a valid session cookie. When devise_masquerade is used, however, an attacker can decide which user the `back` action will go back to without knowing that user's password salt and simply knowing the user ID, by manipulating the session cookie and pretending that a user is already masqueraded by an administrator.",
  "Date": "2021-12-13",
  "Pubdate": "2021-12-07",
  "AffectedRange": "\u003c1.3.0",
  "FixedVersions": [
    "1.3.0"
  ],
  "AffectedVersions": "All versions before 1.3.0",
  "NotImpacted": "All versions starting from 1.3.0",
  "Solution": "Upgrade to version 1.3.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-28680",
    "https://github.com/oivoodoo/devise_masquerade/issues/83",
    "https://labanskoller.se/blog/2021/03/23/the-devise-extension-that-peeled-off-one-layer-of-the-security-onion-cve-2021-28680/"
  ],
  "CvssV2": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "6de391be-8589-402a-991e-c0d269c7fbe9"
}