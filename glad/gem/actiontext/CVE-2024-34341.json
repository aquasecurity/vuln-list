{
  "Identifier": "CVE-2024-34341",
  "PackageSlug": "gem/actiontext",
  "Title": "Trix Editor Arbitrary Code Execution Vulnerability",
  "Description": "The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.\n\n**Vulnerable Versions**:\n\n- 1.x series up to and including 1.3.1\n- 2.x series up to and including 2.1.0\n\n**Fixed Versions**:\n\n- v1.3.2\n- v2.1.1\n\n**Vector**:\n\n- **Bug 1**: When copying content manipulated by a script, such as:\n\n```js\ndocument.addEventListener('copy', function(e){\ne.clipboardData.setData('text/html', '\u003cdiv\u003e\u003cnoscript\u003e\u003cdiv class=\"123\u003c/noscript\u003e456\u003cimg src=1 onerror=alert(1)//\"\u003e\u003c/div\u003e\u003c/noscript\u003e\u003c/div\u003e');\ne.preventDefault();\n});\n```\n\nand pasting into the Trix editor, the script within the content is executed.\n\n- **Bug 2**: Similar execution occurs with content structured as:",
  "Date": "2024-06-03",
  "Pubdate": "2024-05-07",
  "AffectedRange": "\u003e=7.0.0.alpha1 \u003c7.0.8.3||\u003e=7.1.0.beta1 \u003c7.1.3.3",
  "FixedVersions": [
    "7.0.8.3",
    "7.1.3.3"
  ],
  "AffectedVersions": "All versions starting from 7.0.0.alpha1 before 7.0.8.3, all versions starting from 7.1.0.beta1 before 7.1.3.3",
  "NotImpacted": "All versions before 7.0.0.alpha1, all versions starting from 7.0.8.3 before 7.1.0.beta1, all versions starting from 7.1.3.3",
  "Solution": "Upgrade to versions 7.0.8.3, 7.1.3.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-34341",
    "https://github.com/advisories/GHSA-qjqp-xr96-cj99",
    "https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99",
    "https://github.com/basecamp/trix/pull/1147",
    "https://github.com/basecamp/trix/pull/1149",
    "https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad",
    "https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554",
    "https://github.com/rails/rails/commit/07e6c88cc4defe6f6b8d28e79eb13a518e15b14c",
    "https://github.com/rails/rails/commit/260cb392fc1ee91d0b749cff08d1c8d54b230bd3",
    "https://github.com/rails/rails/commit/73fac32511eefdd45d8f00fecc2b8cc5408ea6d5",
    "https://discuss.rubyonrails.org/t/xss-vulnerabilities-in-trix-editor/85803",
    "https://github.com/basecamp/trix",
    "https://github.com/basecamp/trix/releases/tag/v2.1.1",
    "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-34341.yml",
    "https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-2-and-7-1-3-3-have-been-released",
    "https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-3-has-been-released"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
  "UUID": "9a79b07c-efb1-45c6-9ddb-b234ac9e7fe5"
}