{
  "Identifier": "CVE-2024-37031",
  "PackageSlug": "gem/activeadmin",
  "Title": "activeadmin vulnerable to stored persistent cross-site scripting (XSS) in dynamic form legends",
  "Description": "Users settings their active admin form legends dynamically may be vulnerable to stored XSS, as long as its value can be injected directly by a malicious user.\n\nFor example:\n\n* A public web application allows users to create entities with arbitrary names.\n* Active Admin is used to administrate these entities through a private backend.\n* The form to edit these entities in the private backend has the following shape (note the dynamic `name` value dependent on an attribute of the `resource`):\n\n```ruby\nform do |f|\nf.inputs name: resource.name do\nf.input :name\nf.input :description\nend\n\nf.actions\nend\n```\n\nThen a malicious user could create an entity with a payload that would get executed in the active admin administrator's browser.\n\nBoth `form` blocks with an implicit or explicit name (i.e., both `form resource.name` or `form name: resource.name` would suffer from the problem), where the value of the name can be arbitrarily set by non admin users.",
  "Date": "2024-10-28",
  "Pubdate": "2024-06-02",
  "AffectedRange": "\u003c3.2.2||\u003e=4.0.0.beta1 \u003c4.0.0.beta7",
  "FixedVersions": [
    "3.2.2",
    "4.0.0.beta7"
  ],
  "AffectedVersions": "All versions starting from 4.0.0.beta1 before 4.0.0.beta7, all versions before 3.2.2",
  "NotImpacted": "All versions before 4.0.0.beta1, all versions starting from 4.0.0.beta7 before 0, all versions starting from 3.2.2",
  "Solution": "Upgrade to versions 3.2.2, 4.0.0.beta7 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-37031",
    "https://github.com/advisories/GHSA-9mg6-x45v-hcfm",
    "https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm",
    "https://github.com/activeadmin/activeadmin/pull/8349",
    "https://github.com/activeadmin/activeadmin",
    "https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2",
    "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml",
    "https://rubygems.org/gems/activeadmin/versions/3.2.2"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
  "UUID": "d2260ae9-3328-458c-8169-90fe0bb00ff8"
}