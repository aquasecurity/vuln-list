{
  "Identifier": "CVE-2024-43414",
  "PackageSlug": "npm/@apollo/gateway",
  "Title": "Apollo Query Planner and Apollo Gateway may infinitely loop on sufficiently complex queries",
  "Description": "Instances of @apollo/query-planner \u003e=2.0.0 and \u003c2.8.5 are impacted by a denial-of-service vulnerability. @apollo/gateway versions \u003e=2.0.0 and \u003c 2.8.5 and Apollo Router \u003c1.52.1 are also impacted through their use of @apollo/query-planner.\n\nIf @apollo/query-planner is asked to plan a sufficiently complex query, it may loop infinitely and never complete. This results in unbounded memory consumption and either a crash or out-of-memory (OOM) termination.\n\nThis issue can be triggered if you have at least one non-`@key` field that can be resolved by multiple subgraphs. To identify these shared fields, the schema for each subgraph must be reviewed. The mechanism to identify shared fields varies based on the version of Federation your subgraphs are using.\n\nYou can check if your subgraphs are using Federation 1 or Federation 2 by reviewing their schemas. Federation 2 subgraph schemas will contain a `@link` directive referencing the version of Federation being used while Federation 1 subgraphs will not. For example, in a Federation 2 subgraph, you will find a line like `@link(url: \"https://specs.apollo.dev/federation/v2.0\")`. If a similar `@link` directive is not present in your subgraph schema, it is using Federation 1. Note that a supergraph can contain a mix of Federation 1 and Federation 2 subgraphs.\n\n**To review Federation 1 subgraphs for impact:**\n\nIn Federation 1 subgraphs, fields are implicitly shareable across subgraphs. To review for impact, you will need to review for cases where multiple subgraphs can resolve the same field. For example:\n\n```graphql",
  "Date": "2024-09-13",
  "Pubdate": "2024-08-27",
  "AffectedRange": "\u003e=2.0.0 \u003c2.8.5",
  "FixedVersions": [
    "2.8.5"
  ],
  "AffectedVersions": "All versions starting from 2.0.0 before 2.8.5",
  "NotImpacted": "All versions before 2.0.0, all versions starting from 2.8.5",
  "Solution": "Upgrade to version 2.8.5 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-43414",
    "https://github.com/advisories/GHSA-fmj9-77q8-g6c4",
    "https://github.com/apollographql/federation/security/advisories/GHSA-fmj9-77q8-g6c4",
    "https://github.com/apollographql/router/commit/e309c9bb5a48c1304ff69c88b7eabdd08c26bf45",
    "https://github.com/apollographql/federation",
    "https://www.apollographql.com/docs/federation/query-plans",
    "https://www.apollographql.com/docs/router/configuration/persisted-queries"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "UUID": "ac622a5a-72c5-4fa0-9360-6c205c8b7fad"
}