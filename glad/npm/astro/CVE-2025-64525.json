{
  "Identifier": "CVE-2025-64525",
  "PackageSlug": "npm/astro",
  "Title": "Astro vulnerable to URL manipulation via headers, leading to middleware and CVE-2025-61925 bypass",
  "Description": "In impacted versions of Astro using [on-demand rendering](https://docs.astro.build/en/guides/on-demand-rendering/), request headers `x-forwarded-proto` and `x-forwarded-port` are insecurely used, without sanitization, to build the URL. This has several consequences the most important of which are:\n\n- Middleware-based protected route bypass (only via `x-forwarded-proto`)\n- DoS via cache poisoning (if a CDN is present)\n- SSRF (only via `x-forwarded-proto`)\n- URL pollution (potential SXSS, if a CDN is present)\n- WAF bypass",
  "Date": "2025-11-13",
  "Pubdate": "2025-11-13",
  "AffectedRange": "\u003e=2.16.0 \u003c5.15.5",
  "FixedVersions": [
    "5.15.5"
  ],
  "AffectedVersions": "All versions starting from 2.16.0 before 5.15.5",
  "NotImpacted": "All versions before 2.16.0, all versions starting from 5.15.5",
  "Solution": "Upgrade to version 5.15.5 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-64525",
    "https://github.com/advisories/GHSA-hr2q-hp5q-x767",
    "https://github.com/withastro/astro/security/advisories/GHSA-hr2q-hp5q-x767",
    "https://github.com/withastro/astro/commit/dafbb1ba29912099c4faff1440033edc768af8b4",
    "https://github.com/withastro/astro",
    "https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L121",
    "https://github.com/withastro/astro/blob/970ac0f51172e1e6bff4440516a851e725ac3097/packages/astro/src/core/app/node.ts#L97"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
  "UUID": "36da1cee-c042-467a-a27d-5a8d04e2e8a4"
}