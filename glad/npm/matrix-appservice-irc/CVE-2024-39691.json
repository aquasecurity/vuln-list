{
  "Identifier": "CVE-2024-39691",
  "PackageSlug": "npm/matrix-appservice-irc",
  "Title": "Malicious Matrix homeserver can leak truncated message content of messages it shouldn't have access to",
  "Description": "The fix for GHSA-wm4w-7h2q-3pf7 / [CVE-2024-32000](https://www.cve.org/CVERecord?id=CVE-2024-32000) included in matrix-appservice-irc 2.0.0 relied on the Matrix homeserver-provided timestamp to determine whether a user has access to the event they're replying to when determining whether or not to include a truncated version of the original event in the IRC message. Since this value is controlled by external entities, a malicious Matrix homeserver joined to a room in which a matrix-appservice-irc bridge instance (before version 2.0.1) is present can fabricate the timestamp with the intent of tricking the bridge into leaking room messages the homeserver should not have access to.",
  "Date": "2024-07-05",
  "Pubdate": "2024-07-05",
  "AffectedRange": "\u003c2.0.1",
  "FixedVersions": [
    "2.0.1"
  ],
  "AffectedVersions": "All versions before 2.0.1",
  "NotImpacted": "All versions starting from 2.0.1",
  "Solution": "Upgrade to version 2.0.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-39691",
    "https://github.com/advisories/GHSA-w9mh-5x8j-9754",
    "https://github.com/matrix-org/matrix-appservice-irc/security/advisories/GHSA-w9mh-5x8j-9754",
    "https://github.com/matrix-org/matrix-appservice-irc/pull/1804",
    "https://github.com/matrix-org/matrix-appservice-irc/commit/1835e047f269001054be4c68867797aa12372a0f",
    "https://github.com/matrix-org/matrix-appservice-irc"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
  "UUID": "48ff8c8b-fe2f-43c7-b7d3-35fd587e971f"
}