{
  "Identifier": "CVE-2024-32652",
  "PackageSlug": "npm/@hono/node-server",
  "Title": "@hono/node-server has Denial of Service risk when receiving Host header that cannot be parsed",
  "Description": "The application hangs when receiving a Host header with a value that `@hono/node-server` can't handle well. Invalid values are those that cannot be parsed by the `URL` as a hostname such as an empty string, slashes `/`, and other strings.\n\nFor example, if you have a simple application:\n\n```ts\nimport { serve } from '@hono/node-server'\nimport { Hono } from 'hono'\n\nconst app = new Hono()\n\napp.get('/', (c) =\u003e c.text('Hello'))\n\nserve(app)\n```\n\nSending a request with a Host header with an empty value to it:\n\n```\ncurl localhost:3000/ -H \"Host: \"\n```\n\nThe results:\n\n```\nnode:internal/url:775\nthis.#updateContext(bindingUrl.parse(input, base));\n^\n\nTypeError: Invalid URL\nat new URL (node:internal/url:775:36)\nat newRequest (/Users/yusuke/work/h/159/node_modules/@hono/node-server/dist/index.js:137:17)\nat Server.\u003canonymous\u003e (/Users/yusuke/work/h/159/node_modules/@hono/node-server/dist/index.js:399:17)\nat Server.emit (node:events:514:28)\nat Server.emit (node:domain:488:12)\nat parserOnIncoming (node:_http_server:1143:12)\nat HTTPParser.parserOnHeadersComplete (node:_http_common:119:17) {\ncode: 'ERR_INVALID_URL',\ninput: 'http:///'\n}\n```",
  "Date": "2024-04-19",
  "Pubdate": "2024-04-19",
  "AffectedRange": "\u003e=1.3.0 \u003c1.10.1",
  "FixedVersions": [
    "1.10.1"
  ],
  "AffectedVersions": "All versions starting from 1.3.0 before 1.10.1",
  "NotImpacted": "All versions before 1.3.0, all versions starting from 1.10.1",
  "Solution": "Upgrade to version 1.10.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-32652",
    "https://github.com/advisories/GHSA-hgxw-5xg3-69jx",
    "https://github.com/honojs/node-server/security/advisories/GHSA-hgxw-5xg3-69jx",
    "https://github.com/honojs/node-server/issues/159",
    "https://github.com/honojs/node-server/issues/161",
    "https://github.com/honojs/node-server/commit/306d98f02a8671a0a1fb91ac8fe7e281690c05af",
    "https://github.com/honojs/node-server"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "UUID": "afa1a8c7-7606-4fe2-81d9-64a5b44d4c89"
}