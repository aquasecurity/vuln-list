{
  "Identifier": "CVE-2025-66412",
  "PackageSlug": "npm/@angular/compiler",
  "Title": "Angular Stored XSS Vulnerability via SVG Animation, SVG URL and MathML Attributes",
  "Description": "A **Stored Cross-Site Scripting ([XSS](https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss))** vulnerability has been identified in the **Angular Template Compiler**. It occurs because the compiler's internal security schema is incomplete, allowing attackers to bypass Angular's built-in security sanitization. Specifically, the schema fails to classify certain URL-holding attributes (e.g., those that could contain [`javascript:` URLs](https://developer.mozilla.org/en-US/Web/URI/Reference/Schemes/javascript)) as requiring strict URL security, enabling the injection of malicious scripts.\n\nAdditionally, a related vulnerability exists involving SVG animation elements (`\u003canimate\u003e`, `\u003cset\u003e`, `\u003canimateMotion\u003e`, `\u003canimateTransform\u003e`). The `attributeName` attribute on these elements was not properly validated, allowing attackers to dynamically target security-sensitive attributes like `href` or `xlink:href` on other elements. By binding `attributeName` to \"href\" and providing a `javascript:` URL in the `values` or `to` attribute, an attacker could bypass sanitization and execute arbitrary code.\n\nAttributes confirmed to be vulnerable include:\n*   SVG-related attributes: (e.g., `xlink:href`), and various MathML attributes (e.g., `math|href`, `annotation|href`).\n*   SVG animation `attributeName` attribute when bound to \"href\" or \"xlink:href\".\n\nWhen template binding is used to assign untrusted, user-controlled data to these attributes (e.g., `[attr.xlink:href]=\"maliciousURL\"` or `\u003canimate [attributeName]=\"'href'\" [values]=\"maliciousURL\"\u003e`), the compiler incorrectly falls back to a non-sanitizing context or fails to block the dangerous attribute assignment. This allows an attacker to inject a `javascript:URL` payload. Upon user interaction (like a click) on the element, or automatically in the case of animations, the malicious JavaScript executes in the context of the application's origin.",
  "Date": "2025-12-02",
  "Pubdate": "2025-12-02",
  "AffectedRange": "\u003e=21.0.0-next.0 \u003c21.0.2||\u003e=20.0.0-next.0 \u003c20.3.15||\u003e=19.0.0-next.0 \u003c19.2.17||\u003c=18.2.14",
  "FixedVersions": [
    "21.0.2",
    "20.3.15",
    "19.2.17"
  ],
  "AffectedVersions": "All versions up to 18.2.14, all versions starting from 19.0.0-next.0 before 19.2.17, all versions starting from 20.0.0-next.0 before 20.3.15, all versions starting from 21.0.0-next.0 before 21.0.2",
  "NotImpacted": "All versions after 18.2.14 before 19.0.0-next.0, all versions starting from 19.2.17 before 20.0.0-next.0, all versions starting from 20.3.15 before 21.0.0-next.0, all versions starting from 21.0.2",
  "Solution": "Upgrade to versions 19.2.17, 20.3.15, 21.0.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-66412",
    "https://github.com/advisories/GHSA-v4hv-rgfq-gp49",
    "https://github.com/angular/angular/security/advisories/GHSA-v4hv-rgfq-gp49",
    "https://github.com/angular/angular/commit/1c6b0704fb63d051fab8acff84d076abfbc4893a",
    "https://github.com/angular/angular"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
  "UUID": "298d5cd9-15c8-4288-90d4-d40e4a779e2a"
}