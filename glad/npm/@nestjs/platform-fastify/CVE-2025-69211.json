{
  "Identifier": "CVE-2025-69211",
  "PackageSlug": "npm/@nestjs/platform-fastify",
  "Title": "Nest has a Fastify URL Encoding Middleware Bypass (TOCTOU)",
  "Description": "A NestJS application is vulnerable if it meets all of the following criteria:\n\n1. Platform: Uses `@nestjs/platform-fastify`.\n2. Security Mechanism: Relies on `NestMiddleware` (via `MiddlewareConsumer`) for security checks (authentication, authorization, etc.), or through `app.use()`\n3. Routing: Applies middleware to specific routes using string paths or controllers (e.g., `.forRoutes('admin')`).\nExample Vulnerable Config:\n\n```ts\n// app.module.ts\nexport class AppModule implements NestModule {\nconfigure(consumer: MiddlewareConsumer) {\nconsumer\n.apply(AuthMiddleware) // Security check\n.forRoutes('admin');   // Vulnerable: Path-based restriction\n}\n}\n```\n\nAttack Vector:\n\n- Target Route: `/admin`\n- Middleware Path: `admin`\n- Attack Request: `GET /%61dmin`\n- Result: Middleware is skipped (no match on `%61dmin`), but controller for `/admin` is executed.\n\nConsequences:\n\n- Authentication Bypass: Unauthenticated users can access protected routes.\n- Authorization Bypass: Restricted administrative endpoints become accessible to lower-privileged users.\n- Input Validation Bypass: Middleware performing sanitization or validation can be skipped.",
  "Date": "2025-12-30",
  "Pubdate": "2025-12-30",
  "AffectedRange": "\u003c11.1.11",
  "FixedVersions": [
    "11.1.11"
  ],
  "AffectedVersions": "All versions before 11.1.11",
  "NotImpacted": "All versions starting from 11.1.11",
  "Solution": "Upgrade to version 11.1.11 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-69211",
    "https://github.com/advisories/GHSA-8wpr-639p-ccrj",
    "https://github.com/nestjs/nest/security/advisories/GHSA-8wpr-639p-ccrj",
    "https://github.com/nestjs/nest/commit/c4cedda15a05aafec1e6045b36b0335ab850e771",
    "https://github.com/nestjs/nest"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
  "UUID": "e9ddf9c2-a2c3-4d08-ab72-3d9de91d9201"
}