{
  "Identifier": "CVE-2024-34341",
  "PackageSlug": "npm/trix",
  "Title": "Trix Editor Arbitrary Code Execution Vulnerability",
  "Description": "The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.\n\n**Vulnerable Versions**: Up to 2.1.0\n\n**Fixed Version**: 2.1.1\n\n**Vector**:\n\n- **Bug 1**: When copying content manipulated by a script, such as:\n\n```js\ndocument.addEventListener('copy', function(e){\ne.clipboardData.setData('text/html', '\u003cdiv\u003e\u003cnoscript\u003e\u003cdiv class=\"123\u003c/noscript\u003e456\u003cimg src=1 onerror=alert(1)//\"\u003e\u003c/div\u003e\u003c/noscript\u003e\u003c/div\u003e');\ne.preventDefault();\n});\n```\n\nand pasting into the Trix editor, the script within the content is executed.\n\n- **Bug 2**: Similar execution occurs with content structured as:",
  "Date": "2024-05-07",
  "Pubdate": "2024-05-07",
  "AffectedRange": "\u003c2.1.1",
  "FixedVersions": [
    "2.1.1"
  ],
  "AffectedVersions": "All versions before 2.1.1",
  "NotImpacted": "All versions starting from 2.1.1",
  "Solution": "Upgrade to version 2.1.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-34341",
    "https://github.com/advisories/GHSA-qjqp-xr96-cj99",
    "https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99",
    "https://github.com/basecamp/trix/pull/1147",
    "https://github.com/basecamp/trix/pull/1149",
    "https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad",
    "https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554",
    "https://github.com/basecamp/trix",
    "https://github.com/basecamp/trix/releases/tag/v2.1.1"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
  "UUID": "08794eec-95bc-4949-a31b-1eb26159ea9c"
}