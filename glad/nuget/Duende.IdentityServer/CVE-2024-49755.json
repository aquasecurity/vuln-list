{
  "Identifier": "CVE-2024-49755",
  "PackageSlug": "nuget/Duende.IdentityServer",
  "Title": "Duende IdentityServer has insufficient validation of DPoP cnf claim in Local APIs ",
  "Description": "IdentityServer's local API authentication handler performs insufficient validation of the `cnf` claim in DPoP access tokens. This allows an attacker to use leaked DPoP access tokens at local api endpoints even without possessing the private key for signing proof tokens.\n\nNote that this only impacts custom endpoints within an IdentityServer implementation that have explicitly used the `LocalApiAuthenticationHandler` for authentication. It does not impact:\n- OAuth or OIDC protocol endpoints defined by IdentityServer, such as the authorize and token endpoints.\n- Typical UI pages within an IdentityServer implementation, which are not normally authorized with the local API authentication handler.\n- The use of DPoP to create sender-constrained tokens in IdentityServer that are consumed by external API resources.\n- The use of DPoP to sender-constrain refresh tokens issued to public clients.",
  "Date": "2024-10-28",
  "Pubdate": "2024-10-28",
  "AffectedRange": "[7.0.0,7.0.8)",
  "FixedVersions": [
    "7.0.8"
  ],
  "AffectedVersions": "All versions starting from 7.0.0 before 7.0.8",
  "NotImpacted": "All versions before 7.0.0, all versions starting from 7.0.8",
  "Solution": "Upgrade to version 7.0.8 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-49755",
    "https://github.com/advisories/GHSA-v9xq-2mvm-x8xc",
    "https://github.com/DuendeSoftware/IdentityServer/security/advisories/GHSA-v9xq-2mvm-x8xc",
    "https://github.com/DuendeSoftware/IdentityServer/commit/f28cac921c1f545afe65af71a9327224755b6dac",
    "https://github.com/DuendeSoftware/IdentityServer"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N",
  "UUID": "73be5639-bf4b-4bf4-a49d-6044e9307f93"
}