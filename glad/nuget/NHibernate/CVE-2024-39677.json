{
  "Identifier": "CVE-2024-39677",
  "PackageSlug": "nuget/NHibernate",
  "Title": "NHibernate SQL injection vulnerability in discriminator mappings, static fields referenced in HQL, and some utilities",
  "Description": "A SQL injection vulnerability exists in some types implementing `ILiteralType.ObjectToSQLString`. Callers of these methods are exposed to the vulnerability, which includes:\n- Mappings using inheritance with discriminator values:\n- The discriminator value could be written in the mapping in a way exploiting the vulnerability of the associated discriminator type, if that type is among the vulnerable ones.\n- The current culture settings for formatting the discriminator value type could be altered in a way resulting into SQL injections with the discriminator values.\n- HQL queries referencing a static field of the application.\n- Users of the `SqlInsertBuilder` and `SqlUpdateBuilder` utilities, calling their `AddColumn` overload taking a literal value. These overloads are unused by NHibernate but could be used by users referencing directly these utilities.\n- Any direct use of the `ObjectToSQLString` methods for building SQL queries on the user side.",
  "Date": "2024-11-18",
  "Pubdate": "2024-07-08",
  "AffectedRange": "[,5.4.9),[5.5.0,5.5.2)",
  "FixedVersions": [
    "5.4.9",
    "5.5.2"
  ],
  "AffectedVersions": "All versions before 5.4.9, all versions starting from 5.5.0 before 5.5.2",
  "NotImpacted": "All versions starting from 5.4.9 before 5.5.0, all versions starting from 5.5.2",
  "Solution": "Upgrade to versions 5.4.9, 5.5.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-39677",
    "https://github.com/advisories/GHSA-fg4q-ccq8-3r5q",
    "https://github.com/nhibernate/nhibernate-core/security/advisories/GHSA-fg4q-ccq8-3r5q",
    "https://github.com/nhibernate/nhibernate-core/issues/3516",
    "https://github.com/nhibernate/nhibernate-core/pull/3517",
    "https://github.com/nhibernate/nhibernate-core/pull/3547",
    "https://github.com/nhibernate/nhibernate-core/commit/b4a69d1a5ff5744312478d70308329af496e4ba9",
    "https://github.com/nhibernate/nhibernate-core"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "04a825ec-e99e-4aef-8523-6779fe3948b3"
}