{
  "Identifier": "CVE-2019-10906",
  "PackageSlug": "pypi/Jinja2",
  "Title": "Jinja2 sandbox escape via string formatting",
  "Description": "In Pallets Jinja before 2.10.1, `str.format_map` allows a sandbox escape.\n\nThe sandbox is used to restrict what code can be evaluated when rendering untrusted, user-provided templates. Due to the way string formatting works in Python, the `str.format_map` method could be used to escape the sandbox.\n\nThis issue was previously addressed for the `str.format` method in Jinja 2.8.1, which discusses the issue in detail. However, the less-common `str.format_map` method was overlooked. This release applies the same sandboxing to both methods.\n\nIf you cannot upgrade Jinja, you can override the `is_safe_attribute` method on the sandbox and explicitly disallow the `format_map` method on string objects.",
  "Date": "2024-09-24",
  "Pubdate": "2019-04-10",
  "AffectedRange": "\u003c2.10.1",
  "FixedVersions": [
    "2.10.1"
  ],
  "AffectedVersions": "All versions before 2.10.1",
  "NotImpacted": "All versions starting from 2.10.1",
  "Solution": "Upgrade to version 2.10.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2019-10906",
    "https://github.com/advisories/GHSA-462w-v97r-4m45",
    "https://usn.ubuntu.com/4011-2",
    "https://usn.ubuntu.com/4011-1",
    "https://palletsprojects.com/blog/jinja-2-10-1-released",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TS7IVZAJBWOHNRDMFJDIZVFCMRP6YIUQ",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QCDYIS254EJMBNWOG4S5QY6AOTOR4TZU",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DSW3QZMFVVR7YE3UT4YRQA272TYAL5AF",
    "https://lists.apache.org/thread.html/f0c4a03418bcfe70c539c5dbaf99c04c98da13bfa1d3266f08564316@%3Ccommits.airflow.apache.org%3E",
    "https://lists.apache.org/thread.html/b2380d147b508bbcb90d2cad443c159e63e12555966ab4f320ee22da@%3Ccommits.airflow.apache.org%3E",
    "https://lists.apache.org/thread.html/7f39f01392d320dfb48e4901db68daeece62fd60ef20955966739993@%3Ccommits.airflow.apache.org%3E",
    "https://lists.apache.org/thread.html/57673a78c4d5c870d3f21465c7e2946b9f8285c7c57e54c2ae552f02@%3Ccommits.airflow.apache.org%3E",
    "https://lists.apache.org/thread.html/46c055e173b52d599c648a98199972dbd6a89d2b4c4647b0500f2284@%3Cdevnull.infra.apache.org%3E",
    "https://lists.apache.org/thread.html/320441dccbd9a545320f5f07306d711d4bbd31ba43dc9eebcfc602df@%3Cdevnull.infra.apache.org%3E",
    "https://lists.apache.org/thread.html/2b52b9c8b9d6366a4f1b407a8bde6af28d9fc73fdb3b37695fd0d9ac@%3Cdevnull.infra.apache.org%3E",
    "https://lists.apache.org/thread.html/09fc842ff444cd43d9d4c510756fec625ef8eb1175f14fd21de2605f@%3Cdevnull.infra.apache.org%3E",
    "https://github.com/pypa/advisory-database/tree/main/vulns/jinja2/PYSEC-2019-217.yaml",
    "https://github.com/pallets/jinja",
    "https://access.redhat.com/errata/RHSA-2019:1329",
    "https://access.redhat.com/errata/RHSA-2019:1237",
    "https://access.redhat.com/errata/RHSA-2019:1152"
  ],
  "CvssV2": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
  "UUID": "b2d59abd-b748-4d93-bb21-55f9e9aecea2"
}