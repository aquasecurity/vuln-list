{
  "Identifier": "CVE-2024-24560",
  "PackageSlug": "pypi/vyper",
  "Title": "Vyper's external calls can overflow return data to return input buffer",
  "Description": "When calls to external contracts are made, we write the input buffer starting at byte 28, and allocate the return buffer to start at byte 0 (overlapping with the input buffer). When checking `RETURNDATASIZE` for dynamic types, the size is compared only to the minimum allowed size for that type, and not to the returned value's `length`. As a result, malformed return data can cause the contract to mistake data from the input buffer for returndata.\n\nThis advisory is given a severity of \"Low\" because when the called contract returns invalid ABIv2 encoded data, the calling contract can read different invalid data (from the dirty buffer) than the called contract returned.",
  "Date": "2024-11-22",
  "Pubdate": "2024-02-02",
  "AffectedRange": "\u003c0.4.0",
  "FixedVersions": [
    "0.4.0"
  ],
  "AffectedVersions": "All versions before 0.4.0",
  "NotImpacted": "All versions starting from 0.4.0",
  "Solution": "Upgrade to version 0.4.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-24560",
    "https://github.com/advisories/GHSA-gp3w-2v2m-p686",
    "https://github.com/vyperlang/vyper/security/advisories/GHSA-gp3w-2v2m-p686",
    "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-148.yaml",
    "https://github.com/vyperlang/vyper"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
  "UUID": "d25591dd-a762-4373-9882-7f7edc4a52ee"
}