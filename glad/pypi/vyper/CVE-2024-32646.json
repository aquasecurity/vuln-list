{
  "Identifier": "CVE-2024-32646",
  "PackageSlug": "pypi/vyper",
  "Title": "vyper performs double eval of the slice start/length args in certain cases",
  "Description": "Using the `slice` builtin can result in a double eval vulnerability when the buffer argument is either `msg.data`, `self.code` or `\u003caddress\u003e.code` and either the `start` or `length` arguments have side-effects.\n\nA contract search was performed and no vulnerable contracts were found in production. Having side-effects in the start and length patterns is also an unusual pattern which is not that likely to show up in user code. It is also much harder (but not impossible!) to trigger the bug since `0.3.4` since the unique symbol fence was introduced (https://github.com/vyperlang/vyper/pull/2914).",
  "Date": "2025-01-21",
  "Pubdate": "2024-04-25",
  "AffectedRange": "\u003c0.4.0",
  "FixedVersions": [
    "0.4.0"
  ],
  "AffectedVersions": "All versions before 0.4.0",
  "NotImpacted": "All versions starting from 0.4.0",
  "Solution": "Upgrade to version 0.4.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-32646",
    "https://github.com/advisories/GHSA-r56x-j438-vw5m",
    "https://github.com/vyperlang/vyper/security/advisories/GHSA-r56x-j438-vw5m",
    "https://github.com/vyperlang/vyper/pull/2914",
    "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-207.yaml",
    "https://github.com/vyperlang/vyper"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
  "UUID": "508d7380-ee38-48a3-96e6-52cf28268600"
}