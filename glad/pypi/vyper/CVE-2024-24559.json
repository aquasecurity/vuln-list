{
  "Identifier": "CVE-2024-24559",
  "PackageSlug": "pypi/vyper",
  "Title": "Vyper sha3 codegen bug",
  "Description": "There is an error in the stack management when compiling the `IR` for `sha3_64`. Concretely, the `height` variable is miscalculated.\nThe vulnerability can't be triggered without writing the `IR` by hand. That is, it cannot be triggered from regular vyper code, it can only be triggered by using the `fang` binary directly (this binary used to be called `vyper-ir` prior to v0.3.4).",
  "Date": "2024-11-22",
  "Pubdate": "2024-02-05",
  "AffectedRange": "\u003c0.4.0",
  "FixedVersions": [
    "0.4.0"
  ],
  "AffectedVersions": "All versions before 0.4.0",
  "NotImpacted": "All versions starting from 0.4.0",
  "Solution": "Upgrade to version 0.4.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-24559",
    "https://github.com/advisories/GHSA-6845-xw22-ffxv",
    "https://github.com/vyperlang/vyper/security/advisories/GHSA-6845-xw22-ffxv",
    "https://github.com/vyperlang/vyper/pull/4063",
    "https://github.com/vyperlang/vyper/commit/d9f9fdadd81a148cbc68f02dbbbcdc0c92fad652",
    "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-147.yaml",
    "https://github.com/vyperlang/vyper",
    "https://github.com/vyperlang/vyper/blob/c150fc49ee9375a930d177044559b83cb95f7963/vyper/ir/compile_ir.py#L585-L586"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
  "UUID": "a4b09eb8-c705-43aa-a989-43b99d33d1d6"
}