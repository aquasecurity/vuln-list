{
  "Identifier": "CVE-2021-30185",
  "PackageSlug": "pypi/indico",
  "Title": "Indico Tampering with links (e.g. password reset) in sent emails",
  "Description": "An external audit of the Indico codebase has discovered a vulnerability in Indico's URL generation logic which could have allowed an attacker to make Indico send a password reset link with a valid token pointing to an attacker-controlled domain by sending that domain in the `Host` header. Had a user clicked such a link without realizing it does not point to Indico (and that they never requested it), it would have revealed their password reset token to the attacker, allowing them to reset the password for that user and thus take over their Indico account.\n\n- If the web server already enforces a canonical host name, this cannot be exploited (this was not part of the default config from the Indico setup guide)\n- If only SSO is used ([`LOCAL_IDENTITIES`](https://docs.getindico.io/en/stable/config/settings/#LOCAL_IDENTITIES) set to `False`), the vulnerability cannot be exploited for password reset links, but other links in emails set by Indico could be tampered with in the same way (with less problematic impact though)",
  "Date": "2024-09-23",
  "Pubdate": "2021-04-08",
  "AffectedRange": "\u003c2.3.4",
  "FixedVersions": [
    "2.3.4"
  ],
  "AffectedVersions": "All versions before 2.3.4",
  "NotImpacted": "All versions starting from 2.3.4",
  "Solution": "Upgrade to version 2.3.4 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-30185",
    "https://github.com/advisories/GHSA-wgpj-7c2j-vfjm",
    "https://github.com/indico/indico/security/advisories/GHSA-wgpj-7c2j-vfjm",
    "https://github.com/indico/indico/releases/tag/v2.3.4",
    "https://github.com/pypa/advisory-database/tree/main/vulns/indico/PYSEC-2021-18.yaml",
    "https://www.shorebreaksecurity.com/blog"
  ],
  "CvssV2": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "UUID": "9de167e0-ebcc-4044-9708-1d61d1700782"
}