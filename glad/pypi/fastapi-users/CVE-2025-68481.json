{
  "Identifier": "CVE-2025-68481",
  "PackageSlug": "pypi/fastapi-users",
  "Title": "FastAPI Users Vulnerable to 1-click Account Takeover in Apps Using FastAPI SSO",
  "Description": "**Description**\n\nThe OAuth login state tokens are completely stateless and carry no per-request entropy or any data that could link them to the session that initiated the OAuth flow. `generate_state_token()` is always called with an empty `state_data` dict, so the resulting JWT only contains the fixed audience claim plus an expiration timestamp. \\[1\\]\n\n```py\nstate_data: dict[str, str] = {}\nstate = generate_state_token(state_data, state_secret)\nauthorization_url = await oauth_client.get_authorization_url(\nauthorize_redirect_url,\nstate,\nscopes,\n)\n```\n\n*fastapi\\_users/router/oauth.py:65-71*\n\nOn callback, the library merely checks that the JWT verifies under `state_secret` and is unexpired; there is no attempt to match the state value to the browser that initiated the OAuth request, no correlation cookie, and no server-side cache. \\[2\\]\n\n```py\ntry:\ndecode_jwt(state, state_secret, [STATE_TOKEN_AUDIENCE])\nexcept jwt.DecodeError:\nraise HTTPException(\nstatus_code=status.HTTP_400_BAD_REQUEST,\ndetail=ErrorCode.ACCESS_TOKEN_DECODE_ERROR,\n)\nexcept jwt.ExpiredSignatureError:\nraise HTTPException(\nstatus_code=status.HTTP_400_BAD_REQUEST,\ndetail=ErrorCode.ACCESS_TOKEN_ALREADY_EXPIRED,\n)\n```\n\n*fastapi\\_users/router/oauth.py:130-141*\n\nAny attacker can hit `/authorize`, capture the server-generated state, finish the upstream OAuth flow with their own provider account, and then trick a victim into loading `.../callback?code=\u003cattacker_code\u003e\u0026state=\u003cattacker_state\u003e`. Because the state JWT is valid for any client for \\~1 hour, the victim’s browser will complete the flow. This leads to login CSRF. Depending on the app’s logic, the login CSRF can lead to an account takeover of the victim account or to the victim user getting logged in to the attacker's account.",
  "Date": "2025-12-20",
  "Pubdate": "2025-12-19",
  "AffectedRange": "\u003c15.0.2",
  "FixedVersions": [
    "15.0.2"
  ],
  "AffectedVersions": "All versions before 15.0.2",
  "NotImpacted": "All versions starting from 15.0.2",
  "Solution": "Upgrade to version 15.0.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-68481",
    "https://github.com/advisories/GHSA-5j53-63w8-8625",
    "https://github.com/fastapi-users/fastapi-users/security/advisories/GHSA-5j53-63w8-8625",
    "https://github.com/fastapi-users/fastapi-users/commit/7cf413cd766b9cb0ab323ce424ddab2c0d235932",
    "https://github.com/fastapi-users/fastapi-users",
    "https://github.com/fastapi-users/fastapi-users/blob/bcee8c9b884de31decb5d799aead3974a0b5b158/fastapi_users/router/oauth.py#L111",
    "https://github.com/fastapi-users/fastapi-users/blob/bcee8c9b884de31decb5d799aead3974a0b5b158/fastapi_users/router/oauth.py#L57"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N",
  "UUID": "3201279d-4769-41a3-801e-bad76a018a41"
}