{
  "Identifier": "CVE-2021-21241",
  "PackageSlug": "pypi/Flask-Security-Too",
  "Title": "CSRF can expose users authentication token",
  "Description": "### Issue\nThe  /login and /change endpoints can return the authenticated user's authentication token in response to a GET request. Since GET requests aren't protected with a CSRF token, this could lead to a malicious 3rd party site acquiring the authentication token.\n\n### Patches\nVersion 3.4.5 and soon to be released 4.0.0 are patched.\n\n### Workarounds\nIf you aren't using authentication tokens - you can set the SECURITY_TOKEN_MAX_AGE to \"0\" (seconds) which should make the token unusable.\n\n### References\nNone",
  "Date": "2024-09-20",
  "Pubdate": "2021-01-11",
  "AffectedRange": "\u003e=3.3.0,\u003c3.4.5",
  "FixedVersions": [
    "3.4.5"
  ],
  "AffectedVersions": "All versions starting from 3.3.0 before 3.4.5",
  "NotImpacted": "All versions before 3.3.0, all versions starting from 3.4.5",
  "Solution": "Upgrade to version 3.4.5 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-21241",
    "https://github.com/advisories/GHSA-hh7m-rx4f-4vpv",
    "https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2021-91.yaml",
    "https://pypi.org/project/Flask-Security-Too",
    "https://web.archive.org/web/20210118165844/https://github.com/Flask-Middleware/flask-security/releases/tag/3.4.5",
    "https://web.archive.org/web/20210118165958/https://github.com/Flask-Middleware/flask-security/commit/6d50ee9169acf813257c37b75babe9c28e83542a",
    "https://web.archive.org/web/20210118170445/https://github.com/Flask-Middleware/flask-security/commit/61d313150b5f620d0b800896c4f2199005e84b1f",
    "https://web.archive.org/web/20210118170502/https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-hh7m-rx4f-4vpv",
    "https://web.archive.org/web/20211207005640/https://github.com/Flask-Middleware/flask-security/pull/422"
  ],
  "CvssV2": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
  "UUID": "74c4cce2-723a-4933-bc9c-5f76e49daa8b"
}