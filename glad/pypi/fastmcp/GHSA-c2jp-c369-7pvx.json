{
  "Identifier": "GHSA-c2jp-c369-7pvx",
  "PackageSlug": "pypi/fastmcp",
  "Title": "FastMCP Auth Integration Allows for Confused Deputy Account Takeover",
  "Description": "FastMCP documentation [covers the scenario](https://gofastmcp.com/integrations/azure) where it is possible to use Entra ID or other providers for authentication. In this context, because Entra ID does not support Dynamic Client Registration (DCR), the FastMCP-hosted MCP server is acting as the authorization provider, as declared in the Protected Resource Metadata (PRM) document hosted on the server.\n\nFor example, on a local MCP server, it may be hosted here:\n\n```http\nhttp://localhost:8000/.well-known/oauth-protected-resource\n```\n\nAnd the JSON representation of the PRM document:\n\n```json\n{\n\"resource\": \"http://localhost:8000/mcp\",\n\"authorization_servers\": [\n\"http://localhost:8000/\"\n],\n\"scopes_supported\": [\n\"User.Read\",\n\"email\",\n\"openid\",\n\"profile\"\n],\n\"bearer_methods_supported\": [\n\"header\"\n]\n}\n```\n\nNotice that the `authorization_servers` field contains the MCP server itself - it acts as an **OAuth Client** to the downstream authorization server (e.g., Entra ID) and as a **Authorization Server** (AS) to the MCP client.\n\nThe FastMCP server also hosts the AS metadata:\n\n```bash\nhttp://localhost:8000/.well-known/oauth-authorization-server\n```\n\nWith the following content:\n\n```json\n{\n\"issuer\": \"http://localhost:8000/\",\n\"authorization_endpoint\": \"http://localhost:8000/authorize\",\n\"token_endpoint\": \"http://localhost:8000/token\",\n\"registration_endpoint\": \"http://localhost:8000/register\",\n\"scopes_supported\": [\n\"User.Read\",\n\"email\",\n\"openid\",\n\"profile\"\n],\n\"response_types_supported\": [\n\"code\"\n],\n\"grant_types_supported\": [\n\"authorization_code\",\n\"refresh_token\"\n],\n\"token_endpoint_auth_methods_supported\": [\n\"client_secret_post\"\n],\n\"code_challenge_methods_supported\": [\n\"S256\"\n]\n}\n```\n\nAll of this confirms that the FastMCP server is, in fact, handling the client-to-server authorization and then delegating the downstream effects (i.e., authorization with Entra ID) to its own redirect logic, with a call like this (as seen through MCP Inspector):",
  "Date": "2026-01-21",
  "Pubdate": "2025-10-29",
  "AffectedRange": "\u003c2.13.0",
  "FixedVersions": [
    "2.13.0"
  ],
  "AffectedVersions": "All versions before 2.13.0",
  "NotImpacted": "All versions starting from 2.13.0",
  "Solution": "Upgrade to version 2.13.0 or above.",
  "Urls": [
    "https://github.com/advisories/GHSA-c2jp-c369-7pvx",
    "https://github.com/jlowin/fastmcp/security/advisories/GHSA-c2jp-c369-7pvx",
    "https://github.com/jlowin/fastmcp"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
  "UUID": "9d822c9d-d358-4c3f-a318-b37f8e8f4399"
}