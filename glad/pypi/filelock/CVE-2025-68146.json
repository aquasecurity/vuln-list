{
  "Identifier": "CVE-2025-68146",
  "PackageSlug": "pypi/filelock",
  "Title": "filelock has a TOCTOU race condition which allows symlink attacks during lock file creation",
  "Description": "A Time-of-Check-Time-of-Use (TOCTOU) race condition allows local attackers to corrupt or truncate arbitrary user files through symlink attacks. The vulnerability exists in both Unix and Windows lock file creation where filelock checks if a file exists before opening it with O_TRUNC. An attacker can create a symlink pointing to a victim file in the time gap between the check and open, causing os.open() to follow the symlink and truncate the target file.\n\n**Who is impacted:**\n\nAll users of filelock on Unix, Linux, macOS, and Windows systems. The vulnerability cascades to dependent libraries:\n\n- **virtualenv users**: Configuration files can be overwritten with virtualenv metadata, leaking sensitive paths\n- **PyTorch users**: CPU ISA cache or model checkpoints can be corrupted, causing crashes or ML pipeline failures\n- **poetry/tox users**: through using virtualenv or filelock on their own.\n\nAttack requires local filesystem access and ability to create symlinks (standard user permissions on Unix; Developer Mode on Windows 10+). Exploitation succeeds within 1-3 attempts when lock file paths are predictable.",
  "Date": "2025-12-16",
  "Pubdate": "2025-12-16",
  "AffectedRange": "\u003c3.20.1",
  "FixedVersions": [
    "3.20.1"
  ],
  "AffectedVersions": "All versions before 3.20.1",
  "NotImpacted": "All versions starting from 3.20.1",
  "Solution": "Upgrade to version 3.20.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-68146",
    "https://github.com/advisories/GHSA-w853-jp5j-5j7f",
    "https://github.com/tox-dev/filelock/security/advisories/GHSA-w853-jp5j-5j7f",
    "https://github.com/tox-dev/filelock/commit/4724d7f8c3393ec1f048c93933e6e3e6ec321f0e",
    "https://github.com/tox-dev/filelock",
    "https://github.com/tox-dev/filelock/releases/tag/3.20.1",
    "https://learn.microsoft.com/en-us/windows/win32/fileio/file-attribute-constants",
    "https://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H",
  "UUID": "0384badb-f975-4392-a405-9bffd480c1e5"
}