{
  "Identifier": "CVE-2022-39348",
  "PackageSlug": "pypi/Twisted",
  "Title": "Twisted vulnerable to NameVirtualHost Host header injection",
  "Description": "When the host header does not match a configured host, `twisted.web.vhost.NameVirtualHost` will return a `NoResource` resource which renders the Host header unescaped into the 404 response allowing HTML and script injection.\n\nExample configuration:\n```python\nfrom twisted.web.server import Site\nfrom twisted.web.vhost import NameVirtualHost\nfrom twisted.internet import reactor\n\nresource = NameVirtualHost()\nsite = Site(resource)\nreactor.listenTCP(8080, site)\nreactor.run()\n```\nOutput:\n```\n‚ùØ curl -H\"Host:\u003ch1\u003eHELLO THERE\u003c/h1\u003e\" http://localhost:8080/\n\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e404 - No Such Resource\u003c/title\u003e\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003eNo Such Resource\u003c/h1\u003e\n\u003cp\u003ehost b'\u003ch1\u003ehello there\u003c/h1\u003e' not in vhost map\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nThis vulnerability was introduced in f49041bb67792506d85aeda9cf6157e92f8048f4 and first appeared in the 0.9.4 release.",
  "Date": "2024-11-25",
  "Pubdate": "2022-10-26",
  "AffectedRange": "\u003e=0.9.4,\u003c22.10.0rc1",
  "FixedVersions": [
    "22.10.0rc1"
  ],
  "AffectedVersions": "All versions starting from 0.9.4 before 22.10.0rc1",
  "NotImpacted": "All versions before 0.9.4, all versions starting from 22.10.0rc1",
  "Solution": "Upgrade to version 22.10.0rc1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-39348",
    "https://github.com/advisories/GHSA-vg46-2rrj-3647",
    "https://github.com/twisted/twisted/security/advisories/GHSA-vg46-2rrj-3647",
    "https://github.com/twisted/twisted/commit/f2f5e81c03f14e253e85fe457e646130780db40b",
    "https://github.com/twisted/twisted/commit/f49041bb67792506d85aeda9cf6157e92f8048f4",
    "https://github.com/twisted/twisted",
    "https://lists.debian.org/debian-lts-announce/2022/11/msg00038.html",
    "https://security.gentoo.org/glsa/202301-02"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
  "UUID": "a9a687ca-9c69-4140-97a1-de02c9062731"
}