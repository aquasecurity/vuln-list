{
  "Identifier": "CVE-2024-27758",
  "PackageSlug": "pypi/rpyc",
  "Title": "RPyC's missing security check results in code execution when using numpy.array on the server-side.",
  "Description": "An issue in Open Source: RPyC v.4.00 thru v.5.3.1 allows a remote attacker to execute arbitrary code via a crafted script to the `__array__` attribute component. This vulnerability was introduced in [9f45f826](https://github.com/tomerfiliba-org/rpyc/commit/9f45f8269d4106905db61d82cd529cacdb178911).\n\n### Attack Vector\nRPyC services that rely on the `__array__` attribute used by numpy are impacted. When the server-side exposes a method that calls the attribute named `__array__` for a a client provided netref (e.g., `np.array(client_netref)`), a remote attacker can craft a class which results in remote code execution\n\n### Impact\nAssuming the system exposes a method that calls the attribute `__array__`, an attacker can execute code using the vulnerable component. \n\n### Patches\nThe fix is available in RPyC 6.0.0. The major version change is because some users may need to set `allow_pickle` to `True` when migrating to RPyC 6.\n\n### Workarounds\nWhile the recommend fix is to upgrade to RPyC 6.0.0, the workaround is to [apply bba1d356 as patch.](https://github.com/tomerfiliba-org/rpyc/commit/bba1d3562e6f9f1256ec64048cc23001c0bb7516)\n\n### Affected Component\n[The affected component](https://github.com/tomerfiliba-org/rpyc/blob/5.3.1/rpyc/core/netref.py#L252-L255) is the `__array__` method constructed for `NetrefClass`.\n\n### References\n- [Original disclosure](https://gist.github.com/renbou/957f70d27470982994f12a1d70153d09) by [renbou (Artem Mikheev)](https://gist.github.com/renbou)\n- [CVE-2024-27758](https://nvd.nist.gov/vuln/detail/CVE-2024-27758)\n",
  "Date": "2024-03-06",
  "Pubdate": "2024-03-06",
  "AffectedRange": "\u003e=4.0.0 \u003c6.0.0",
  "FixedVersions": [
    "6.0.0"
  ],
  "AffectedVersions": "All versions starting from 4.0.0 before 6.0.0",
  "NotImpacted": "All versions before 4.0.0, all versions starting from 6.0.0",
  "Solution": "Upgrade to version 6.0.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-27758",
    "https://github.com/advisories/GHSA-h5cg-53g7-gqjw",
    "https://github.com/tomerfiliba-org/rpyc/security/advisories/GHSA-h5cg-53g7-gqjw",
    "https://github.com/tomerfiliba-org/rpyc/commit/9f45f8269d4106905db61d82cd529cacdb178911",
    "https://github.com/tomerfiliba-org/rpyc/commit/bba1d3562e6f9f1256ec64048cc23001c0bb7516",
    "https://gist.github.com/renbou/957f70d27470982994f12a1d70153d09",
    "https://github.com/tomerfiliba-org/rpyc",
    "https://github.com/tomerfiliba-org/rpyc/blob/5.3.1/rpyc/core/netref.py#L252-L255"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N",
  "UUID": "3eddeb19-b13e-48d5-af37-6feaaf350fb9"
}