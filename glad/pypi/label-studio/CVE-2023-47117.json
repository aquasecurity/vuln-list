{
  "Identifier": "CVE-2023-47117",
  "PackageSlug": "pypi/label-studio",
  "Title": "Label Studio Object Relational Mapper Leak Vulnerability in Filtering Task",
  "Description": "The following code snippet from the `ViewSetSerializer` in [`label_studio/data_manager/serializers.py`](https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/data_manager/serializers.py#L115) insecurely creates `Filter` objects from a JSON `POST` request to the `/api/dm/views/{viewId}` API endpoint.\n\n```python\n@staticmethod\ndef _create_filters(filter_group, filters_data):\nfilter_index = 0\nfor filter_data in filters_data:\nfilter_data[\"index\"] = filter_index\nfilter_group.filters.add(Filter.objects.create(**filter_data))\nfilter_index += 1\n```\n\nThese `Filter` objects are then applied in the `TaskQuerySet` in [`label_studio/data_manager/managers.py`](https://github.com/HumanSignal/label-studio/blob/1.8.2/label_studio/data_manager/managers.py#L473).\n\n```python\nclass TaskQuerySet(models.QuerySet):\ndef prepared(self, prepare_params=None):\n\"\"\" Apply filters, ordering and selected items to queryset\n\n:param prepare_params: prepare params with project, filters, orderings, etc\n:return: ordered and filtered queryset\n\"\"\"\nfrom projects.models import Project\n\nqueryset = self\n\nif prepare_params is None:\nreturn queryset\n\nproject = Project.objects.get(pk=prepare_params.project)\nrequest = prepare_params.request\nqueryset = apply_filters(queryset, prepare_params.filters, project, request) \u003c1\u003e\nqueryset = apply_ordering(queryset, prepare_params.ordering, project, request, view_data=prepare_params.data)\n\nif not prepare_params.selectedItems:\nreturn queryset",
  "Date": "2024-11-22",
  "Pubdate": "2023-11-14",
  "AffectedRange": "\u003c1.9.2.post0",
  "FixedVersions": [
    "1.9.2.post0"
  ],
  "AffectedVersions": "All versions before 1.9.2.post0",
  "NotImpacted": "All versions starting from 1.9.2.post0",
  "Solution": "Upgrade to version 1.9.2.post0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-47117",
    "https://github.com/advisories/GHSA-6hjj-gq77-j4qw",
    "https://github.com/HumanSignal/label-studio/security/advisories/GHSA-6hjj-gq77-j4qw",
    "https://github.com/HumanSignal/label-studio/commit/f931d9d129002f54a495995774ce7384174cef5c",
    "https://github.com/HumanSignal/label-studio",
    "https://github.com/pypa/advisory-database/tree/main/vulns/label-studio/PYSEC-2023-275.yaml"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
  "UUID": "2cb34eb3-36c6-4bfb-81a0-4e3d3de6f780"
}