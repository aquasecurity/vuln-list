{
  "Identifier": "CVE-2023-51663",
  "PackageSlug": "pypi/hail",
  "Title": "Hail relies on OIDC email claims to verify the validity of a user's domain.",
  "Description": "All Hail Batch clusters are affected. An attacker is able to:\n\n1. Create one or more accounts with Hail Batch without corresponding real accounts in the organization.\n\nFor example, a user could create a Microsoft or Google account and then change their email to \"inconspicuous@example.org\". This Microsoft or Google account can then be used to create a Hail Batch account in Hail Batch clusters whose organization domain is \"example.org\".\n\nIn Google, this attack is partially mitigated because Google requires users to verify ownership of their Google account. However, a valid user is able to create multiple distinct Hail Batch accounts by creating multiple distinct Google accounts using email addresses of the form \"real_user_email_name+random_id@example.org\".\n\nIn Microsoft, this attack requires Azure AD Administrator access to an Azure AD Tenant. The Azure AD Administrator is permitted to change the email address of an account to any other email address without verification. An attacker can create an Azure Tenant for free.\n\n1. The attacker *does not* have access to any private data (because the new service principals or service accounts are not granted any privileges).\n3. If trial Hail Batch billing projects are enabled, the attacker *does* have the ability to run jobs and thus spend money. An attacker can create as many accounts as Microsoft or Google permit.\n4. The attacker *cannot* impersonate another user because, in Azure, we use the `sub` from the OAuth2 response, and, in Google, Google does an email verification.",
  "Date": "2024-11-22",
  "Pubdate": "2024-01-02",
  "AffectedRange": "\u003c0.2.127",
  "FixedVersions": [
    "0.2.127"
  ],
  "AffectedVersions": "All versions before 0.2.127",
  "NotImpacted": "All versions starting from 0.2.127",
  "Solution": "Upgrade to version 0.2.127 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-51663",
    "https://github.com/advisories/GHSA-487p-qx68-5vjw",
    "https://github.com/hail-is/hail/security/advisories/GHSA-487p-qx68-5vjw",
    "https://github.com/hail-is/hail/commit/0dcc17ff24564b6f5592261d7975e8afd0f95de7",
    "https://github.com/hail-is/hail",
    "https://github.com/pypa/advisory-database/tree/main/vulns/hail/PYSEC-2023-271.yaml"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
  "UUID": "5c88b63a-a01e-4497-b26e-3933e05e0445"
}