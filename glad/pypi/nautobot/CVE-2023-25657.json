{
  "Identifier": "CVE-2023-25657",
  "PackageSlug": "pypi/nautobot",
  "Title": "Nautobot vulnerable to remote code execution via Jinja2 template rendering",
  "Description": "_What kind of vulnerability is it? Who is impacted?_\n\nAll users of Nautobot versions earlier than 1.5.7 are impacted.\n\nIn Nautobot 1.5.7 we have enabled sandboxed environments for the Jinja2 template engine used internally for template rendering for the following objects:\n\n- `extras.ComputedField`\n- `extras.CustomLink`\n- `extras.ExportTemplate`\n- `extras.Secret`\n- `extras.Webhook`\n\nWhile we are not aware of any active exploits, we have made this change as a preventative measure to protect against any potential remote code execution attacks utilizing maliciously crafted template code.\n\nThis change forces the Jinja2 template engine to use a [`SandboxedEnvironment`](https://jinja.palletsprojects.com/en/3.0.x/sandbox/#sandbox) on all new installations of Nautobot.\n\nThis addresses any potential unsafe code execution everywhere the helper function `nautobot.utilities.utils.render_jinja2` is called. Additionally, our documentation that was previously suggesting the direct use of `jinja2.Template` has been revised to utilize `render_jinja2`.",
  "Date": "2024-09-25",
  "Pubdate": "2023-02-22",
  "AffectedRange": "\u003c1.5.7",
  "FixedVersions": [
    "1.5.7"
  ],
  "AffectedVersions": "All versions before 1.5.7",
  "NotImpacted": "All versions starting from 1.5.7",
  "Solution": "Upgrade to version 1.5.7 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-25657",
    "https://github.com/advisories/GHSA-8mfq-f5wj-vw5m",
    "https://github.com/nautobot/nautobot/security/advisories/GHSA-8mfq-f5wj-vw5m",
    "https://github.com/nautobot/nautobot/commit/d47f157e83b0c353bb2b697f911882c71cf90ca0",
    "https://docs.nautobot.com/projects/core/en/stable/release-notes/version-1.5/#v157-2023-01-04",
    "https://github.com/nautobot/nautobot",
    "https://github.com/pypa/advisory-database/tree/main/vulns/nautobot/PYSEC-2023-37.yaml",
    "https://jinja.palletsprojects.com/en/3.0.x/sandbox/#sandbox"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "073cb815-000a-4514-842e-84d7819b11ad"
}