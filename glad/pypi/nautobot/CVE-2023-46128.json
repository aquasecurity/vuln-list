{
  "Identifier": "CVE-2023-46128",
  "PackageSlug": "pypi/nautobot",
  "Title": "Nautobot vulnerable to exposure of hashed user passwords via REST API",
  "Description": "In Nautobot 2.0.x, certain REST API endpoints, in combination with the `?depth=\u003cN\u003e` query parameter, can expose hashed user passwords as stored in the database to any authenticated user with access to these endpoints.\n\n\u003e The passwords are *not* exposed in plaintext.\n\u003e Nautobot 1.x is *not* affected by this vulnerability.\n\nExample:\n\n```\nGET /api/users/permissions/?depth=1\n\nHTTP 200 OK\nAPI-Version: 2.0\nAllow: GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\nContent-Type: application/json\nVary: Accept\n```\n\n```json\n{\n\"count\": 1,\n\"next\": null,\n\"previous\": null,\n\"results\": [\n{\n\"id\": \"28ea85e4-5039-4389-94f1-9a3e1c787149\",\n\"object_type\": \"users.objectpermission\",\n\"display\": \"Run Job\",\n\"url\": \"http://localhost:8080/api/users/permissions/28ea85e4-5039-4389-94f1-9a3e1c787149/\",\n\"natural_slug\": \"run-job_28ea\",\n\"object_types\": [\n\"extras.job\"\n],\n\"name\": \"Run Job\",\n\"description\": \"\",\n\"enabled\": true,\n\"actions\": [\n\"run\",\n\"view\"\n],\n\"constraints\": null,\n\"groups\": [\n{\n\"id\": 1,\n\"object_type\": \"auth.group\",\n\"display\": \"A Group\",\n\"url\": \"http://localhost:8080/api/users/groups/1/\",\n\"natural_slug\": \"a-group_1\",\n\"name\": \"A Group\"\n}\n],\n\"users\": [\n{\n\"id\": \"e73288e2-1326-4bfb-8fea-041290dd7473\",\n\"object_type\": \"users.user\",\n\"display\": \"admin\",\n\"url\": \"http://localhost:8080/api/users/users/e73288e2-1326-4bfb-8fea-041290dd7473/\",\n\"natural_slug\": \"admin_e732\",\n\"password\": \"pbkdf2_sha256$260000$jQb7hA48HYJ0MLWQgOZiBl$b72+gz6SpZiRpxceRQfT5Zv/aUac0eJ4NdBTZ8ECOow=\",\n\"last_login\": \"2023-10-18T14:19:08.780857Z\",\n\"is_superuser\": true,\n\"username\": \"admin\",\n\"first_name\": \"\",\n\"last_name\": \"\",\n\"email\": \"\",\n\"is_staff\": true,\n\"is_active\": true,\n\"date_joined\": \"2023-10-18T14:18:55.854023Z\",\n\"config_data\": {}\n}\n]\n}\n]\n}\n```\n\n\u003e Note the \"password\" field present in the nested `\"users\"` data.\n\nThis information is not exposed during direct access to the `/api/users/users/` endpoint, but can be exposed through any endpoint which contains a nested reference to User object(s) when an appropriate `?depth=\u003cN\u003e` query parameter is specified. Known impacted endpoints include:\n\n- `/api/dcim/rack-reservations/?depth=1`(or any greater `depth` value)\n- `/api/extras/job-results/?depth=1` (or any greater `depth` value)\n- `/api/extras/notes/?depth=1` (or any greater `depth` value)\n- `/api/extras/object-changes/?depth=1` (or any greater `depth` value)\n- `/api/extras/scheduled-jobs/?depth=1` (or any greater `depth` value)\n- `/api/users/permissions/?depth=1` (or any greater `depth` value)\n\nbut this is not necessarily an exhaustive list.\n\n\u003e Plugin REST API endpoints for any models with a foreign key to the User model may also be impacted by this issue.\n\n\u003e The patch identified below mitigates the issue for both Nautobot core REST APIs and plugin REST APIs; no code change in plugins is required to address this issue.",
  "Date": "2024-10-07",
  "Pubdate": "2023-10-24",
  "AffectedRange": "\u003e=2.0.0,\u003c2.0.3",
  "FixedVersions": [
    "2.0.3"
  ],
  "AffectedVersions": "All versions starting from 2.0.0 before 2.0.3",
  "NotImpacted": "All versions before 2.0.0, all versions starting from 2.0.3",
  "Solution": "Upgrade to version 2.0.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-46128",
    "https://github.com/advisories/GHSA-r2hw-74xv-4gqp",
    "https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hw-74xv-4gqp",
    "https://github.com/nautobot/nautobot/pull/4692",
    "https://github.com/nautobot/nautobot/commit/1ce8e5c658a075c29554d517cd453675e5d40d71",
    "https://github.com/nautobot/nautobot",
    "https://github.com/pypa/advisory-database/tree/main/vulns/nautobot/PYSEC-2023-220.yaml"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
  "UUID": "0a285c75-c4ea-4bd2-b27c-35a6928aeba7"
}