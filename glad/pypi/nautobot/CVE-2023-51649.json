{
  "Identifier": "CVE-2023-51649",
  "PackageSlug": "pypi/nautobot",
  "Title": "Nautobot missing object-level permissions enforcement when running Job Buttons",
  "Description": "When submitting a Job to run via a Job Button, only the model-level `extras.run_job` permission is checked (i.e., does the user have permission to run Jobs in general?). Object-level permissions (i.e., does the user have permission to run this *specific* Job?) are not enforced by the URL/view used in this case (`/extras/job-button/\u003cuuid\u003e/run/`) The effect is that a user with permissions to run even a single Job can actually run all configured JobButton Jobs.\n\n\u003e Not all Jobs can be configured as JobButtons; only those implemented as subclasses of `JobButtonReceiver` can be used in this way, so this vulnerability only applies specifically to `JobButtonReceiver` subclasses.\n\nAdditionally, although the documentation states that both `extras.run_job` permission and `extras.run_jobbutton` permission must be granted to a user in order to run Jobs via JobButton, the `extras.run_jobbutton` permission is not actually enforced by the view code, only by the UI by disabling the button from being clicked normally. Furthermore, the `extras.run_jobbutton` permission never prevented invoking Jobs (including `JobButtonReceiver` subclasses) via the normal \"Job Run\" UI, so after some discussion, we've decided that the `extras.run_jobbutton` permission is redundant, and as it never achieved its stated/documented purpose, the fixes below will remove the UI check for `extras.run_jobbutton` and all other references to the `extras.run_jobbutton` permission, rather than adding enforcement of this previously unenforced permission.",
  "Date": "2024-11-22",
  "Pubdate": "2023-12-22",
  "AffectedRange": "\u003e=1.5.14,\u003c1.6.8||\u003e=2.0.0,\u003c2.1.0",
  "FixedVersions": [
    "1.6.8",
    "2.1.0"
  ],
  "AffectedVersions": "All versions starting from 1.5.14 before 1.6.8, all versions starting from 2.0.0 before 2.1.0",
  "NotImpacted": "All versions before 1.5.14, all versions starting from 1.6.8 before 2.0.0, all versions starting from 2.1.0",
  "Solution": "Upgrade to versions 1.6.8, 2.1.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-51649",
    "https://github.com/advisories/GHSA-vf5m-xrhm-v999",
    "https://github.com/nautobot/nautobot/security/advisories/GHSA-vf5m-xrhm-v999",
    "https://github.com/nautobot/nautobot/issues/4988",
    "https://github.com/nautobot/nautobot/pull/4993",
    "https://github.com/nautobot/nautobot/pull/4995",
    "https://github.com/nautobot/nautobot/commit/3d964f996f4926126c1d7853ca87b2ff475997a2",
    "https://github.com/nautobot/nautobot/commit/d33d0c15a36948c45244e5b5e10bc79b8e62de7f",
    "https://github.com/nautobot/nautobot",
    "https://github.com/pypa/advisory-database/tree/main/vulns/nautobot/PYSEC-2023-287.yaml"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
  "UUID": "945f37e7-d7ad-4145-b163-72de56c0084b"
}