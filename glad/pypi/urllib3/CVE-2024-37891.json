{
  "Identifier": "CVE-2024-37891",
  "PackageSlug": "pypi/urllib3",
  "Title": "urllib3's Proxy-Authorization request header isn't stripped during cross-origin redirects",
  "Description": "When using urllib3's proxy support with `ProxyManager`, the `Proxy-Authorization` header is only sent to the configured proxy, as expected.\n\nHowever, when sending HTTP requests *without* using urllib3's proxy support, it's possible to accidentally configure the `Proxy-Authorization` header even though it won't have any effect as the request is not using a forwarding proxy or a tunneling proxy. In those cases, urllib3 doesn't treat the `Proxy-Authorization` HTTP header as one carrying authentication material and thus doesn't strip the header on cross-origin redirects.\n\nBecause this is a highly unlikely scenario, we believe the severity of this vulnerability is low for almost all users. Out of an abundance of caution urllib3 will automatically strip the `Proxy-Authorization` header during cross-origin redirects to avoid the small chance that users are doing this on accident.\n\nUsers should use urllib3's proxy support or disable automatic redirects to achieve safe processing of the `Proxy-Authorization` header, but we still decided to strip the header by default in order to further protect users who aren't using the correct approach.",
  "Date": "2025-11-04",
  "Pubdate": "2024-06-17",
  "AffectedRange": "\u003c1.26.19||\u003e=2.0.0,\u003c2.2.2",
  "FixedVersions": [
    "1.26.19",
    "2.2.2"
  ],
  "AffectedVersions": "All versions before 1.26.19, all versions starting from 2.0.0 before 2.2.2",
  "NotImpacted": "All versions starting from 1.26.19 before 2.0.0, all versions starting from 2.2.2",
  "Solution": "Upgrade to versions 1.26.19, 2.2.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-37891",
    "https://github.com/advisories/GHSA-34jh-p97f-mpxf",
    "https://github.com/urllib3/urllib3/security/advisories/GHSA-34jh-p97f-mpxf",
    "https://github.com/urllib3/urllib3/commit/40b6d1605814dd1db0a46e202d6e56f2e4c9a468",
    "https://github.com/urllib3/urllib3/commit/accff72ecc2f6cf5a76d9570198a93ac7c90270e",
    "https://github.com/urllib3/urllib3",
    "https://lists.debian.org/debian-lts-announce/2024/12/msg00020.html",
    "https://security.netapp.com/advisory/ntap-20240822-0003",
    "https://www.vicarius.io/vsociety/posts/proxy-authorization-header-handling-vulnerability-in-urllib3-cve-2024-37891"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
  "UUID": "021e191e-ce29-479c-9402-31794dcd0855"
}