{
  "Identifier": "CVE-2022-39374",
  "PackageSlug": "pypi/matrix-synapse",
  "Title": "Synapse Denial of service due to incorrect application of event authorization rules during state resolution",
  "Description": "If Synapse and a malicious homeserver are both joined to the same room, the malicious homeserver can trick Synapse into accepting previously rejected events into its view of the current state of that room. This can be exploited in a way that causes all further messages and state changes sent in that room from the vulnerable homeserver to be rejected.\n\nSynapse homeservers are affected by this issue if and only if they are joined to rooms which members of untrusted homeservers are joined or invited to.\n\n- Synapse homeservers in rooms available over public federation **are** affected.\n- Synapse homeservers with federation disabled are not affected.\n- Synapse homeservers in a closed federation containing only trusted servers are not affected.\n- Synapse homeservers which are only joined to rooms with federation disabled[^1] are not affected.",
  "Date": "2024-09-30",
  "Pubdate": "2023-05-24",
  "AffectedRange": "\u003e=1.62.0,\u003c1.68.0rc1",
  "FixedVersions": [
    "1.68.0rc1"
  ],
  "AffectedVersions": "All versions starting from 1.62.0 before 1.68.0rc1",
  "NotImpacted": "All versions before 1.62.0, all versions starting from 1.68.0rc1",
  "Solution": "Upgrade to version 1.68.0rc1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-39374",
    "https://github.com/advisories/GHSA-p9qp-c452-f9r7",
    "https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7",
    "https://github.com/matrix-org/synapse/pull/13723",
    "https://github.com/matrix-org/synapse/commit/b73cbb82157d9666e8d667733afebc0d09ed858c",
    "https://github.com/matrix-org/synapse",
    "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-66.yaml",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UJIJRP5ZH6B3KGFLHCAKR2IX2Y4Z25QD"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "UUID": "2df52be7-343b-4c83-8e9a-3087fa726960"
}