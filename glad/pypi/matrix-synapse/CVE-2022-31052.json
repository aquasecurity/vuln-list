{
  "Identifier": "CVE-2022-31052",
  "PackageSlug": "pypi/matrix-synapse",
  "Title": "URL previews of unusual or maliciously-crafted pages can crash Synapse media repositories or Synapse monoliths",
  "Description": "URL previews of some web pages can exhaust the available stack space for the Synapse process due to unbounded recursion.\nThis is sometimes recoverable and leads to an error for the request causing the problem, but in other cases the Synapse process may crash altogether.\n\nIt is possible to exploit this maliciously, either by malicious users on the homeserver, or by remote users sending URLs that a local user's client may automatically request a URL preview for.\nRemote users are not able to exploit this directly, because [the URL preview endpoint is authenticated](https://spec.matrix.org/v1.2/client-server-api/#get_matrixmediav3preview_url).",
  "Date": "2024-09-30",
  "Pubdate": "2022-06-29",
  "AffectedRange": "\u003c1.61.1",
  "FixedVersions": [
    "1.61.1"
  ],
  "AffectedVersions": "All versions before 1.61.1",
  "NotImpacted": "All versions starting from 1.61.1",
  "Solution": "Upgrade to version 1.61.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-31052",
    "https://github.com/advisories/GHSA-22p3-qrh9-cx32",
    "https://github.com/matrix-org/synapse/security/advisories/GHSA-22p3-qrh9-cx32",
    "https://github.com/matrix-org/synapse/commit/fa1308061802ac7b7d20e954ba7372c5ac292333",
    "https://github.com/matrix-org/synapse",
    "https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2022-224.yaml",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7EARKKJZ2W7WUITFDT4EG4NVATFYJQHF",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QGSDQ4YAITCUACAB7SXQZDJIU3IQ4CJD",
    "https://spec.matrix.org/v1.2/client-server-api/#get_matrixmediav3preview_url"
  ],
  "CvssV2": "AV:N/AC:M/Au:S/C:N/I:N/A:P",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "UUID": "40b8d1a0-1e70-4740-a209-1f3b9e5e3934"
}