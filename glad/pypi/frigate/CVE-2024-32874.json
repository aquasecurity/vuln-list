{
  "Identifier": "CVE-2024-32874",
  "PackageSlug": "pypi/frigate",
  "Title": "Malicious Long Unicode filenames may cause a Multiple Application-level Denial of Service",
  "Description": "When uploading a file or retrieving the filename, a user may intentionally use a large Unicode filename which would lead to a application-level denial of service. This is due to no limitation set on the length of the filename and the costy use of the Unicode normalization with the form NFKD under the hood of `secure_filename()`.\n\nI idenfied multiple vulnerable paths on [blakeblackshear/frigate](https://www.github.com/blakeblackshear/frigate/) repository. In all of those paths, it was possible for a malicious user to send a filename equals to the output of : `python3 -c \"print('â„€' * 1_000_000)\"` which would reach the werkzeug `secure_filename()` call , which in turn under the hood uses a compatibility Unicode normalization with NFKC/NFKD form. In sum, the latter call would be costly in matter of CPU resource and may lead to the application-level denial of service.",
  "Date": "2024-05-09",
  "Pubdate": "2024-05-09",
  "AffectedRange": "\u003c0.13.2",
  "FixedVersions": [
    "0.13.2"
  ],
  "AffectedVersions": "All versions before 0.13.2",
  "NotImpacted": "All versions starting from 0.13.2",
  "Solution": "Upgrade to version 0.13.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-32874",
    "https://github.com/advisories/GHSA-w4h6-9wrp-v5jq",
    "https://github.com/blakeblackshear/frigate/security/advisories/GHSA-w4h6-9wrp-v5jq",
    "https://github.com/blakeblackshear/frigate",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88",
    "https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H",
  "UUID": "e35fe3e6-e908-4b97-bb1f-80146fe343fa"
}