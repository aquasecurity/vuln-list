{
  "Identifier": "CVE-2022-39327",
  "PackageSlug": "pypi/azure-cli",
  "Title": "Improper Control of Generation of Code ('Code Injection') in Azure CLI",
  "Description": "In versions previous to 2.40.0, Azure CLI contains a vulnerability for potential code injection. Critical scenarios are where a hosting machine runs an Azure CLI command where parameter values have been provided by an external source.\n\nFor example: Application X is a web application with a feature that allows users to create Secrets in an Azure KeyVault. Instead of constructing API calls based on user input, Application X uses Azure CLI commands to create the secrets. Application X has input fields presented to the user and the Azure CLI command parameter values are filled based on the user input fields. This input, when formed correctly, could potentially be run as system commands. Below is an example of the resulting Azure CLI command run on the web app's hosting machine.\n\n```bash\naz keyvault secret set --vault-name SomeVault --name foobar --value \"abc123|whoami\"\n```\n\nThe above command could potentially run the `whoami` command on the hosting machine.\n\nInteractive, in-terminal use and automation/pipeline scenarios have not been identified as critical risk scenarios.",
  "Date": "2025-04-09",
  "Pubdate": "2022-10-25",
  "AffectedRange": "\u003c2.40.0",
  "FixedVersions": [
    "2.40.0"
  ],
  "AffectedVersions": "All versions before 2.40.0",
  "NotImpacted": "All versions starting from 2.40.0",
  "Solution": "Upgrade to version 2.40.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-39327",
    "https://github.com/advisories/GHSA-47xc-9rr2-q7p4",
    "https://github.com/Azure/azure-cli/security/advisories/GHSA-47xc-9rr2-q7p4",
    "https://github.com/Azure/azure-cli/pull/23514",
    "https://github.com/Azure/azure-cli/pull/24015",
    "https://github.com/Azure/azure-cli",
    "https://github.com/pypa/advisory-database/tree/main/vulns/azure-cli/PYSEC-2022-43177.yaml"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "77e11907-930c-4ebb-a29d-7b06aa95a15f"
}