{
  "Identifier": "CVE-2025-54059",
  "PackageSlug": "go/chainguard.dev/melange",
  "Title": "melange's world-writable permissions expose SBOM files to potential image tampering",
  "Description": "It was discovered that the SBOM files generated by melange in apks had file system permissions mode 666:\n```\n$ apkrane ls https://packages.wolfi.dev/os/x86_64/APKINDEX.tar.gz -P hello-wolfi --full --latest  | xargs wget -q -O  - | tar tzv 2\u003e/dev/null var/lib/db/sbom\ndrwxr-xr-x root/root         0 2025-06-23 14:17 var/lib/db/sbom\n-rw-rw-rw- root/root      3383 2025-06-23 14:17 var/lib/db/sbom/hello-wolfi-2.12.2-r1.spdx.json\n```\n\nThis issue was introduced in commit 1b272db (\"Persist workspace filesystem throughout package builds (#1836)\") ([v0.23.0](https://github.com/chainguard-dev/melange/releases/tag/v0.23.0)).",
  "Date": "2025-07-18",
  "Pubdate": "2025-07-18",
  "AffectedRange": "\u003e=0.23.0 \u003c0.29.5",
  "FixedVersions": [
    "0.29.5"
  ],
  "AffectedVersions": "All versions starting from 0.23.0 before 0.29.5",
  "NotImpacted": "All versions before 0.23.0, all versions starting from 0.29.5",
  "Solution": "Upgrade to version 0.29.5 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-54059",
    "https://github.com/advisories/GHSA-5662-cv6m-63wh",
    "https://github.com/chainguard-dev/melange/security/advisories/GHSA-5662-cv6m-63wh",
    "https://github.com/chainguard-dev/melange/pull/1836",
    "https://github.com/chainguard-dev/melange/pull/2086",
    "https://github.com/chainguard-dev/melange/commit/1b272db2a0bb3441553284cc56d87236b4b64c04",
    "https://github.com/chainguard-dev/melange/commit/e29494b4a40a91619ec1c87a09003c6d5164cea1",
    "https://github.com/chainguard-dev/melange",
    "https://github.com/chainguard-dev/melange/releases/tag/v0.29.5"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L",
  "UUID": "022b3865-1d1d-4ca8-b37f-3c0ead9af517"
}