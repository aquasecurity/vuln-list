{
  "Identifier": "CVE-2025-59353",
  "PackageSlug": "go/d7y.io/dragonfly/v2",
  "Title": "DragonFly's manager generates mTLS certificates for arbitrary IP addresses",
  "Description": "A peer can obtain a valid TLS certificate for arbitrary IP addresses, effectively rendering the mTLS authentication useless. The issue is that the Manager’s Certificate gRPC service does not validate if the requested IP addresses “belong to” the peer requesting the certificate—that is, if the peer connects from the same IP address as the one provided in the certificate request.\n\n```golang\nif addr, ok := p.Addr.(*net.TCPAddr); ok {\nip = addr.IP.String()\n} else {\nip, _, err = net.SplitHostPort(p.Addr.String())\nif err != nil {\nreturn nil, err\n}\n}\n// Parse csr.\n[skipped]\n// Check csr signature.\n// TODO check csr common name and so on.\nif err = csr.CheckSignature(); err != nil {\nreturn nil, err\n}\n[skipped]\n// TODO only valid for peer ip\n// BTW we need support both of ipv4 and ipv6.\nips := csr.IPAddresses\nif len(ips) == 0 {\n// Add default connected ip.\nips = []net.IP{net.ParseIP(ip)}\n}\n```",
  "Date": "2025-11-10",
  "Pubdate": "2025-09-17",
  "AffectedRange": "\u003c2.1.0",
  "FixedVersions": [
    "2.1.0"
  ],
  "AffectedVersions": "All versions before 2.1.0",
  "NotImpacted": "All versions starting from 2.1.0",
  "Solution": "Upgrade to version 2.1.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-59353",
    "https://github.com/advisories/GHSA-255v-qv84-29p5",
    "https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5",
    "https://github.com/dragonflyoss/dragonfly",
    "https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf",
    "https://pkg.go.dev/vuln/GO-2025-3969"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "UUID": "573c403a-7234-4f9f-8a32-3a88bd3cacda"
}