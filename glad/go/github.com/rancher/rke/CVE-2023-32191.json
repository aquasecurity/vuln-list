{
  "Identifier": "CVE-2023-32191",
  "PackageSlug": "go/github.com/rancher/rke",
  "Title": "rke's credentials are stored in the RKE1 Cluster state ConfigMap",
  "Description": "When RKE provisions a cluster, it stores the cluster state in a configmap called `full-cluster-state` inside the `kube-system` namespace of the cluster itself. This cluster state object contains information used to set up the K8s cluster, which may include the following sensitive data:\n\n- RancherKubernetesEngineConfig\n- RKENodeConfig\n- SSH username\n- SSH private key\n- SSH private key path\n- RKEConfigServices\n- ETCDService\n- External client key\n- BackupConfig\n- S3BackupConfig\n- AWS access key\n- AWS secret key\n- KubeAPIService\n- SecretsEncryptionConfig\n- K8s encryption configuration (contains encryption keys)\n- PrivateRegistries\n- User\n- Password\n- ECRCredentialPlugin\n- AWS access key\n- AWS secret key\n- AWS session token\n- CloudProvider\n- AzureCloudProvider\n- AAD client ID\n- AAD client secret\n- AAD client cert password\n- OpenstackCloudProvider\n- Username\n- User ID\n- Password\n- VsphereCloudProvider\n- GlobalVsphereOpts\n- User\n- Password\n- VirtualCenterConfig\n- User\n- Password\n- HarvesterCloudProvider\n- CloudConfig\n- CustomCloudProvider\n- BastionHost\n- User\n- SSH key\n- CertificatesBundle\n- Private key\n- EncryptionConfig\n- Private key\n",
  "Date": "2024-10-16",
  "Pubdate": "2024-06-17",
  "AffectedRange": "\u003e=1.4.18 \u003c1.4.19||\u003e=1.5.9 \u003c1.5.10",
  "FixedVersions": [
    "1.4.19",
    "1.5.10"
  ],
  "AffectedVersions": "All versions starting from 1.4.18 before 1.4.19, all versions starting from 1.5.9 before 1.5.10",
  "NotImpacted": "All versions before 1.4.18, all versions starting from 1.4.19 before 1.5.9, all versions starting from 1.5.10",
  "Solution": "Upgrade to versions 1.4.19, 1.5.10 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-32191",
    "https://github.com/advisories/GHSA-6gr4-52w6-vmqx",
    "https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx",
    "https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd",
    "https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32191",
    "https://github.com/rancher/rke"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
  "UUID": "4c96dde3-8b56-4d43-b21f-ce25e1ff7f36"
}