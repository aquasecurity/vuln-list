{
  "Identifier": "CVE-2023-22647",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Rancher vulnerable to Privilege Escalation via manipulation of Secrets",
  "Description": "A vulnerability has been identified which enables Standard users or above to elevate their permissions to Administrator in the `local` cluster.\n\nThe `local` cluster means the cluster where Rancher is installed. It is named `local` inside the list of clusters in the Rancher UI.\n\nStandard users could leverage their existing permissions to manipulate Kubernetes secrets in the `local` cluster, resulting in the secret being deleted, but their read-level permissions to the secret being preserved. When this operation was followed-up by other specially crafted commands, it could result in the user gaining access to tokens belonging to service accounts in the `local` cluster.\n\nUsers that have custom global roles which grant `create` and `delete` permissions on `secrets` would also be able to exploit this vulnerability.\n\nUsers with audit logs enabled in Rancher can try to identify possible abuses of this issue by going through the logs. To sieve through the data filter by `kind: Secret` with `type: provisioning.cattle.io/cloud-credential`, then investigate all log entries that affect that specific resource. A secondary check would be to filter by all operations with `Opaque` Secrets within the `cattle-global-data` namespace.\n\nAfter patching, it is recommended that users review access methods to Rancher (including RBAC policies, tokens, and host-level node access), to ensure that no changes were made to persist access to users who have leveraged this vulnerability.",
  "Date": "2024-09-16",
  "Pubdate": "2023-06-06",
  "AffectedRange": "\u003e=2.6.0 \u003c2.6.13||\u003e=2.7.0 \u003c2.7.4",
  "FixedVersions": [
    "2.6.13",
    "2.7.4"
  ],
  "AffectedVersions": "All versions starting from 2.6.0 before 2.6.13, all versions starting from 2.7.0 before 2.7.4",
  "NotImpacted": "All versions before 2.6.0, all versions starting from 2.6.13 before 2.7.0, all versions starting from 2.7.4",
  "Solution": "Upgrade to versions 2.6.13, 2.7.4 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-22647",
    "https://github.com/advisories/GHSA-p976-h52c-26p6",
    "https://github.com/rancher/rancher/security/advisories/GHSA-p976-h52c-26p6",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-22647",
    "https://github.com/rancher/rancher",
    "https://github.com/rancher/rancher/releases/tag/v2.6.13",
    "https://github.com/rancher/rancher/releases/tag/v2.7.4"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "eb523266-da2d-475b-9835-3ec3eb3db435"
}