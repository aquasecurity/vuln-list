{
  "Identifier": "CVE-2024-58269",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Rancher exposes sensitive information through audit logs",
  "Description": "**Note: The exploitation of this issue requires that the malicious user have access to Rancherâ€™s audit log storage.**\n\nA vulnerability has been identified in Rancher Manager, where sensitive information, including secret data, cluster import URLs, and registration tokens, is exposed to any entity with access to Rancher audit logs. This happens in two different ways:\n\n1. Secret Annotation Leakage: When creating Kubernetes Secrets using the `stringData` field, the cleartext value is embedded in the `kubectl.kubernetes.io/last-applied-configuration` annotation. This annotation is included in Rancher audit logs within both the request and response bodies, exposing secret material that should be redacted.\n2. Cluster Registration Token Leakage: During the import or creation of downstream clusters (Custom, Imported, or Harvester), Rancher audit logs record full cluster registration manifests and tokens, including:\na. Non-expiring import URLs such as `/v3/import/\u003ctoken\u003e_c-m-xxxx.yaml`.\nb. Full `kubectl apply` and `curl` commands containing registration tokens and CA checksums.\nc. Token values associated with cluster registration resources (`clusterRegistrationToken`).\nd. These tokens are valid until explicitly revoked and can be used to re-register nodes, granting unauthorized cluster access.\n\nAn attacker or internal user who gains access to these logs could:\n- Recover plaintext secret values from annotations.\n- Use cluster registration tokens or import URLs to re-enroll agents or compromise downstream clusters.\n- Access clusters that rely on these tokens for authentication, enabling lateral movement.\n\nPlease consult the associated  [MITRE ATT\u0026CK - Technique - Log Enumeration](https://attack.mitre.org/techniques/T1654/) for further information about this category of attack.",
  "Date": "2025-10-31",
  "Pubdate": "2025-10-24",
  "AffectedRange": "\u003c0.0.0-20251013203444-50dc516a19ea",
  "FixedVersions": [
    "0.0.0-20251013203444-50dc516a19ea"
  ],
  "AffectedVersions": "All versions before 0.0.0-20251013203444-50dc516a19ea",
  "NotImpacted": "All versions starting from 0.0.0-20251013203444-50dc516a19ea",
  "Solution": "Upgrade to version 0.0.0-20251013203444-50dc516a19ea or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-58269",
    "https://github.com/advisories/GHSA-mw39-9qc2-f7mg",
    "https://github.com/rancher/rancher/security/advisories/GHSA-mw39-9qc2-f7mg",
    "https://github.com/rancher/rancher/commit/26ad9216e94f77b5471f638256a6989030572adc",
    "https://github.com/rancher/rancher/commit/50dc516a19ea216e270f738912dc8d0c9ca99d5d",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58269",
    "https://github.com/rancher/rancher"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
  "UUID": "ab7d35e3-b4ae-4fcb-990f-02896414951f"
}