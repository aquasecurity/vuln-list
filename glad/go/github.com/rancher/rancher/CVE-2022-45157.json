{
  "Identifier": "CVE-2022-45157",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Exposure of vSphere's CPI and CSI credentials in Rancher",
  "Description": "A vulnerability has been identified in the way that Rancher stores vSphere's CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials used to deploy clusters through the vSphere cloud provider. This issue leads to the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher. This vulnerability is only applicable to users that deploy clusters in vSphere environments.\n\nThe exposed passwords were accessible in the following objects:\n\n- Can be accessed by users that are cluster members of the provisioned clusters:\n- When provisioning a new cluster with the vSphere cloud provider through Rancher's UI (user interface), Cluster Templates and Terraform on the object `provisioning.cattle.io` in `spec.rkeConfig.chartValues.rancher-vsphere-cpi` and `spec.rkeConfig.chartValues.rancher-vsphere-csi`.\n- On the object `rke.cattle.io.rkecontrolplane` in `spec.chartValues.rancher-vsphere-cpi` and `spec.chartValues.rancher-vsphere-csi`.\n- Can be accessed by users with privileged access to the clusters' infrastructure (host OS):\n- Inside the `plan` files in the provisioned downstream clusters' filesystems.\n\n**Note:** if you believe that the vSphere credentials might have been accessed by unauthorized users, it's highly recommended to change them, after updating Rancher to a patched version.\n\nPlease consult the associated  [MITRE ATT\u0026CK - Technique -  Credential Access](https://attack.mitre.org/tactics/TA0006/) for further information about this category of attack.",
  "Date": "2024-11-13",
  "Pubdate": "2024-10-25",
  "AffectedRange": "\u003e=2.9.0 \u003c2.9.3||\u003e=2.7.0 \u003c2.8.9",
  "FixedVersions": [
    "2.9.3",
    "2.8.9"
  ],
  "AffectedVersions": "All versions starting from 2.7.0 before 2.8.9, all versions starting from 2.9.0 before 2.9.3",
  "NotImpacted": "All versions before 2.7.0, all versions starting from 2.8.9 before 2.9.0, all versions starting from 2.9.3",
  "Solution": "Upgrade to versions 2.8.9, 2.9.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-45157",
    "https://github.com/advisories/GHSA-xj7w-r753-vj8v",
    "https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2022-45157",
    "https://github.com/rancher/rancher"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:L",
  "UUID": "48477e7f-3567-40e2-bcc2-a6b662373b4a"
}