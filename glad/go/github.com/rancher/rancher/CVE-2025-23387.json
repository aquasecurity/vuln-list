{
  "Identifier": "CVE-2025-23387",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Rancher's SAML-based login via CLI can be denied by unauthenticated users",
  "Description": "A vulnerability has been identified within Rancher where it is possible for an unauthenticated user to list all CLI authentication tokens and delete them before the CLI is able to get the token value. This effectively prevents users from logging in via the CLI when using rancher token as the execution command (instead of the token directly being in the kubeconfig).\n\nNote that this token is not the kubeconfig token and if an attacker is able to intercept it they can't use it to impersonate a real user since it is encrypted.\n\nThis happens because for SAML-based authentication providers, the login flow from the CLI works by generating a link to be pasted in the browser, and then polling every 10 seconds for the `/v3-public/authTokens/\u003ctoken name\u003e` endpoint.  The `\u003ctoken name\u003e` is randomly generated by the CLI. Once the login flow succeeds, Rancher creates an auth token (with an encrypted token value). The CLI then deletes the authToken.\n\n\nRancher deployments using only the local authentication provider, or non-SAML-based authentication providers, are not impacted by this vulnerability. SAML-based users not using the CLI are also not impacted.\n\n\nPlease consult the associated  [MITRE ATT\u0026CK - Technique - Account Access Removal](https://attack.mitre.org/techniques/T1531/) for further information about this category of attack.",
  "Date": "2025-05-27",
  "Pubdate": "2025-02-27",
  "AffectedRange": "\u003e=2.8.0 \u003c2.8.13||\u003e=2.9.0 \u003c2.9.7||\u003e=2.10.0 \u003c2.10.3",
  "FixedVersions": [
    "2.8.13",
    "2.9.7",
    "2.10.3"
  ],
  "AffectedVersions": "All versions starting from 2.8.0 before 2.8.13, all versions starting from 2.9.0 before 2.9.7, all versions starting from 2.10.0 before 2.10.3",
  "NotImpacted": "All versions before 2.8.0, all versions starting from 2.8.13 before 2.9.0, all versions starting from 2.9.7 before 2.10.0, all versions starting from 2.10.3",
  "Solution": "Upgrade to versions 2.10.3, 2.8.13, 2.9.7 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-23387",
    "https://github.com/advisories/GHSA-5qmp-9x47-92q8",
    "https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8",
    "https://github.com/rancher/rancher/pull/48616",
    "https://github.com/rancher/rancher/pull/48998",
    "https://github.com/rancher/rancher/pull/48999",
    "https://github.com/rancher/rancher/pull/49000",
    "https://github.com/rancher/rancher/commit/2481630c4a5a75d81eb69d10d7558ea833395a1e",
    "https://github.com/rancher/rancher/commit/bedd911b9b321436faa2d9e20a161f6ac396aa74",
    "https://github.com/rancher/rancher/commit/ceeedb1aa67c319f4873615f19c3f56a66f39706",
    "https://github.com/rancher/rancher/commit/dfa034d05a55b5e57990a1f700176dcd8e963dbc",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387",
    "https://github.com/rancher/rancher",
    "https://github.com/rancher/rancher/releases/tag/v2.10.3",
    "https://github.com/rancher/rancher/releases/tag/v2.8.13",
    "https://github.com/rancher/rancher/releases/tag/v2.9.7"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
  "UUID": "7f450898-1f65-4cd8-a8dd-fd7f586792bc"
}