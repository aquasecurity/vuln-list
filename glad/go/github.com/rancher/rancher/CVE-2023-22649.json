{
  "Identifier": "CVE-2023-22649",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Rancher 'Audit Log' leaks sensitive information",
  "Description": "A vulnerability has been identified which may lead to sensitive data being leaked into Rancher's audit logs. [Rancher Audit Logging](https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-api-audit-log) is an opt-in feature, only deployments that have it enabled and have [AUDIT_LEVEL](https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-api-audit-log#audit-log-levels) set to `1 or above` are impacted by this issue.\n\nThe leaks might be caught in the audit logs upon these actions:\n\n- Creating cloud credentials or new authentication providers. It is crucial to note that **all** [authentication providers](https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config#external-vs-local-authentication) (such as AzureAD) and [cloud providers](https://ranchermanager.docs.rancher.com/pages-for-subheaders/set-up-cloud-providers) (such as Google) are impacted.\n- Downloading a kubeconfig file from a downstream or a local cluster.\n- Logging in/out from Rancher.\n\nThe affected data may include the following:\n\n- HTTP headers\n\nField | Location\n-- | --\nX-Api-Auth-Header | Request header\nX-Api-Set-Cookie-Header | Response header\nX-Amz-Security-Token | Request header\ncredentials | Request body\napplicationSecret | Request Body\noauthCredential | Request Body\nserviceAccountCredential | Request Body\nspKey | Request Body\nspCert | Request body\nspCert | Response body\ncertificate | Request body\nprivateKey | Request body\n\n- API Server calls returning `Secret` objects (including sub-types, such as `kubernetes.io/dockerconfigjson`).\n- Raw command lines used by agents to connect to the Rancher server which expose sensitive information (e.g. `register ... --token abc`).\n- `Kubeconfig` contents when the 'Download KubeConfig' feature is used in the Rancher UI.\n\nThe patched versions will redact the sensitive data, replacing it with `[redacted]`, making it safer for consumption. It is recommended that static secrets are rotated after the system is patched, to limit the potential impact of sensitive data being misused due to this vulnerability.\n\n**Note:**\n1. The severity of the vulnerability is intricately tied to the logging strategy employed. If logs are kept locally (default configuration), the impact is contained within the system, limiting the exposure.\nHowever, when logs are shipped to an external endpoint, the vulnerability's severity might increase, as resistance against leaks is contingent on the security measures implemented at the external log collector level.\n2. The final impact severity for confidentiality, integrity and availability is dependent on the permissions that the leaked credentials have on their own services.",
  "Date": "2024-10-16",
  "Pubdate": "2024-02-08",
  "AffectedRange": "\u003e=2.6.0 \u003c2.6.14||\u003e=2.7.0 \u003c2.7.10||\u003e=2.8.0 \u003c2.8.2",
  "FixedVersions": [
    "2.6.14",
    "2.7.10",
    "2.8.2"
  ],
  "AffectedVersions": "All versions starting from 2.6.0 before 2.6.14, all versions starting from 2.7.0 before 2.7.10, all versions starting from 2.8.0 before 2.8.2",
  "NotImpacted": "All versions before 2.6.0, all versions starting from 2.6.14 before 2.7.0, all versions starting from 2.7.10 before 2.8.0, all versions starting from 2.8.2",
  "Solution": "Upgrade to versions 2.6.14, 2.7.10, 2.8.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-22649",
    "https://github.com/advisories/GHSA-xfj7-qf8w-2gcr",
    "https://github.com/rancher/rancher/security/advisories/GHSA-xfj7-qf8w-2gcr",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-22649",
    "https://github.com/rancher/rancher"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H",
  "UUID": "a91c23bc-9a5c-4445-b8c5-9e71016b7ce0"
}