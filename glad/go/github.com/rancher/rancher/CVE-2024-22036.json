{
  "Identifier": "CVE-2024-22036",
  "PackageSlug": "go/github.com/rancher/rancher",
  "Title": "Rancher Remote Code Execution via Cluster/Node Drivers",
  "Description": "A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the `chroot` jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a â€“privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system.\n\nThis happens because:\n- During startup, Rancher appends the `/opt/drivers/management-state/bin` directory to the `PATH` environment variable.\n- In Rancher, the binaries `/usr/bin/rancher-machine`, `/usr/bin/helm_v3`, and `/usr/bin/kustomize` are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.\n- Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.\n- During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.\n- Lack of validation on the driver file type, which allows symbolic links to be used.\n\n\nPlease consult the associated  [MITRE ATT\u0026CK - Technique - Privilege Escalation](https://attack.mitre.org/tactics/TA0004/) and [MITRE ATT\u0026CK - Technique - Execution](https://attack.mitre.org/tactics/TA0002/) for further information about this category of attack.\n\n**Since they run at a privileged level, it is recommended to use trusted drivers only.**",
  "Date": "2025-04-16",
  "Pubdate": "2024-10-25",
  "AffectedRange": "\u003e=2.7.0 \u003c2.7.16||\u003e=2.8.0 \u003c2.8.9||\u003e=2.9.0 \u003c2.9.3",
  "FixedVersions": [
    "2.7.16",
    "2.8.9",
    "2.9.3"
  ],
  "AffectedVersions": "All versions starting from 2.7.0 before 2.7.16, all versions starting from 2.8.0 before 2.8.9, all versions starting from 2.9.0 before 2.9.3",
  "NotImpacted": "All versions before 2.7.0, all versions starting from 2.7.16 before 2.8.0, all versions starting from 2.8.9 before 2.9.0, all versions starting from 2.9.3",
  "Solution": "Upgrade to versions 2.7.16, 2.8.9, 2.9.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-22036",
    "https://github.com/advisories/GHSA-h99m-6755-rgwc",
    "https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc",
    "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22036",
    "https://github.com/rancher/rancher"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H",
  "UUID": "1124dfbf-8439-4bd0-a50c-9aed7096c629"
}