{
  "Identifier": "CVE-2024-5138",
  "PackageSlug": "go/github.com/snapcore/snapd",
  "Title": "CVE-2024-5138: snapd snapctl auth bypass",
  "Description": "A snap with prior permissions to create a mount entry on the host, such as firefox, normally uses the permission from one of the per-snap hook programs. A unprivileged users cannot normally trigger that behaviour by using `snap run --shell firefox` followed by `snapctl mount`, since snapd validates the requesting user identity (root or non-root). The issue allows unprivileged users to bypass that check by crafting a malicious command line vector which confuses snapd into thinking the help message is requested.\n\nUnprivileged user on a default installation of Ubuntu, where firefox is as provided as a snap, may cause a denial-of-service attack by repeatedly mounting hunspell database over and over and eventually exhausting system memory.\n\nOther attacks, reliant on the same underying mechanism (mount), are possible. In all cases the snap must be installed and grated permission to perform this action (by connecting an appropriate snap interface), which requires administrative privileges. As such we are focusing on the case of default installation where an unprivileged user may exploit this behavior.",
  "Date": "2025-01-16",
  "Pubdate": "2025-01-16",
  "AffectedRange": "\u003e=2.51.6 \u003c2.63.1||\u003c0.0.0-20240524114846-68ee9c6aa916",
  "FixedVersions": [
    "2.63.1",
    "0.0.0-20240524114846-68ee9c6aa916"
  ],
  "AffectedVersions": "All versions before 0.0.0-20240524114846-68ee9c6aa916, all versions starting from 2.51.6 before 2.63.1",
  "NotImpacted": "All versions starting from 0.0.0-20240524114846-68ee9c6aa916 before 2.51.6, all versions starting from 2.63.1",
  "Solution": "Upgrade to versions 0.0.0-20240524114846-68ee9c6aa916, 2.63.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-5138",
    "https://github.com/advisories/GHSA-p9v8-q5m4-pf46",
    "https://github.com/canonical/snapd/security/advisories/GHSA-p9v8-q5m4-pf46",
    "https://github.com/canonical/snapd/commit/68ee9c6aa916ab87dbfd9a26030690f2cabf1e14",
    "https://bugs.launchpad.net/snapd/+bug/2065077",
    "https://github.com/canonical/snapd",
    "https://ubuntu.com/security/CVE-2024-5138",
    "https://www.cve.org/CVERecord?id=CVE-2024-5138"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H",
  "UUID": "d4b3c2da-5281-4e7a-a96e-7cf7248df944"
}