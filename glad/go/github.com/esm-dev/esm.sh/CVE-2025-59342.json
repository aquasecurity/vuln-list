{
  "Identifier": "CVE-2025-59342",
  "PackageSlug": "go/github.com/esm-dev/esm.sh",
  "Title": "esm.sh has arbitrary file write via path traversal in `X-Zone-Id` header",
  "Description": "A path-traversal flaw in the handling of the `X-Zone-Id` HTTP header allows an attacker to cause the application to write files outside the intended storage location. The header value is used to build a filesystem path but is not properly canonicalized or restricted to the application’s storage base directory. As a result, supplying `../` sequences in `X-Zone-Id` causes files to be written to arbitrary directories (example observed: `~/.esmd/modules/transform/\u003cid\u003e/` instead of `~/.esmd/storage/modules/transform`).\n\n**Severity:** Medium\n\n**Component / Endpoint:**\n\n`POST /transform` — handling of `X-Zone-Id` header\n\nThe vulnerable code is in https://github.com/esm-dev/esm.sh/blob/main/server/router.go#L116 and https://github.com/esm-dev/esm.sh/blob/main/server/router.go#L411\n\n**Impact:** Arbitrary file creation / overwrite outside intended storage directory (file write to attacker-controlled path). Possible remote code execution, persistence, tampering with application files, or facilitating further path-traversal attacks.\n\n---",
  "Date": "2025-09-26",
  "Pubdate": "2025-09-17",
  "AffectedRange": "\u003c=136",
  "FixedVersions": [],
  "AffectedVersions": "All versions up to 136",
  "NotImpacted": "",
  "Solution": "Unfortunately, there is no solution available yet.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-59342",
    "https://github.com/advisories/GHSA-g2h5-cvvr-7gmw",
    "https://github.com/esm-dev/esm.sh/security/advisories/GHSA-g2h5-cvvr-7gmw",
    "https://github.com/esm-dev/esm.sh/commit/833a29f42aeb0acbd7089a71be11dd0a292d3151",
    "https://github.com/esm-dev/esm.sh",
    "https://github.com/esm-dev/esm.sh/blob/main/server/router.go#L116",
    "https://github.com/esm-dev/esm.sh/blob/main/server/router.go#L411",
    "https://pkg.go.dev/vuln/GO-2025-3967"
  ],
  "CvssV2": "",
  "CvssV3": "",
  "UUID": "624aa62d-0976-4685-9f7d-905d05fd8a4c"
}