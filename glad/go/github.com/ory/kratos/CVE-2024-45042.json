{
  "Identifier": "CVE-2024-45042",
  "PackageSlug": "go/github.com/ory/kratos",
  "Title": "Ory Kratos's setting required_aal `highest_available` does not properly respect code + mfa credentials",
  "Description": "Given the preconditions, the `highest_available` setting will incorrectly assume that the identity’s highest available AAL is `aal1` even though it really is `aal2`. This means that the `highest_available` configuration will act as if the user has only one factor set up, for that particular user. This means that they can call the settings and whoami endpoint without a `aal2` session, even though that should be disallowed.\n\nAn attacker would need to steal or guess a valid login OTP of a user who has only OTP for login enabled and who has an incorrect `available_aal` value stored, to exploit this vulnerability.\n\nAll other aspects of the session (e.g. the session’s aal) are not impacted by this issue.\n\nOn Ory Network, only 0,00066% of registered users were affected by this issue, and most of those users appeared to be test users. Their respective AAL values have since been updated and they are no longer vulnerable to this attack.",
  "Date": "2024-09-26",
  "Pubdate": "2024-09-26",
  "AffectedRange": "\u003c1.3.0",
  "FixedVersions": [
    "1.3.0"
  ],
  "AffectedVersions": "All versions before 1.3.0",
  "NotImpacted": "All versions starting from 1.3.0",
  "Solution": "Upgrade to version 1.3.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-45042",
    "https://github.com/advisories/GHSA-wc43-73w7-x2f5",
    "https://github.com/ory/kratos/security/advisories/GHSA-wc43-73w7-x2f5",
    "https://github.com/ory/kratos"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
  "UUID": "af06f27f-3344-4b6e-bfb4-98647aacada7"
}