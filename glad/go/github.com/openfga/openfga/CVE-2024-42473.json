{
  "Identifier": "CVE-2024-42473",
  "PackageSlug": "go/github.com/openfga/openfga",
  "Title": "OpenFGA Authorization Bypass",
  "Description": "## Overview\n\nOpenFGA v1.5.7 and v1.5.8 are vulnerable to authorization bypass when calling Check API with a model that uses `but not` and `from` expressions and a userset. \n\nFor example, with a model like the following\n\n```\n model\n    schema 1.1\n\n  type user\n\n  type role\n    relations\n      define assignee: [user]\n\n  type permission\n    relations\n      define assignee: assignee from role\n      define role: [role]\n\n  type job\n    relations\n      define can_read: [permission#assignee]\n      define problem: [user] but not can_read\n```\n\nand these tuples:\n\n```\nuser:1, problem, job:1\nuser:1, assignee, role:admin\nrole:admin, role, permission:readJobs\npermission:readJobs#assignee, can_read, job:1\n```\n\nA query such as `Check(object=job:1, relation=problem, user=user:1)` will return `allowed=true` when the correct response is `allowed=false`.\n\n## Fix\n\nDowngrade to v1.5.6 as soon as possible. This downgrade is backward compatible.\n\nWe are currently working on a fix which will be included in the next release.",
  "Date": "2024-08-09",
  "Pubdate": "2024-08-09",
  "AffectedRange": "\u003e=1.5.7 \u003c=1.5.8",
  "FixedVersions": [],
  "AffectedVersions": "All versions starting from 1.5.7 up to 1.5.8",
  "NotImpacted": "",
  "Solution": "Unfortunately, there is no solution available yet.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-42473",
    "https://github.com/advisories/GHSA-3f6g-m4hr-59h8",
    "https://github.com/openfga/openfga/security/advisories/GHSA-3f6g-m4hr-59h8",
    "https://github.com/openfga/openfga"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "UUID": "d71dd694-a3b6-4cca-b072-88747f8f38d5"
}