{
  "Identifier": "CVE-2025-48865",
  "PackageSlug": "go/github.com/fabiolb/fabio",
  "Title": "Fabio allows HTTP clients to manipulate custom headers it adds",
  "Description": "Fabio allows clients to remove X-Forwarded headers (except X-Forwarded-For) due to a vulnerability in how it processes hop-by-hop headers.\n\nFabio adds HTTP headers like X-Forwarded-Host and X-Forwarded-Port when routing requests to backend applications. Since the receiving application should trust these headers, allowing HTTP clients to remove or modify them creates potential security vulnerabilities.\n\nHowever, it was found that some of these custom headers can indeed be removed and, in certain cases, manipulated. The attack relies on the behavior that headers can be defined as hop-by-hop via the HTTP Connection header. By setting the following connection header, the X-Forwarded-Host header can, for example, be removed:\n\n```\nConnection: close, X-Forwarded-Host\n```\n\nSimilar critical vulnerabilities have been identified in other web servers and proxies, including [CVE-2022-31813](https://nvd.nist.gov/vuln/detail/CVE-2022-31813) in Apache HTTP Server and [CVE-2024-45410](https://github.com/advisories/GHSA-62c8-mh53-4cqv) in Traefik.",
  "Date": "2025-05-30",
  "Pubdate": "2025-05-29",
  "AffectedRange": "\u003c1.6.6",
  "FixedVersions": [
    "1.6.6"
  ],
  "AffectedVersions": "All versions before 1.6.6",
  "NotImpacted": "All versions starting from 1.6.6",
  "Solution": "Upgrade to version 1.6.6 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-48865",
    "https://github.com/advisories/GHSA-q7p4-7xjv-j3wf",
    "https://github.com/fabiolb/fabio/security/advisories/GHSA-q7p4-7xjv-j3wf",
    "https://github.com/fabiolb/fabio/commit/fdaf1e966162e9dd3b347ffdd0647b39dc71a1a3",
    "https://github.com/fabiolb/fabio",
    "https://github.com/fabiolb/fabio/releases/tag/v1.6.6"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
  "UUID": "3795d24c-e503-401e-ad81-4fdce62560cc"
}