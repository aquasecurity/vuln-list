{
  "Identifier": "CVE-2024-22244",
  "PackageSlug": "go/github.com/goharbor/harbor",
  "Title": "Open Redirect URL in Harbor",
  "Description": "Under OIDC authentication mode, there is a redirect_url parameter exposed in the URL which is used to redirect the current user to the defined location after the successful OIDC login, This redirect_url can be an ambiguous URL and can be used to embed a phishing URL.\nFor example: if a user clicks the URL with a malicious redirect_url:\n```\nhttps://\u003charbor_hostnmae\u003e/c/oidc/login?redirect_url=https://\u003credirect_domain\u003e\n```\nIt might redirect the current user without their knowledge to a malicious site, posing a potential risk.\nTo avoid this issue, the redirect_url should be checked if it is a local path when reading it from the original request URL.\n```\n//src/core/controllers/oidc.go\n...\nredirectURL := oc.Ctx.Request.URL.Query().Get(\"redirect_url\")\nif !utils.IsLocalPath(redirectURL) {\nlog.Errorf(\"invalid redirect url: %v\", redirectURL)\noc.SendBadRequestError(fmt.Errorf(\"cannot redirect to other site\"))\nreturn\n}\nif err := oc.SetSession(redirectURLKey, redirectURL); err != nil {\n...\n```",
  "Date": "2025-02-26",
  "Pubdate": "2024-06-02",
  "AffectedRange": "\u003c2.8.5||\u003e=2.9.0 \u003c2.9.3||\u003e=2.10.0 \u003c2.10.1",
  "FixedVersions": [
    "2.8.5",
    "2.9.3",
    "2.10.1"
  ],
  "AffectedVersions": "All versions before 2.8.5, all versions starting from 2.9.0 before 2.9.3, all versions starting from 2.10.0 before 2.10.1",
  "NotImpacted": "All versions starting from 2.8.5 before 2.9.0, all versions starting from 2.9.3 before 2.10.0, all versions starting from 2.10.1",
  "Solution": "Upgrade to versions 2.10.1, 2.8.5, 2.9.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-22244",
    "https://github.com/advisories/GHSA-5757-v49g-f6r7",
    "https://github.com/goharbor/harbor/security/advisories/GHSA-5757-v49g-f6r7",
    "https://github.com/goharbor/harbor",
    "https://pkg.go.dev/vuln/GO-2024-2915"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N",
  "UUID": "67f91d8a-9363-4016-930d-422900888dcc"
}