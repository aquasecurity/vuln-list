{
  "Identifier": "CVE-2025-59354",
  "PackageSlug": "go/github.com/dragonflyoss/dragonfly",
  "Title": "DragonFly has weak integrity checks for downloaded files",
  "Description": "The DragonFly2 uses a variety of hash functions, including the MD5 hash. This algorithm does not provide collision resistance; it is secure only against preimage attacks. While these security guarantees may be enough for the DragonFly2 system, it is not completely clear if there are any scenarios where lack of the collision resistance would compromise the system. There are no clear benefits to keeping the MD5 hash function in the system.\n\n```golang\nvar pieceDigests []string\nfor i := int32(0); i \u003c t.TotalPieces; i++ {\npieceDigests = append(pieceDigests, t.Pieces[i].Md5)\n}\ndigest := digest.SHA256FromStrings(pieceDigests...)\nif digest != t.PieceMd5Sign {\nt.Errorf(\"invalid digest, desired: %s, actual: %s\", t.PieceMd5Sign, digest)\nt.invalid.Store(true)\nreturn ErrInvalidDigest\n}\n```\n\nAlice, a peer in the DragonFly2 system, creates two images: an innocent one, and one with malicious code. Both images consist of two pieces, and Alice generates the pieces so that their respective MD5 hashes collide (are the same). Therefore, the PieceMd5Sign metadata of both images are equal. Alice shares the innocent image with other peers, who attest to their validity (i.e., that it works as expected and is not malicious). Bob wants to download the image and requests it from the peer-to-peer network. After downloading the image, Bob checks its integrity with a SHA256 hash that is known to him. Alice, who is participating in the network, had already provided Bob the other image, the malicious one. Bob unintentionally uses the malicious image.",
  "Date": "2025-09-26",
  "Pubdate": "2025-09-17",
  "AffectedRange": "\u003c2.1.0",
  "FixedVersions": [
    "2.1.0"
  ],
  "AffectedVersions": "All versions before 2.1.0",
  "NotImpacted": "All versions starting from 2.1.0",
  "Solution": "Upgrade to version 2.1.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-59354",
    "https://github.com/advisories/GHSA-hx2h-vjw2-8r54",
    "https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-hx2h-vjw2-8r54",
    "https://github.com/dragonflyoss/dragonfly",
    "https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf",
    "https://pkg.go.dev/vuln/GO-2025-3973"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
  "UUID": "0436cc2d-d180-4df5-9535-a60a12bb76c3"
}