{
  "Identifier": "CVE-2025-59348",
  "PackageSlug": "go/github.com/dragonflyoss/dragonfly",
  "Title": "Dragonfly incorrectly handles a task structure’s usedTrac field",
  "Description": "The processPieceFromSource method (figure 4.1) is part of a task processing mechanism. The method writes pieces of data to storage, updating a Task structure along the way. The method does not update the structure’s usedTraffic field, because an uninitialized variable n is used as a guard to the AddTraffic method call, instead of the result.Size variable.\n\n```golang\nvar n int64\nresult.Size, err = pt.GetStorage().WritePiece([skipped])\nresult.FinishTime = time.Now().UnixNano()\nif n \u003e 0 {\npt.AddTraffic(uint64(n))\n}\n```\n\nA task is processed by a peer. The usedTraffic metadata is not updated during the processing. Rate limiting is incorrectly applied, leading to a denial-of-service condition for the peer.",
  "Date": "2025-09-26",
  "Pubdate": "2025-09-17",
  "AffectedRange": "\u003c2.1.0",
  "FixedVersions": [
    "2.1.0"
  ],
  "AffectedVersions": "All versions before 2.1.0",
  "NotImpacted": "All versions starting from 2.1.0",
  "Solution": "Upgrade to version 2.1.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-59348",
    "https://github.com/advisories/GHSA-2qgr-gfvj-qpcr",
    "https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-2qgr-gfvj-qpcr",
    "https://github.com/dragonflyoss/dragonfly",
    "https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf",
    "https://pkg.go.dev/vuln/GO-2025-3963"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "UUID": "c23899e0-5c50-4c9e-bbc8-4a5b606f7104"
}