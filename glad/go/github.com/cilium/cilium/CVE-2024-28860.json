{
  "Identifier": "CVE-2024-28860",
  "PackageSlug": "go/github.com/cilium/cilium",
  "Title": "Cilium has insecure IPsec transport encryption",
  "Description": "Users of [IPsec transparent encryption](https://docs.cilium.io/en/stable/security/network/encryption-ipsec/) in Cilium may be vulnerable to cryptographic attacks that render the transparent encryption ineffective.\n\nIn particular, Cilium is vulnerable to the following attacks by a man-in-the-middle attacker:\n\n- Chosen plaintext attacks\n- Key recovery attacks\n- Replay attacks\n\nThese attacks are possible due to an ESP sequence number collision when multiple nodes are configured with the same key. Fixed versions of Cilium use unique keys for each IPsec tunnel established between nodes, resolving all of the above attacks.\n\n**Important:** After upgrading, users must perform a key rotation using the instructions [here](https://docs.cilium.io/en/latest/security/network/encryption-ipsec/#key-rotation) to ensure that they are no longer vulnerable to this issue. Please note that the key rotation instructions have recently been updated, and users must use the new instructions to properly establish secure IPsec tunnels. To validate that the new instructions have been followed properly, ensure that the IPsec Kubernetes secret contains a \"+\" sign.",
  "Date": "2024-03-28",
  "Pubdate": "2024-03-28",
  "AffectedRange": "\u003e=1.4.0 \u003c1.13.14||\u003e=1.14.0 \u003c1.14.9||\u003e=1.15.0 \u003c1.15.3",
  "FixedVersions": [
    "1.13.14",
    "1.14.9",
    "1.15.3"
  ],
  "AffectedVersions": "All versions starting from 1.4.0 before 1.13.14, all versions starting from 1.14.0 before 1.14.9, all versions starting from 1.15.0 before 1.15.3",
  "NotImpacted": "All versions before 1.4.0, all versions starting from 1.13.14 before 1.14.0, all versions starting from 1.14.9 before 1.15.0, all versions starting from 1.15.3",
  "Solution": "Upgrade to versions 1.13.14, 1.14.9, 1.15.3 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-28860",
    "https://github.com/advisories/GHSA-pwqm-x5x6-5586",
    "https://github.com/cilium/cilium/security/advisories/GHSA-pwqm-x5x6-5586",
    "https://github.com/cilium/cilium/commit/311fbce5280491cddceab178d83b06fa23688c72",
    "https://github.com/cilium/cilium/commit/a1742b478306fa256cd27df1039dfae0537b4149",
    "https://github.com/cilium/cilium/commit/a652c123331852cca90c74202f993d4170fd37fa",
    "https://docs.cilium.io/en/stable/security/network/encryption-ipsec",
    "https://github.com/cilium/cilium"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N",
  "UUID": "39e6ebe8-d0c1-4243-982f-4de31a3cef2e"
}