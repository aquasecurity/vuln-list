{
  "Identifier": "CVE-2024-24557",
  "PackageSlug": "go/github.com/docker/docker",
  "Title": "Classic builder cache poisoning",
  "Description": "The classic builder cache system is prone to cache poisoning if the image is built `FROM scratch`.\nAlso, changes to some instructions (most important being `HEALTHCHECK` and `ONBUILD`) would not cause a cache miss.\n\n\nAn attacker with the knowledge of the Dockerfile someone is using could poison their cache by making them pull a specially crafted image that would be considered as a valid cache candidate for some build steps.\n\nFor example, an attacker could create an image that is considered as a valid cache candidate for:\n```\nFROM scratch\nMAINTAINER Pawel\n```\n\nwhen in fact the malicious image used as a cache would be an image built from a different Dockerfile.\n\nIn the second case, the attacker could for example substitute a different `HEALTCHECK` command.",
  "Date": "2024-07-05",
  "Pubdate": "2024-02-01",
  "AffectedRange": "\u003c24.0.9||\u003e=25.0.0 \u003c25.0.2",
  "FixedVersions": [
    "24.0.9",
    "25.0.2"
  ],
  "AffectedVersions": "All versions before 24.0.9, all versions starting from 25.0.0 before 25.0.2",
  "NotImpacted": "All versions starting from 24.0.9 before 25.0.0, all versions starting from 25.0.2",
  "Solution": "Upgrade to versions 24.0.9, 25.0.2 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-24557",
    "https://github.com/advisories/GHSA-xw73-rw38-6vjc",
    "https://github.com/moby/moby/security/advisories/GHSA-xw73-rw38-6vjc",
    "https://github.com/moby/moby/commit/3e230cfdcc989dc524882f6579f9e0dac77400ae",
    "https://github.com/moby/moby/commit/fca702de7f71362c8d103073c7e4a1d0a467fadd",
    "https://github.com/moby/moby/commit/fce6e0ca9bc000888de3daa157af14fa41fcd0ff",
    "https://github.com/moby/moby"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "UUID": "3df449b4-5c0d-491d-82a3-3a2b84b38ba5"
}