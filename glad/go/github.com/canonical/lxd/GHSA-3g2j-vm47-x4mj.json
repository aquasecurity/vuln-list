{
  "Identifier": "GHSA-3g2j-vm47-x4mj",
  "PackageSlug": "go/github.com/canonical/lxd",
  "Title": "LXD vulnerable to a local privilege escalation through custom storage volumes",
  "Description": "**Impact**\n\nThis affects any LXD user in an environment where an unprivileged user may have root access to a container with an attached custom storage volume that has the `security.shifted` property set to `true` as well as access to the host as an unprivileged user.\n\nThe most common case for this would be systems using `lxd-user` with the less privileged lxd group to provide unprivileged users with an isolated restricted access to LXD. Such users may be able to create a custom storage volume with the necessary property (depending on kernel and filesystem support) and can then write a setuid binary from within the container which can be executed as an unprivileged user on the host to gain root privileges.\n\n**Patches**\n\nPatches for this issue are available:\n\n- LXD 6 series: https://github.com/canonical/lxd/pull/16904\n- LXD 5.21 LTS series: https://github.com/canonical/lxd/pull/16922\n- LXD 5.0 LTS series: https://github.com/canonical/lxd/pull/16923\n- LXD 4.0 LTS series: https://github.com/canonical/lxd/pull/16924\n\nThe first commit changes the permissions for any new storage pool, the later commit adds a patch that applies it on startup to all existing storage pools.\n\nThese fixes are also available in the associated candidate snap channels for each LTS series:\n\n- 5.21/candidate (5.21.4-8a3cf61)\n- 5.0/candidate (5.0.5-5c60378)\n- 4.0/candidate (4.0.10-35a8127)\n\nWe will be preparing intermediate releases to the associated stable snap channels shortly.\n\n**Workarounds**\n\nPermissions can be manually restricted until a patched version of LXD is deployed.\n\nThis is done with:\n\n```\nsudo nsenter --mount=/run/snapd/ns/lxd.mnt -- chmod 0700 /var/snap/lxd/common/lxd/storage-pools/*/{custom*,virtual-machines*,images}\nsudo nsenter --mount=/run/snapd/ns/lxd.mnt -- chmod 0711 /var/snap/lxd/common/lxd/storage-pools/*/{containers*,buckets*}\n```\n\nThose are the same permissions which will be applied by the patched LXD for both new and existing storage pools.\n\n**References**\n\nThis was reported to Incus publicly on Github here:\n\n- https://github.com/lxc/incus/security/advisories/GHSA-56mx-8g9f-5crf\n- https://github.com/lxc/incus/issues/2641",
  "Date": "2025-11-18",
  "Pubdate": "2025-11-13",
  "AffectedRange": "\u003c0.0.0-20251110144034-698854d0164f",
  "FixedVersions": [
    "0.0.0-20251110144034-698854d0164f"
  ],
  "AffectedVersions": "All versions before 0.0.0-20251110144034-698854d0164f",
  "NotImpacted": "All versions starting from 0.0.0-20251110144034-698854d0164f",
  "Solution": "Upgrade to version 0.0.0-20251110144034-698854d0164f or above.",
  "Urls": [
    "https://github.com/advisories/GHSA-3g2j-vm47-x4mj",
    "https://github.com/canonical/lxd/security/advisories/GHSA-3g2j-vm47-x4mj",
    "https://github.com/lxc/incus/security/advisories/GHSA-56mx-8g9f-5crf",
    "https://github.com/lxc/incus/issues/2641",
    "https://github.com/canonical/lxd/pull/16904",
    "https://github.com/canonical/lxd/pull/16922",
    "https://github.com/canonical/lxd/pull/16923",
    "https://github.com/canonical/lxd/pull/16924",
    "https://github.com/canonical/lxd"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "13696ad8-e2c3-4736-ac0f-2d06244b26f8"
}