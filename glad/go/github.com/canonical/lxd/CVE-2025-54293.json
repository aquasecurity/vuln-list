{
  "Identifier": "CVE-2025-54293",
  "PackageSlug": "go/github.com/canonical/lxd",
  "Title": "Canonical LXD Path Traversal Vulnerability in Instance Log File Retrieval Function",
  "Description": "Although outside the scope of this penetration test, a path traversal vulnerability exists in the validLogFileName function that validates log file names in lxd/instance_logs.go in the LXD 5.0 LTS series.\n\nThis vulnerability was fixed in PR #15022 in February 2025, and is fixed in at least LXD 5.21 and later. However, this PR appears to be primarily aimed at code improvement rather than vulnerability fixing, with the vulnerability being fixed as a side effect. Therefore, no CVE number has been issued, and no security patch has been made for LXD 5.0 and earlier.\n\nHowever, since LXD 5.0 LTS is still in its support period and installation procedures are explained in official documentation, we judge that environments affected by this vulnerability likely exist and report it.\n\nImplementation in vulnerable versions (LXD 5.0 LTS series):\n\n https://github.com/canonical/lxd/blob/1f8c9f77782784900960bb3b8577c1491db59277/lxd/instance_logs.go#L152-L163\n\nThis function allows filenames starting with snapshot_ or migration_, but lacks sufficient validation for the portion after the prefix, enabling path traversal attacks. The fixed version is as follows:\n\nImplementation in fixed versions (LXD 5.21 and later):\n\n https://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/lxd/instance_logs.go#L665-L679\n\n https://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/shared/util.go#L833-L835\n\nThis function ensures that filenames do not contain /, \\, or .. .\n\nNote that in Linux generally, path traversal like /not_exist_folder/../exist_folder/ is rejected within system calls and doesn't\nsucceed.\n\nHowever, in this case, the attack succeeds because URL normalization by golang's filepath.Join is performed beforehand.\n\nRelated part of instanceLogGet function:\n\n https://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/lxd/instance_logs.go#L218-L269\n\nRelated part of instanceLogDelete function:\n\n https://github.com/canonical/lxd/blob/43d5189564d27f6161b430ed258c8b56603c2759/lxd/instance_logs.go#L331-L347\n\nIn the fixed version, filenames containing path traversal strings are rejected at the validLogFileName stage through pre-checking by shared.IsFileName.",
  "Date": "2025-10-02",
  "Pubdate": "2025-10-02",
  "AffectedRange": "\u003e=4.0 \u003c5.21.4||\u003e=6.0 \u003c6.5",
  "FixedVersions": [
    "5.21.4",
    "6.5"
  ],
  "AffectedVersions": "All versions starting from 4.0 before 5.21.4, all versions starting from 6.0 before 6.5",
  "NotImpacted": "All versions before 4.0, all versions starting from 5.21.4 before 6.0, all versions starting from 6.5",
  "Solution": "Upgrade to versions 5.21.4, 6.5 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-54293",
    "https://github.com/advisories/GHSA-472f-vmf2-pr3h",
    "https://github.com/canonical/lxd/security/advisories/GHSA-472f-vmf2-pr3h",
    "https://github.com/canonical/lxd/pull/15022",
    "https://github.com/canonical/lxd"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
  "UUID": "0102bb55-209b-4a46-ac55-f1096b8c951a"
}