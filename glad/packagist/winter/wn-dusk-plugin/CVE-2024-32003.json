{
  "Identifier": "CVE-2024-32003",
  "PackageSlug": "packagist/winter/wn-dusk-plugin",
  "Title": "Dusk plugin may allow unfettered user authentication in misconfigured installs",
  "Description": "The Dusk plugin provides some special routes as part of its testing framework to allow a browser environment (such as headless Chrome) to act as a user in the Backend or User plugin without having to go through authentication. This route is `[[URL]]/_dusk/login/[[USER ID]]/[[MANAGER]]` - where `[[URL]]` is the base URL of the site, `[[USER ID]]` is the ID of the user account and `[[MANAGER]]` is the authentication manager (either `backend` for Backend, or `user` for the User plugin).\n\nIf a configuration of a site using the Dusk plugin is set up in such a way that the Dusk plugin is available publicly and the test cases in Dusk are run with live data, this route may potentially be used to gain access to any user account in either the Backend or User plugin without authentication.\n\nAs indicated in the [README](https://github.com/wintercms/wn-dusk-plugin/blob/main/README.md), this plugin should only be used in development and should *NOT* be used in a production instance. It is specifically recommended that the plugin be installed as a development dependency only in Composer.\n\nIn order to remediate this issue, the special routes used above will now no longer be registered unless the `APP_ENV` environment variable is specifically set to `dusk`. Since Winter by default does not use this environment variable and it is not populated by default, it will only exist if Dusk's automatic configuration is used (which won't exhibit this vulnerability) or if a developer manually specifies it in their configuration.\n\nThe automatic configuration performed by the Dusk plugin has also been hardened by default to use sane defaults and not allow external environment variables to leak into this configuration.",
  "Date": "2024-04-12",
  "Pubdate": "2024-04-12",
  "AffectedRange": "\u003c2.1.0",
  "FixedVersions": [
    "2.1.0"
  ],
  "AffectedVersions": "All versions before 2.1.0",
  "NotImpacted": "All versions starting from 2.1.0",
  "Solution": "Upgrade to version 2.1.0 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-32003",
    "https://github.com/advisories/GHSA-chcp-g9j5-3xxx",
    "https://github.com/wintercms/wn-dusk-plugin/security/advisories/GHSA-chcp-g9j5-3xxx",
    "https://github.com/wintercms/wn-dusk-plugin"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "UUID": "bf04b3dd-3472-4466-9061-61798dc62e81"
}