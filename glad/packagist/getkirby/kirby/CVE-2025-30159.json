{
  "Identifier": "CVE-2025-30159",
  "PackageSlug": "packagist/getkirby/kirby",
  "Title": "Kirby vulnerable to path traversal of snippet names in the `snippet()` helper",
  "Description": "The missing path traversal check allowed attackers to navigate and access all files on the server that were accessible to the PHP process, including files outside of the snippets root or even outside of the Kirby installation. PHP code within such files was executed.\n\nSuch attacks first require an attack vector in the site code that is caused by dynamic snippet names, such as `snippet('tags-' . get('tags'))`. It generally also requires knowledge of the site structure and the server's file system by the attacker, although it can be possible to find vulnerable setups through automated methods such as fuzzing.\n\nIn a vulnerable setup, this could cause damage to the confidentiality and integrity of the server, for example:\n\n- it could allow the attacker to build a map of the server's file system for subsequent attacks,\n- it could allow access to configuration files that may contain sensitive information like security tokens or\n- it could cause the unintended execution of PHP scripts.",
  "Date": "2025-05-13",
  "Pubdate": "2025-05-13",
  "AffectedRange": "\u003c3.9.8.3||\u003e=3.10.0 \u003c3.10.1.2||\u003e=4.0.0 \u003c4.7.1",
  "FixedVersions": [
    "3.9.8.3",
    "3.10.1.2",
    "4.7.1"
  ],
  "AffectedVersions": "All versions before 3.9.8.3, all versions starting from 3.10.0 before 3.10.1.2, all versions starting from 4.0.0 before 4.7.1",
  "NotImpacted": "All versions starting from 3.9.8.3 before 3.10.0, all versions starting from 3.10.1.2 before 4.0.0, all versions starting from 4.7.1",
  "Solution": "Upgrade to versions 3.10.1.2, 3.9.8.3, 4.7.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-30159",
    "https://github.com/advisories/GHSA-fw82-87p8-v6hp",
    "https://github.com/getkirby/kirby/security/advisories/GHSA-fw82-87p8-v6hp",
    "https://github.com/getkirby/kirby/commit/90acf7ed6d8d9d0697f938edc0940b4a563ddbe7",
    "https://github.com/getkirby/kirby",
    "https://github.com/getkirby/kirby/releases/tag/3.10.1.2",
    "https://github.com/getkirby/kirby/releases/tag/3.9.8.3",
    "https://github.com/getkirby/kirby/releases/tag/4.7.1"
  ],
  "CvssV2": "",
  "CvssV3": "",
  "UUID": "0019b035-e0c4-4a48-abcc-88c69dcbceb4"
}