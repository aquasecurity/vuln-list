{
  "Identifier": "CVE-2023-34252",
  "PackageSlug": "packagist/getgrav/grav",
  "Title": "Improper Control of Generation of Code ('Code Injection')",
  "Description": "Grav is a file-based Web platform. Prior to version 1.7.42, there is a logic flaw in the `GravExtension.filterFilter()` function whereby validation against a denylist of unsafe functions is only performed when the argument passed to filter is a string. However, passing an array as a callable argument allows the validation check to be skipped. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. The vulnerability can be found in the `GravExtension.filterFilter()` function declared in `/system/src/Grav/Common/Twig/Extension/GravExtension.php`. Version 1.7.42 contains a patch for this issue. End users should also ensure that `twig.undefined_functions` and `twig.undefined_filters` properties in `/path/to/webroot/system/config/system.yaml` configuration file are set to `false` to disallow Twig from treating undefined filters/functions as PHP functions and executing them.",
  "Date": "2023-07-01",
  "Pubdate": "2023-06-16",
  "AffectedRange": "\u003c1.7.42",
  "FixedVersions": [
    "1.7.42"
  ],
  "AffectedVersions": "All versions before 1.7.42",
  "NotImpacted": "All versions starting from 1.7.42",
  "Solution": "Upgrade to version 1.7.42 or above.",
  "Urls": [
    "https://github.com/getgrav/grav/security/advisories/GHSA-96xv-rmwj-6p9w",
    "https://nvd.nist.gov/vuln/detail/CVE-2023-34252",
    "https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec",
    "https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b",
    "https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8",
    "https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5",
    "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Twig/Extension/GravExtension.php#L1692-L1698",
    "https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1956-L2074",
    "https://github.com/advisories/GHSA-96xv-rmwj-6p9w"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "8b2b2a5f-225b-4873-84bb-d1f9d3f22090"
}