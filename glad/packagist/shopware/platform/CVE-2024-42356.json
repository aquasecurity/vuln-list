{
  "Identifier": "CVE-2024-42356",
  "PackageSlug": "packagist/shopware/platform",
  "Title": "Shopware vulnerable to Server Side Template Injection in Twig using Context functions",
  "Description": "The `context` variable is injected into almost any Twig Template and allows to access to current language, currency information. The context object allows also to switch for a short time the scope of the Context as a helper with a callable function.\n\nExample call from PHP:\n\n```php\n$context-\u003escope(Context::SYSTEM_SCOPE, static function (Context $context) use ($mediaService, $media, \u0026$fileBlob): void {\n$fileBlob = $mediaService-\u003eloadFile($media-\u003egetId(), $context);\n});\n```\n\nThis function can be called also from Twig and as the second parameter allows any callable, it's possible to call from Twig any statically callable PHP function/method.\n\nIt's not possible as customer to provide any Twig code, the attacker would require access to Administration to exploit it using Mail templates or using App Scripts.",
  "Date": "2024-08-08",
  "Pubdate": "2024-08-08",
  "AffectedRange": "\u003c6.5.8.13||\u003e=6.6.0.0 \u003c6.6.5.1",
  "FixedVersions": [
    "6.5.8.13",
    "6.6.5.1"
  ],
  "AffectedVersions": "All versions starting from 6.6.0.0 before 6.6.5.1, all versions before 6.5.8.13",
  "NotImpacted": "All versions before 6.6.0.0, all versions starting from 6.6.5.1 before 0, all versions starting from 6.5.8.13",
  "Solution": "Upgrade to versions 6.5.8.13, 6.6.5.1 or above.",
  "Urls": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-42356",
    "https://github.com/advisories/GHSA-35jp-8cgg-p4wj",
    "https://github.com/shopware/shopware/security/advisories/GHSA-35jp-8cgg-p4wj",
    "https://github.com/shopware/core/commit/04183e0c02af3b404eb7d52c683734bfe0595038",
    "https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f",
    "https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac",
    "https://github.com/shopware/shopware/commit/e43423bcc93c618c3036f94c12aa29514da8cf2e",
    "https://github.com/shopware/shopware"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
  "UUID": "de44ae78-f8cd-4983-95ad-136fa0c7ac42"
}