{
  "Identifier": "CVE-2022-24894",
  "PackageSlug": "packagist/symfony/http-kernel",
  "Title": "Symfony storing cookie headers in HttpCache",
  "Description": "Description\n-----------\n\nThe Symfony HTTP cache system acts as a reverse proxy: it caches HTTP responses (including headers) and returns them to clients.\n\nIn a recent `AbstractSessionListener` change, the response might now contain a `Set-Cookie` header. If the Symfony HTTP cache system is enabled, this header might be stored and returned to some other clients. An attacker can use this vulnerability to retrieve the victim's session.\n\nResolution\n----------\n\nThe `HttpStore` constructor now takes a parameter containing a list of private headers that are removed from the HTTP response headers.\nThe default value for this parameter is `Set-Cookie`, but it can be overridden or extended by the application.\n\nThe patch for this issue is available [here](https://github.com/symfony/symfony/commit/d2f6322af9444ac5cd1ef3ac6f280dbef7f9d1fb) for branch 4.4.\n\nCredits\n-------\n\nWe would like to thank Soner Sayakci for reporting the issue and Nicolas Grekas for fixing it.\n",
  "Date": "2023-02-22",
  "Pubdate": "2023-02-01",
  "AffectedRange": "\u003e=2.0.0,\u003c4.4.50||\u003e=5.0.0,\u003c5.4.20||\u003e=6.0.0,\u003c6.0.20||\u003e=6.1.0,\u003c6.1.12||\u003e=6.2.0,\u003c6.2.6",
  "FixedVersions": [
    "4.4.50",
    "5.4.20",
    "6.0.20",
    "6.1.12",
    "6.2.6"
  ],
  "AffectedVersions": "All versions starting from 2.0.0 before 4.4.50, all versions starting from 5.0.0 before 5.4.20, all versions starting from 6.0.0 before 6.0.20, all versions starting from 6.1.0 before 6.1.12, all versions starting from 6.2.0 before 6.2.6",
  "NotImpacted": "All versions before 2.0.0, all versions starting from 4.4.50 before 5.0.0, all versions starting from 5.4.20 before 6.0.0, all versions starting from 6.0.20 before 6.1.0, all versions starting from 6.1.12 before 6.2.0, all versions starting from 6.2.6",
  "Solution": "Upgrade to versions 4.4.50, 5.4.20, 6.0.20, 6.1.12, 6.2.6 or above.",
  "Urls": [
    "https://github.com/symfony/symfony/security/advisories/GHSA-h7vf-5wrv-9fhv",
    "https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/http-kernel/CVE-2022-24894.yaml",
    "https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2022-24894.yaml",
    "https://symfony.com/cve-2022-24894",
    "https://github.com/advisories/GHSA-h7vf-5wrv-9fhv"
  ],
  "CvssV2": "",
  "CvssV3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:L/A:L",
  "UUID": "8b2ca663-8767-47ff-8d0b-531e8ddd14a0"
}