{
  "PublicDateAtUSN": "2019-12-03T15:15:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2013-4235",
  "PublicDate": "2019-12-03T15:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4235",
    "https://github.com/shadow-maint/shadow/issues/317",
    "https://github.com/shadow-maint/shadow/pull/545",
    "https://ubuntu.com/security/notices/USN-5745-1",
    "https://ubuntu.com/security/notices/USN-5745-2",
    "https://bugs.launchpad.net/ubuntu/+source/shadow/+bug/1998169"
  ],
  "Description": "shadow: TOCTOU (time-of-check time-of-use) race condition when copying and removing directory trees",
  "UbuntuDescription": "",
  "Notes": [
    "ccdm94\u003e The original issue associated with this CVE is issue 317,",
    "ccdm94\u003e which provides a fix through commit dcca865. However, another",
    "ccdm94\u003e pull request which references this issue was opened at a",
    "ccdm94\u003e later date, this being PR 545. This pull request is said",
    "ccdm94\u003e to actually address the issue while commit dcca865 was only",
    "ccdm94\u003e a work around to the problem. Additionally, from the first",
    "ccdm94\u003e comment that can be seen in PR 483, it seems like commit",
    "ccdm94\u003e b447216 is also needed in order to completely fix this",
    "ccdm94\u003e issue. Three commits fixing regressions introduced",
    "ccdm94\u003e by one of the fix commits have been added after release",
    "ccdm94\u003e 4.12.2, which is considered by upstream as the fixed release.",
    "ccdm94\u003e These commit are: f3bdb28, 10cd68e and cde221b. They are",
    "ccdm94\u003e a part of version 4.13 of shadow.",
    "ccdm94\u003e One of the commits that needs to be applied in order to fix",
    "ccdm94\u003e this CVE introduces a regression in focal and earlier, as",
    "ccdm94\u003e seen by launchpad bug 1998169. The commit which seems to",
    "ccdm94\u003e cause the issue is commit f3bdb28. Flag AT_SYMLINK_NOFOLLOW",
    "ccdm94\u003e is not implemented in the kernel for function fchmodat, and,",
    "ccdm94\u003e for focal and earlier, glibc does not contain commit",
    "ccdm94\u003e 752dd17443, which fixes this problem. Therefore, useradd was",
    "ccdm94\u003e not behaving correctly in focal and earlier once the fix for",
    "ccdm94\u003e this issue was applied."
  ],
  "Bugs": [
    "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=778950",
    "https://bugzilla.redhat.com/show_bug.cgi?id=884658"
  ],
  "Priority": "low",
  "DiscoveredBy": "Florian Weimer",
  "AssignedTo": "",
  "Patches": {
    "shadow": {
      "artful": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      },
      "cosmic": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "1:4.13+dfsg1-1ubuntu1"
      },
      "disco": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "eoan": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "esm-infra/bionic": {
        "Status": "needed",
        "Note": ""
      },
      "esm-infra/xenial": {
        "Status": "needed",
        "Note": ""
      },
      "focal": {
        "Status": "needed",
        "Note": ""
      },
      "groovy": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "hirsute": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "impish": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "jammy": {
        "Status": "released",
        "Note": "1:4.8.1-2ubuntu2.1"
      },
      "kinetic": {
        "Status": "released",
        "Note": "1:4.11.1+dfsg1-2ubuntu1.1"
      },
      "lucid": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "lunar": {
        "Status": "not-affected",
        "Note": "1:4.13+dfsg1-1ubuntu1"
      },
      "mantic": {
        "Status": "not-affected",
        "Note": "1:4.13+dfsg1-1ubuntu1"
      },
      "precise": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "precise/esm": {
        "Status": "ignored",
        "Note": "end of life, was needed"
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "needed",
        "Note": ""
      },
      "upstream": {
        "Status": "released",
        "Note": "4.13"
      },
      "utopic": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "vivid": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "vivid/stable-phone-overlay": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "vivid/ubuntu-core": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "wily": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      },
      "yakkety": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "zesty": {
        "Status": "ignored",
        "Note": "end of life"
      }
    }
  },
  "UpstreamLinks": {
    "shadow": [
      "https://github.com/shadow-maint/shadow/pull/483/commits/b4472167c2f5057d56686d3349a9b55fc508efe6",
      "https://github.com/shadow-maint/shadow/pull/545/commits/83d42e9e884829be028b3d2b276dc35bfc8c30cf",
      "https://github.com/shadow-maint/shadow/pull/545/commits/479fc86fbe4add5ae0c66571965627c8fbac881d",
      "https://github.com/shadow-maint/shadow/pull/545/commits/e0d33fe77cee9364fffbfa58c499b459040d4c7f",
      "https://github.com/shadow-maint/shadow/pull/545/commits/14fcd7b412a7a13973a9453fd97f60fc277ebd0f",
      "https://github.com/shadow-maint/shadow/pull/545/commits/e666de721aedf6deae8b11bef2e0701cf110f307",
      "https://github.com/shadow-maint/shadow/pull/545/commits/3db58ddf6394dfd1a0fe81dcb94dc81fe9fe6d6a",
      "https://github.com/shadow-maint/shadow/pull/545/commits/6b228b2ba5a24f48bf6e74710cbd9582b157bde5"
    ]
  }
}