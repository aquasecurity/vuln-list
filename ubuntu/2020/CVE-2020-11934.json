{
  "PublicDateAtUSN": "2020-07-15T12:00:00Z",
  "CRD": "2020-07-15T12:00:00Z",
  "Candidate": "CVE-2020-11934",
  "PublicDate": "2020-07-29T17:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11934",
    "https://ubuntu.com/security/notices/USN-4424-1"
  ],
  "Description": "It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS environment variable when calling the system xdg-open. OpenURL() in usersession/userd/launcher.go would alter $XDG_DATA_DIRS to append a path to a directory controlled by the calling snap. A malicious snap could exploit this to bypass intended access restrictions to control how the host system xdg-open script opens the URL and, for example, execute a script shipped with the snap without confinement. This issue did not affect Ubuntu Core systems. Fixed in snapd versions 2.45.1ubuntu0.2, 2.45.1+18.04.2 and 2.45.1+20.04.2.",
  "UbuntuDescription": "It was discovered that snapctl user-open allowed altering the $XDG_DATA_DIRS environment variable when calling the system xdg-open. A malicious snap could exploit this to bypass intended access restrictions to control how the host system xdg-open script opens the URL. This issue did not affect Ubuntu Core systems. (CVE-2020-11934)",
  "Notes": [
    "emitorino\u003e Since the vulnerability is present on the userd's OpenURL implementation, it only affects classic distros where userd is auto-started.",
    "emitorino\u003e Since userd cannot be auto-started on Ubuntu Core 16, Ubuntu Core 18 or Ubuntu Core 20 (for various reasons depending on the release), then Ubuntu Core is not affected.",
    "emitorino\u003e Even if userd happened to start (eg, the user started it manually on UC20) there is no implicitOnCore policy that allows communicating with io.snapcraft.Launcher (or the older com.canonical.SafeLauncher).",
    "emitorino\u003e The dbus interface can't be used (with either plugs or slots) to communicate with userd.",
    "emitorino\u003e /usr/bin/xdg-open on the boot file system of an Ubuntu Core system is different to Classic: it is the sandbox proxy that calls back into userd. Even if a session bus is running and a confined app could call userd, userd will report an error because the caller is not confined"
  ],
  "Bugs": [
    "https://bugs.launchpad.net/snapd/+bug/1880085"
  ],
  "Priority": "medium",
  "DiscoveredBy": "James Henstridge",
  "AssignedTo": "emitorino",
  "Patches": {
    "snapd": {
      "bionic": {
        "Status": "released",
        "Note": "2.45.1+18.04.2"
      },
      "devel": {
        "Status": "released",
        "Note": "2.46~pre1.gitaf15176"
      },
      "eoan": {
        "Status": "released",
        "Note": "2.45.1+19.10.2"
      },
      "esm-infra/bionic": {
        "Status": "released",
        "Note": "2.45.1+18.04.2"
      },
      "esm-infra/xenial": {
        "Status": "released",
        "Note": "2.45.1ubuntu0.2"
      },
      "focal": {
        "Status": "released",
        "Note": "2.45.1+20.04.2"
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "upstream": {
        "Status": "released",
        "Note": "2.45.2"
      },
      "xenial": {
        "Status": "released",
        "Note": "2.45.1ubuntu0.2"
      }
    }
  },
  "UpstreamLinks": {
    "snapd": [
      "https://github.com/snapcore/snapd/commit/06342a31878f1cf99d56da5483e71b9af61f46ad"
    ]
  }
}