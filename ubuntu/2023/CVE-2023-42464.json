{
  "PublicDateAtUSN": "2023-09-16T16:00:00Z",
  "CRD": "2023-09-16T16:00:00Z",
  "Candidate": "CVE-2023-42464",
  "PublicDate": "2023-09-20T15:15:00Z",
  "References": [
    "https://kb.cert.org/vuls/id/408603",
    "https://github.com/Netatalk/netatalk/releases/tag/netatalk-3-1-17",
    "https://sourceforge.net/p/netatalk/mailman/message/37896632/",
    "https://netatalk.sourceforge.io/CVE-2023-42464.php",
    "https://ubuntu.com/security/notices/USN-6552-1",
    "https://www.cve.org/CVERecord?id=CVE-2023-42464"
  ],
  "Description": "A Type Confusion vulnerability was found in the Spotlight RPC functions in afpd in Netatalk 3.1.x before 3.1.17. When parsing Spotlight RPC packets, one encoded data structure is a key-value style dictionary where the keys are character strings, and the values can be any of the supported types in the underlying protocol. Due to a lack of type checking in callers of the dalloc_value_for_key() function, which returns the object associated with a key, a malicious actor may be able to fully control the value of the pointer and theoretically achieve Remote Code Execution on the host. This issue is similar to CVE-2023-34967.",
  "UbuntuDescription": "",
  "Notes": [
    "sbeattie\u003e 2.x versions and older do not support the spotlight protocol, support introduced in 3.1.0",
    "sbeattie\u003e code affected shares origin with samba's mdssvc.c; this issue is the netatalk version of the samba CVE-2023-34967"
  ],
  "Bugs": [
    "https://github.com/Netatalk/netatalk/pull/485",
    "https://github.com/Netatalk/netatalk/issues/486"
  ],
  "Priority": "medium",
  "DiscoveredBy": "Florent Saudel and Arnaud Gatignol",
  "AssignedTo": "",
  "Patches": {
    "netatalk": {
      "bionic": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "devel": {
        "Status": "needed",
        "Note": ""
      },
      "esm-apps/bionic": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "esm-apps/focal": {
        "Status": "not-affected",
        "Note": "3.1.12~ds-4ubuntu0.20.04.3"
      },
      "esm-apps/jammy": {
        "Status": "not-affected",
        "Note": "3.1.12~ds-9ubuntu0.22.04.3"
      },
      "esm-apps/xenial": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "focal": {
        "Status": "released",
        "Note": "3.1.12~ds-4ubuntu0.20.04.3"
      },
      "jammy": {
        "Status": "released",
        "Note": "3.1.12~ds-9ubuntu0.22.04.3"
      },
      "lunar": {
        "Status": "released",
        "Note": "3.1.14~ds-1ubuntu0.1"
      },
      "mantic": {
        "Status": "needed",
        "Note": ""
      },
      "trusty": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "trusty/esm": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "upstream": {
        "Status": "released",
        "Note": "3.1.17"
      },
      "xenial": {
        "Status": "not-affected",
        "Note": "code not present"
      }
    }
  },
  "UpstreamLinks": {
    "netatalk": [
      "https://github.com/Netatalk/netatalk/commit/a0ee3c246ee9e082436192290610a4d812fc0b7f"
    ]
  }
}