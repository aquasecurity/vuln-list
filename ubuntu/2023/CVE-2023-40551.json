{
  "PublicDateAtUSN": "0001-01-01T00:00:00Z",
  "CRD": "2024-01-23T00:00:00Z",
  "Candidate": "CVE-2023-40551",
  "PublicDate": "2024-01-29T17:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40551"
  ],
  "Description": "A flaw was found in the MZ binary format in Shim. An out-of-bounds read may occur, leading to a crash or possible exposure of sensitive data during the system's boot phase.",
  "UbuntuDescription": "[pe-relocate: Fix bounds check for MZ binaries In read_header(), we attempt to parse the PE binary headers.  In doing so, if there is an MZ (i.e. MS-DOS) header, we locate the PE header by finding the offset in that header.  Unfortunately that is not correctly bounds checked, and carefully chosen values can cause an out-of-bounds ready beyond the end of the loaded binary. Unfortunately the trivial fix (bounds check that value) also makes it clear that the way we were determining if an image is loadable on this platform and distinguishing between PE32 and PE32+ binaries has the exact same issue going on, and so the fix includes reworking that logic to correctly bounds check all of those tests as well. It's not currently known if this is actually exploitable beyond creating a denial of service, and an attacker who is in a position to use it for a denial of service attack must already be able to do so.]",
  "Notes": [
    "eslerm\u003e UEFI Security Response Team states that dbx update is not needed",
    "eslerm\u003e secureboot-db should only ever be updated after shim",
    "eslerm\u003e secureboot-db is not updated on ESM releases as doing so would",
    "eslerm\u003e revoke install media keys Note that key revocation is required to",
    "eslerm\u003e protect against evil housekeeper attacks (such as BlackLotus)"
  ],
  "Bugs": null,
  "Priority": "medium",
  "DiscoveredBy": "Greg Kirkpatrick",
  "AssignedTo": "",
  "Patches": {
    "secureboot-db": {
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "esm-infra/bionic": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "esm-infra/xenial": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "focal": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "lunar": {
        "Status": "ignored",
        "Note": "end of life, was needs-triage"
      },
      "mantic": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "upstream": {
        "Status": "not-affected",
        "Note": "sbat only update"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    },
    "shim": {
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "devel": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/bionic": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/xenial": {
        "Status": "ignored",
        "Note": "install media keys will never be revoked"
      },
      "focal": {
        "Status": "needs-triage",
        "Note": ""
      },
      "jammy": {
        "Status": "needs-triage",
        "Note": ""
      },
      "lunar": {
        "Status": "ignored",
        "Note": "end of life, was needs-triage"
      },
      "mantic": {
        "Status": "needs-triage",
        "Note": ""
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "ignored",
        "Note": "install media keys will never be revoked"
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    },
    "shim-signed": {
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "devel": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/bionic": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/xenial": {
        "Status": "ignored",
        "Note": "install media keys will never be revoked"
      },
      "focal": {
        "Status": "needs-triage",
        "Note": ""
      },
      "jammy": {
        "Status": "needs-triage",
        "Note": ""
      },
      "lunar": {
        "Status": "ignored",
        "Note": "end of life, was needs-triage"
      },
      "mantic": {
        "Status": "needs-triage",
        "Note": ""
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "ignored",
        "Note": "install media keys will never be revoked"
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    }
  },
  "UpstreamLinks": {
    "shim": [
      "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
    ]
  }
}