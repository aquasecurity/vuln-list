{
  "PublicDateAtUSN": "2017-08-21T07:29:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2017-12982",
  "PublicDate": "2017-08-21T07:29:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12982",
    "https://blogs.gentoo.org/ago/2017/08/14/openjpeg-memory-allocation-failure-in-opj_aligned_alloc_n-opj_malloc-c/",
    "https://ubuntu.com/security/notices/USN-4782-1"
  ],
  "Description": "The bmp_read_info_header function in bin/jp2/convertbmp.c in OpenJPEG 2.2.0 does not reject headers with a zero biBitCount, which allows remote attackers to cause a denial of service (memory allocation failure) in the opj_image_create function in lib/openjp2/image.c, related to the opj_aligned_alloc_n function in opj_malloc.c.",
  "UbuntuDescription": "It was discovered that OpenJPEG incorrectly handled certain image files. A remote attacker could possibly use this issue to cause a denial of service.",
  "Notes": [
    "ccdm94\u003e openjpeg is not affected by this issue since the variable which was",
    "ccdm94\u003e not checked for value 0 is checked in the 1.x versions. The code",
    "ccdm94\u003e was refactored in versions 2.x, and this check was removed, causing",
    "ccdm94\u003e the vulnerability. In versions 1.x, variable Info_h.biBitCount is",
    "ccdm94\u003e checked for values 24 and 8, and if not equal to one of them, the",
    "ccdm94\u003e converter returns an error message instead of processing the image",
    "ccdm94\u003e file given as input. In versions 1.x of openjpeg, the function that",
    "ccdm94\u003e contains similar code to the vulnerable one in versions 2.x can be",
    "ccdm94\u003e found in file convert.c. The reproducer does not cause the memory",
    "ccdm94\u003e allocation failure error in versions 1.x."
  ],
  "Bugs": [
    "https://github.com/uclouvain/openjpeg/issues/983"
  ],
  "Priority": "low",
  "DiscoveredBy": "Agostino Sarubbo",
  "AssignedTo": "",
  "Patches": {
    "ghostscript": {
      "bionic": {
        "Status": "not-affected",
        "Note": "code not compiled"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "esm-infra/bionic": {
        "Status": "not-affected",
        "Note": "code not compiled"
      },
      "esm-infra/xenial": {
        "Status": "not-affected",
        "Note": "code not compiled"
      },
      "focal": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "groovy": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "hirsute": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "impish": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "kinetic": {
        "Status": "not-affected",
        "Note": "uses system openjpeg2"
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      },
      "xenial": {
        "Status": "not-affected",
        "Note": "code not compiled"
      }
    },
    "openjpeg": {
      "bionic": {
        "Status": "DNE",
        "Note": ""
      },
      "devel": {
        "Status": "DNE",
        "Note": ""
      },
      "esm-apps/xenial": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "focal": {
        "Status": "DNE",
        "Note": ""
      },
      "groovy": {
        "Status": "DNE",
        "Note": ""
      },
      "hirsute": {
        "Status": "DNE",
        "Note": ""
      },
      "impish": {
        "Status": "DNE",
        "Note": ""
      },
      "jammy": {
        "Status": "DNE",
        "Note": ""
      },
      "kinetic": {
        "Status": "DNE",
        "Note": ""
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "trusty/esm": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "upstream": {
        "Status": "released",
        "Note": "2.3.0"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support, was not-affected"
      }
    },
    "openjpeg2": {
      "artful": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "bionic": {
        "Status": "released",
        "Note": "2.3.0-1"
      },
      "cosmic": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "disco": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "eoan": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "esm-apps/bionic": {
        "Status": "released",
        "Note": "2.3.0-1"
      },
      "esm-apps/xenial": {
        "Status": "released",
        "Note": "2.1.2-1.1+deb9u6ubuntu0.1~esm1"
      },
      "focal": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "groovy": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "hirsute": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "impish": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "kinetic": {
        "Status": "not-affected",
        "Note": "2.3.0-1"
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "upstream": {
        "Status": "released",
        "Note": "2.3.0"
      },
      "vivid/ubuntu-core": {
        "Status": "DNE",
        "Note": ""
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      },
      "zesty": {
        "Status": "ignored",
        "Note": "end of life"
      }
    }
  },
  "UpstreamLinks": {
    "openjpeg": [
      "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
    ],
    "openjpeg2": [
      "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
    ]
  }
}