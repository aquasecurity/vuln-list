{
  "PublicDateAtUSN": "2025-11-12T00:00:00Z",
  "CRD": "2025-11-12T00:00:00Z",
  "Candidate": "CVE-2025-64503",
  "PublicDate": "2025-11-12T22:15:00Z",
  "References": [
    "https://www.cve.org/CVERecord?id=CVE-2025-64503",
    "https://www.openwall.com/lists/oss-security/2025/11/12/2",
    "https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-893j-2wr2-wrh9",
    "https://ubuntu.com/security/notices/USN-7877-1"
  ],
  "Description": "cups-filters contains backends, filters, and other software required to get the cups printing service working on operating systems other than macos. In cups-filters prior to 1.28.18, by crafting a PDF file with a large `MediaBox` value, an attacker can cause CUPS-Filter 1.xâ€™s `pdftoraster` tool to write beyond the bounds of an array. First, a PDF with a large `MediaBox` width value causes `header.cupsWidth` to become large.  Next, the calculation of `bytesPerLine = (header.cupsBitsPerPixel * header.cupsWidth + 7) / 8` overflows, resulting in a small value. Then, `lineBuf` is allocated with the small `bytesPerLine` size. Finally, `convertLineChunked` calls `writePixel8`, which attempts to write to `lineBuf` outside of its buffer size (out of bounds write). In libcupsfilters, the maintainers found the same `bytesPerLine` multiplication without overflow check, but the provided test case does not cause an overflow there, because the values are different. Commit 50d94ca0f2fa6177613c97c59791bde568631865 contains a patch, which is incorporated into cups-filters version 1.28.18.",
  "UbuntuDescription": "",
  "Notes": [
    "mdeslaur\u003e filename changed from pdftoraster.cxx to pdftoraster.c in",
    "mdeslaur\u003e newer versions",
    "mdeslaur\u003e In cups-filters 2.x, this is just a wrapper"
  ],
  "Bugs": null,
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "cups-filters": {
      "devel": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "esm-infra/bionic": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/focal": {
        "Status": "needs-triage",
        "Note": ""
      },
      "esm-infra/xenial": {
        "Status": "needs-triage",
        "Note": ""
      },
      "jammy": {
        "Status": "needs-triage",
        "Note": ""
      },
      "noble": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "plucky": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "questing": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      }
    },
    "libcupsfilters": {
      "devel": {
        "Status": "pending",
        "Note": "2.1.1-0ubuntu4"
      },
      "jammy": {
        "Status": "DNE",
        "Note": ""
      },
      "noble": {
        "Status": "released",
        "Note": "2.0.0-0ubuntu7.2"
      },
      "plucky": {
        "Status": "released",
        "Note": "2.1.1-0ubuntu2.1"
      },
      "questing": {
        "Status": "released",
        "Note": "2.1.1-0ubuntu3.1"
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      }
    }
  },
  "UpstreamLinks": {
    "cups-filters": [
      "https://github.com/OpenPrinting/cups-filters/commit/50d94ca0f2fa6177613c97c59791bde568631865"
    ],
    "libcupsfilters": [
      "https://github.com/OpenPrinting/libcupsfilters/commit/fd01543f372ca3ba1f1c27bd3427110fa0094e3f"
    ]
  }
}