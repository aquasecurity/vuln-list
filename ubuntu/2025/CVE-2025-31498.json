{
  "PublicDateAtUSN": "2025-04-08T14:15:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2025-31498",
  "PublicDate": "2025-04-08T14:15:00Z",
  "References": [
    "https://www.cve.org/CVERecord?id=CVE-2025-31498",
    "https://github.com/c-ares/c-ares/security/advisories/GHSA-6hxc-62jh-p29v",
    "http://www.openwall.com/lists/oss-security/2025/04/08/3",
    "https://github.com/c-ares/c-ares/commit/29d38719112639d8c0ba910254a3dd4f482ea2d1",
    "https://github.com/c-ares/c-ares/pull/821",
    "https://ubuntu.com/security/notices/USN-7477-1"
  ],
  "Description": "c-ares is an asynchronous resolver library. From 1.32.3 through 1.34.4, there is a use-after-free in read_answers() when process_answer() may re-enqueue a query either due to a DNS Cookie Failure or when the upstream server does not properly support EDNS, or possibly on TCP queries if the remote closed the connection immediately after a response. If there was an issue trying to put that new transaction on the wire, it would close the connection handle, but read_answers() was still expecting the connection handle to be available to possibly dequeue other responses. In theory a remote attacker might be able to trigger this by flooding the target with ICMP UNREACHABLE packets if they also control the upstream nameserver and can return a result with one of those conditions, this has been untested. Otherwise only a local attacker might be able to change system behavior to make send()/write() return a failure condition. This vulnerability is fixed in 1.34.5.",
  "UbuntuDescription": "",
  "Notes": [
    "mdeslaur\u003e introduced in 1.32.3 by:",
    "mdeslaur\u003e https://github.com/c-ares/c-ares/commit/ccd11aa37771ece1956c791a6232995317ac595e"
  ],
  "Bugs": null,
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "c-ares": {
      "devel": {
        "Status": "not-affected",
        "Note": "1.34.5-1"
      },
      "esm-infra/bionic": {
        "Status": "not-affected",
        "Note": ""
      },
      "esm-infra/focal": {
        "Status": "not-affected",
        "Note": "1.15.0-1ubuntu0.5"
      },
      "esm-infra/xenial": {
        "Status": "not-affected",
        "Note": ""
      },
      "focal": {
        "Status": "not-affected",
        "Note": "1.15.0-1ubuntu0.5"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "1.18.1-1ubuntu0.22.04.3"
      },
      "noble": {
        "Status": "not-affected",
        "Note": "1.27.0-1.0ubuntu1"
      },
      "oracular": {
        "Status": "released",
        "Note": "1.33.0-1ubuntu0.1"
      },
      "plucky": {
        "Status": "released",
        "Note": "1.34.4-2.1ubuntu0.1"
      },
      "upstream": {
        "Status": "released",
        "Note": "1.34.5-1"
      }
    }
  },
  "UpstreamLinks": {
    "c-ares": [
      "https://github.com/c-ares/c-ares/commit/066b396.patch (1.34)",
      "https://github.com/c-ares/c-ares/compare/9a48eed..d3a507e.patch (1.34)",
      "https://github.com/c-ares/c-ares/compare/69e1ad5..82489f2.patch (1.33)"
    ]
  }
}