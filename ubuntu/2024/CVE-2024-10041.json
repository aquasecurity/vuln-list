{
  "PublicDateAtUSN": "0001-01-01T00:00:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2024-10041",
  "PublicDate": "2024-10-23T14:15:00Z",
  "References": [
    "https://www.cve.org/CVERecord?id=CVE-2024-10041",
    "https://access.redhat.com/security/cve/CVE-2024-10041"
  ],
  "Description": "A vulnerability was found in PAM. The secret information is stored in memory, where the attacker can trigger the victim program to execute by sending characters to its standard input (stdin). As this occurs, the attacker can train the branch predictor to execute an ROP chain speculatively. This flaw could result in leaked passwords, such as those found in /etc/shadow while performing authentications.",
  "UbuntuDescription": "",
  "Notes": [
    "mdeslaur\u003e The upstream bug for this issue, #846, indicates that the fix",
    "mdeslaur\u003e in pull 686, also listed below as the commit in 1.6.0, fixes",
    "mdeslaur\u003e this issue.",
    "mdeslaur\u003e",
    "mdeslaur\u003e Fixing this CVE may require changes in apparmor policies, see:",
    "mdeslaur\u003e https://salsa.debian.org/apparmor-team/apparmor/-/commit/243162ca2938b391724f547596787c7f77d1fc5f",
    "mdeslaur\u003e https://bugzilla.opensuse.org/show_bug.cgi?id=1219139",
    "mdeslaur\u003e https://gitlab.com/apparmor/apparmor/-/commit/243162ca2938b391724f547596787c7f77d1fc5f",
    "mdeslaur\u003e https://gitlab.com/apparmor/apparmor/-/commit/0deda68bd8edb356228b420c6e0392922155a9fb",
    "mdeslaur\u003e https://gitlab.com/apparmor/apparmor/-/commit/6f5a4219d737709278c1678f4865d24633059f7d",
    "mdeslaur\u003e https://gitlab.com/apparmor/apparmor/-/commit/b6eb4620492f61bd57873145edc4b721cf7ca66c",
    "mdeslaur\u003e",
    "mdeslaur\u003e This fix will also possibly require changes in other",
    "mdeslaur\u003e applications:",
    "mdeslaur\u003e https://github.com/linux-pam/linux-pam/issues/874",
    "mdeslaur\u003e https://github.com/linux-pam/linux-pam/issues/747",
    "mdeslaur\u003e",
    "mdeslaur\u003e The pam change required to fix this vulnerability fundamentally",
    "mdeslaur\u003e changes how passwords are read from the shadow file. Instead of",
    "mdeslaur\u003e being read by the pam module itself, the patch switches to using",
    "mdeslaur\u003e the external unix-chkpwd helper.",
    "mdeslaur\u003e",
    "mdeslaur\u003e This change is very intrusive and is likely to cause regressions",
    "mdeslaur\u003e in many environments, including those using custom AppArmor or",
    "mdeslaur\u003e PAM configurations, and installations that have been hardened.",
    "mdeslaur\u003e",
    "mdeslaur\u003e Since this is a local attack that is mostly theoretical and",
    "mdeslaur\u003e likely very difficult to perform successfully, and there are no",
    "mdeslaur\u003e public reproducers for this issue, we will not be fixing this",
    "mdeslaur\u003e issue in stable Ubuntu releases. Marking releases as ignored."
  ],
  "Bugs": [
    "https://bugzilla.redhat.com/show_bug.cgi?id=2319212",
    "https://github.com/linux-pam/linux-pam/issues/846",
    "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1086038"
  ],
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "pam": {
      "devel": {
        "Status": "released",
        "Note": "1.7.0-5ubuntu1"
      },
      "esm-infra-legacy/trusty": {
        "Status": "ignored",
        "Note": ""
      },
      "esm-infra/bionic": {
        "Status": "ignored",
        "Note": ""
      },
      "esm-infra/focal": {
        "Status": "ignored",
        "Note": ""
      },
      "esm-infra/xenial": {
        "Status": "ignored",
        "Note": ""
      },
      "focal": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      },
      "jammy": {
        "Status": "ignored",
        "Note": ""
      },
      "noble": {
        "Status": "ignored",
        "Note": ""
      },
      "oracular": {
        "Status": "ignored",
        "Note": "end of life, was needed"
      },
      "plucky": {
        "Status": "ignored",
        "Note": ""
      },
      "trusty/esm": {
        "Status": "ignored",
        "Note": "end of ESM support, was deferred [2025-04-24]"
      },
      "upstream": {
        "Status": "released",
        "Note": "1.6.0"
      }
    }
  },
  "UpstreamLinks": {
    "pam": [
      "https://github.com/linux-pam/linux-pam/pull/686",
      "https://github.com/linux-pam/linux-pam/commit/b3020da7da384d769f27a8713257fbe1001878be (1.6.0)",
      "https://github.com/linux-pam/linux-pam/commit/b7b96362087414e52524d3d9d9b3faa21e1db620 (1.6.1, fix?)"
    ]
  }
}