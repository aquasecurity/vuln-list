{
  "PublicDateAtUSN": "0001-01-01T00:00:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2024-49214",
  "PublicDate": "2024-10-14T04:15:00Z",
  "References": [
    "https://www.cve.org/CVERecord?id=CVE-2024-49214",
    "https://www.haproxy.org/download/3.1/src/CHANGELOG",
    "https://www.haproxy.org/download/3.0/src/CHANGELOG",
    "https://www.haproxy.org/download/2.9/src/CHANGELOG",
    "https://www.mail-archive.com/haproxy%40formilux.org/msg45291.html",
    "https://www.mail-archive.com/haproxy%40formilux.org/msg45314.html",
    "https://www.mail-archive.com/haproxy%40formilux.org/msg45315.html"
  ],
  "Description": "QUIC in HAProxy 3.1.x before 3.1-dev7, 3.0.x before 3.0.5, and 2.9.x before 2.9.11 allows opening a 0-RTT session with a spoofed IP address. This can bypass the IP allow/block list functionality.",
  "UbuntuDescription": "",
  "Notes": [
    "mdeslaur\u003e Per the CVE description, this affects 2.9.x+, per the commit",
    "mdeslaur\u003e description, this affects 2.6+.",
    "mdeslaur\u003e As of 2024-10-29, there is no backport to 2.8.x available.",
    "mdeslaur\u003e The fix consists of providing a token to the client each time it",
    "mdeslaur\u003e successfully managed to connect to haproxy. The token code is",
    "mdeslaur\u003e only enabled if HAVE_SSL_0RTT_QUIC is set, which is only set",
    "mdeslaur\u003e when aws-lc and perhaps boringssl is being used as the ssl",
    "mdeslaur\u003e backend. In Ubuntu, packages are built with OpenSSL, so the",
    "mdeslaur\u003e QUIC support doesn't handle 0RTT and hence packages are not",
    "mdeslaur\u003e vulnerable."
  ],
  "Bugs": null,
  "Priority": "medium",
  "DiscoveredBy": "Wedl Michael",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "haproxy": {
      "devel": {
        "Status": "not-affected",
        "Note": "built with OpenSSL"
      },
      "esm-infra/bionic": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "esm-infra/focal": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "esm-infra/xenial": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "focal": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "code not present"
      },
      "noble": {
        "Status": "not-affected",
        "Note": "built with OpenSSL"
      },
      "oracular": {
        "Status": "not-affected",
        "Note": "built with OpenSSL"
      },
      "upstream": {
        "Status": "released",
        "Note": "2.9.11-1"
      }
    }
  },
  "UpstreamLinks": {
    "haproxy": [
      "https://github.com/haproxy/haproxy/commit/f627b9272bd8ffca6f2f898bfafc6bf0b84b7d46 (v3.1-dev7)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=8f0d380f3905e7a5814e9ffed29bc83c66383864 (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=fa00c0a1b692f4bfbb0dd1360d35528e554607d8 (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=d60edbde4834ce3db567053ab9b8973dc62dbe2f (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=78f36a6ee40ff00ec1519ad1a5aec73c6371c51b (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=0282a82f79ceb9f15515edf49542e7199eede408 (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=cf4b5e1001880bcece3c4d12b5aa422d378dcf1d (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=ab5a390451239282d8a3fd2c45f56162b92a3bd3 (2.9 dep)",
      "https://git.haproxy.org/?p=haproxy-2.9.git;a=commit;h=fe5685af820ae62fe5b0d80b5ed7a2ffc41a036f (2.9.x)"
    ]
  }
}