{
  "PublicDateAtUSN": "0001-01-01T00:00:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2024-21510",
  "PublicDate": "2024-11-01T05:15:00Z",
  "References": [
    "https://www.cve.org/CVERecord?id=CVE-2024-21510",
    "https://security.snyk.io/vuln/SNYK-RUBY-SINATRA-6483832",
    "https://github.com/sinatra/sinatra/pull/2053#issuecomment-2486996349",
    "https://github.com/rack/rack/commit/58eed3015d89249a3c48d144bbeabb01f69ea696"
  ],
  "Description": "Versions of the package sinatra from 0.0.0 are vulnerable to Reliance on Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH) header. When making a request to a method with redirect applied, it is possible to trigger an Open Redirect Attack by inserting an arbitrary address into this header. If used for caching purposes, such as with servers like Nginx, or as a reverse proxy, without handling the X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning or Routing-based SSRF.",
  "UbuntuDescription": "",
  "Notes": [
    "hlibk\u003e The patch itself appears to be a security feature that enables",
    "hlibk\u003e users to allow certain hosts in forwarded headers. The patch",
    "hlibk\u003e utilizes a dependency called ruby-rack which does not contain the",
    "hlibk\u003e implementation of RFC 7239 Forwarded header in versions of",
    "hlibk\u003e ruby-rack below 3.0. This means that the fix appears to be partial",
    "hlibk\u003e for those versions, and upstream has mentioned that they have no",
    "hlibk\u003e plans of supporting any older releases. Additionally, on jammy and",
    "hlibk\u003e below, the dependency appears to lack a feature that enables the",
    "hlibk\u003e patch, which makes the patch not apply for those releases.",
    "mdeslaur\u003e Since this introduces a new API to work-around the issue,",
    "mdeslaur\u003e doesn't fix existing uses of ruby-sinatra, and is an intrusive",
    "mdeslaur\u003e backport, we will not be fixing this CVE in Ubuntu stable",
    "mdeslaur\u003e releases."
  ],
  "Bugs": [
    "https://github.com/sinatra/sinatra/issues/2052",
    "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1087290"
  ],
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "ruby-sinatra": {
      "devel": {
        "Status": "ignored",
        "Note": "see note"
      },
      "esm-apps/bionic": {
        "Status": "ignored",
        "Note": "see note"
      },
      "esm-apps/focal": {
        "Status": "ignored",
        "Note": "see note"
      },
      "esm-apps/jammy": {
        "Status": "ignored",
        "Note": "see note"
      },
      "esm-apps/xenial": {
        "Status": "ignored",
        "Note": "see note"
      },
      "focal": {
        "Status": "ignored",
        "Note": "end of standard support, was ignored [see note]"
      },
      "jammy": {
        "Status": "ignored",
        "Note": "see note"
      },
      "noble": {
        "Status": "ignored",
        "Note": "see note"
      },
      "oracular": {
        "Status": "ignored",
        "Note": "end of life, was ignored [see note]"
      },
      "upstream": {
        "Status": "released",
        "Note": "4.1.0"
      }
    }
  },
  "UpstreamLinks": {
    "ruby-sinatra": [
      "https://github.com/sinatra/sinatra/pull/2053",
      "https://github.com/sinatra/sinatra/commit/cd3e00de20ddaff34ea30f7a74a7b9dad189d1d8"
    ]
  }
}