{
  "PublicDateAtUSN": "2021-10-08T14:15:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2021-41133",
  "PublicDate": "2021-10-08T14:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41133",
    "https://github.com/flatpak/flatpak/security/advisories/GHSA-67h7-w3jq-vh4q",
    "https://ubuntu.com/security/notices/USN-5191-1"
  ],
  "Description": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. In versions prior to 1.10.4 and 1.12.0, Flatpak apps with direct access to AF_UNIX sockets such as those used by Wayland, Pipewire or pipewire-pulse can trick portals and other host-OS services into treating the Flatpak app as though it was an ordinary, non-sandboxed host-OS process. They can do this by manipulating the VFS using recent mount-related syscalls that are not blocked by Flatpak's denylist seccomp filter, in order to substitute a crafted `/.flatpak-info` or make that file disappear entirely. Flatpak apps that act as clients for AF_UNIX sockets such as those used by Wayland, Pipewire or pipewire-pulse can escalate the privileges that the corresponding services will believe the Flatpak app has. Note that protocols that operate entirely over the D-Bus session bus (user bus), system bus or accessibility bus are not affected by this. This is due to the use of a proxy process `xdg-dbus-proxy`, whose VFS cannot be manipulated by the Flatpak app, when interacting with these buses. Patches exist for versions 1.10.4 and 1.12.0, and as of time of publication, a patch for version 1.8.2 is being planned. There are no workarounds aside from upgrading to a patched version.",
  "UbuntuDescription": "",
  "Notes": [
    "alexmurray| Requires libseccomp\u003e=2.5.0 - this is only in the updates pocket in focal and bionic so libseccomp needs to be published to the security pocket in those releases as well to ensure this vulnerability is properly mitigated."
  ],
  "Bugs": [
    "https://bugs.launchpad.net/ubuntu/+source/flatpak/+bug/1946578",
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=995935"
  ],
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Patches": {
    "flatpak": {
      "bionic": {
        "Status": "released",
        "Note": "1.0.9-0ubuntu0.4"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "1.12.2-1"
      },
      "esm-apps/bionic": {
        "Status": "released",
        "Note": "1.0.9-0ubuntu0.4"
      },
      "esm-apps/focal": {
        "Status": "released",
        "Note": "1.6.5-0ubuntu0.4"
      },
      "esm-apps/jammy": {
        "Status": "not-affected",
        "Note": "1.12.2-1"
      },
      "focal": {
        "Status": "released",
        "Note": "1.6.5-0ubuntu0.4"
      },
      "hirsute": {
        "Status": "released",
        "Note": "1.10.2-1ubuntu1.1"
      },
      "impish": {
        "Status": "released",
        "Note": "1.10.2-3ubuntu0.1"
      },
      "jammy": {
        "Status": "not-affected",
        "Note": "1.12.2-1"
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "upstream": {
        "Status": "released",
        "Note": "1.12.1-1"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    }
  },
  "UpstreamLinks": {
    "flatpak": [
      "https://github.com/flatpak/flatpak/commit/1330662f33a55e88bfe18e76de28b7922d91a999",
      "https://github.com/flatpak/flatpak/commit/a10f52a7565c549612c92b8e736a6698a53db330",
      "https://github.com/flatpak/flatpak/commit/4c34815784e9ffda5733225c7d95824f96375e36",
      "https://github.com/flatpak/flatpak/commit/89ae9fe74c6d445bb1b3a40e568d77cf5de47e48",
      "https://github.com/flatpak/flatpak/commit/462fca2c666e0cd2b60d6d2593a7216a83047aaf",
      "https://github.com/flatpak/flatpak/commit/e26ac7586c392b5eb35ff4609fe232c52523b2cf",
      "https://github.com/flatpak/flatpak/commit/26b12484eb8a6219b9e7aa287b298a894b2f34ca",
      "https://github.com/flatpak/flatpak/commit/9766ee05b1425db397d2cf23afd24c7f6146a69f",
      "https://github.com/flatpak/flatpak/commit/d419fa67038370e4f4c3ce8c3b5f672d4876cfc8 (follow-up)",
      "https://github.com/flatpak/flatpak/commit/3fc8c672676ae016f8e7cc90481b2feecbad9861 (follow-up)"
    ]
  }
}