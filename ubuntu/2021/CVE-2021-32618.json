{
  "PublicDateAtUSN": "0001-01-01T00:00:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2021-32618",
  "PublicDate": "2021-05-17T18:15:00Z",
  "References": [
    "https://github.com/Flask-Middleware/flask-security/issues/486",
    "https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c",
    "https://www.cve.org/CVERecord?id=CVE-2021-32618"
  ],
  "Description": "The Python \"Flask-Security-Too\" package is used for adding security features to your Flask application. It is an is an independently maintained version of Flask-Security based on the 3.0.0 version of Flask-Security. All versions of Flask-Security-Too allow redirects after many successful views (e.g. /login) by honoring the ?next query param. There is code in FS to validate that the url specified in the next parameter is either relative OR has the same netloc (network location) as the requesting URL. This check utilizes Pythons urlsplit library. However many browsers are very lenient on the kind of URL they accept and 'fill in the blanks' when presented with a possibly incomplete URL. As a concrete example - setting http://login?next=\\\\\\github.com will pass FS's relative URL check however many browsers will gladly convert this to http://github.com. Thus an attacker could send such a link to an unwitting user, using a legitimate site and have it redirect to whatever site they want. This is considered a low severity due to the fact that if Werkzeug is used (which is very common with Flask applications) as the WSGI layer, it by default ALWAYS ensures that the Location header is absolute - thus making this attack vector mute. It is possible for application writers to modify this default behavior by setting the 'autocorrect_location_header=False`.",
  "UbuntuDescription": "",
  "Notes": [
    "yomonokio\u003e This CVE is a duplicate of CVE-2021-23385, but for",
    "yomonokio\u003e flask-security-too (new upstream). In Ubuntu, the",
    "yomonokio\u003e flask-security source package started to be based",
    "yomonokio\u003e on flask-security-too starting from mantic, therefore",
    "yomonokio\u003e we will track only CVE-2021-23385 and mark this one as",
    "yomonokio\u003e ignored."
  ],
  "Bugs": null,
  "Priority": "low",
  "DiscoveredBy": "",
  "AssignedTo": "",
  "Tags": null,
  "Patches": {
    "flask-security": {
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support, was needs-triage"
      },
      "devel": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "esm-apps/bionic": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "esm-apps/focal": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "esm-apps/jammy": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "esm-apps/noble": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "esm-infra-legacy/trusty": {
        "Status": "DNE",
        "Note": ""
      },
      "focal": {
        "Status": "ignored",
        "Note": "end of standard support, was ignored [see notes]"
      },
      "groovy": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "hirsute": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "impish": {
        "Status": "ignored",
        "Note": "end of life"
      },
      "jammy": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "kinetic": {
        "Status": "ignored",
        "Note": "end of life, was needs-triage"
      },
      "lunar": {
        "Status": "ignored",
        "Note": "end of life, was needs-triage"
      },
      "mantic": {
        "Status": "ignored",
        "Note": "end of life, was ignored [see notes]"
      },
      "noble": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "upstream": {
        "Status": "needs-triage",
        "Note": ""
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    }
  },
  "UpstreamLinks": {}
}