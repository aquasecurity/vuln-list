{
  "PublicDateAtUSN": "2019-03-21T00:00:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2019-7303",
  "PublicDate": "2019-04-23T16:29:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7303",
    "https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SnapIoctlTIOCSTI",
    "https://ubuntu.com/security/notices/USN-3917-1"
  ],
  "Description": "A vulnerability in the seccomp filters of Canonical snapd before version 2.37.4 allows a strict mode snap to insert characters into a terminal on a 64-bit host. The seccomp rules were generated to match 64-bit ioctl(2) commands on a 64-bit platform; however, the Linux kernel only uses the lower 32 bits to determine which ioctl(2) commands to run. This issue affects: Canonical snapd versions prior to 2.37.4.",
  "UbuntuDescription": "",
  "Notes": [
    "jdstrand\u003e this is a kernel limitation that is documented in the seccomp man page, but arguably the kernel should perform the seccomp filter check on the value that it is ultimately going to process (which likely means an improvement to libseccomp to generate the appropriate BPF to do this)",
    "jdstrand\u003e this was further complicated by the fact that the kernel and glibc disagree on the function prototype of ioctl, where the glibc man page documents it as unsigned long and the kernel treats it as int (note, the tty_ioctl man page (which is the one that documents TIOCSTI) lists the ioctl second argument as an int)",
    "jdstrand\u003e due to miscoordination, 2.37.4 is going to -updates first as part of the regular SRU cycle. Once that passes, we'll rebuild and publish to the security pocket and issue a USN.",
    "jdstrand\u003e once this issue is public, the global profile initialization code that is used to address this issue will also be made public"
  ],
  "Bugs": [
    "https://launchpad.net/bugs/1812973"
  ],
  "Priority": "medium",
  "DiscoveredBy": "Jann Horn",
  "AssignedTo": "zyga",
  "Patches": {
    "snapd": {
      "bionic": {
        "Status": "released",
        "Note": "2.37.4+18.04"
      },
      "cosmic": {
        "Status": "released",
        "Note": "2.37.4+18.10"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "2.37.4+19.04"
      },
      "esm-infra/bionic": {
        "Status": "released",
        "Note": "2.37.4+18.04"
      },
      "esm-infra/xenial": {
        "Status": "released",
        "Note": "2.37.4"
      },
      "precise/esm": {
        "Status": "DNE",
        "Note": ""
      },
      "trusty": {
        "Status": "released",
        "Note": "2.37.4~14.04"
      },
      "trusty/esm": {
        "Status": "DNE",
        "Note": "trusty was released [2.37.4~14.04]"
      },
      "upstream": {
        "Status": "released",
        "Note": "2.37.4"
      },
      "xenial": {
        "Status": "released",
        "Note": "2.37.4"
      }
    }
  },
  "UpstreamLinks": {
    "snapd": [
      "https://github.com/snapcore/snapd/pull/6516 (part 1)",
      "https://github.com/snapcore/snapd/pull/6533 (part 2)"
    ]
  }
}