{
  "PublicDateAtUSN": "2022-08-02T15:15:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2022-29154",
  "PublicDate": "2022-08-02T15:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29154",
    "https://download.samba.org/pub/rsync/NEWS",
    "https://lists.samba.org/archive/rsync/2022-August/032860.html",
    "https://ubuntu.com/security/notices/USN-5921-1"
  ],
  "Description": "An issue was discovered in rsync before 3.2.5 that allows malicious remote servers to write arbitrary files inside the directories of connecting peers. The server chooses which files/directories are sent to the client. However, the rsync client performs insufficient validation of file names. A malicious rsync server (or Man-in-The-Middle attacker) can overwrite arbitrary files in the rsync client target directory and subdirectories (for example, overwrite the .ssh/authorized_keys file).",
  "UbuntuDescription": "",
  "Notes": [
    "mdeslaur\u003e two additional commits were added later on...need to check if",
    "mdeslaur\u003e more go in before the official release",
    "rodrigo-zaiden\u003e Another commit was found to be part of the collection for",
    "rodrigo-zaiden\u003e this CVE. 4 in total seems to address it. The missing commit",
    "rodrigo-zaiden\u003e was added in historical order in the Patches section here.",
    "mdeslaur\u003e many more commits were added into 3.2.5 than what is listed below",
    "mdeslaur\u003e 3.2.5 introduced regressions which were fixed in 3.2.6 and 3.2.7"
  ],
  "Bugs": [
    "https://github.com/WayneD/rsync/issues/356 (regression bug)",
    "https://github.com/WayneD/rsync/issues/350 (regression bug)",
    "https://github.com/WayneD/rsync/issues/360 (regression bug)"
  ],
  "Priority": "medium",
  "DiscoveredBy": "Koen van Hove",
  "AssignedTo": "mdeslaur",
  "Patches": {
    "rsync": {
      "bionic": {
        "Status": "released",
        "Note": "3.1.2-2.1ubuntu1.6"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "3.2.5"
      },
      "esm-infra/bionic": {
        "Status": "released",
        "Note": "3.1.2-2.1ubuntu1.6"
      },
      "esm-infra/xenial": {
        "Status": "ignored",
        "Note": "change too intrusive"
      },
      "focal": {
        "Status": "released",
        "Note": "3.1.3-8ubuntu0.5"
      },
      "jammy": {
        "Status": "released",
        "Note": "3.2.7-0ubuntu0.22.04.2"
      },
      "kinetic": {
        "Status": "not-affected",
        "Note": "3.2.5"
      },
      "lunar": {
        "Status": "not-affected",
        "Note": "3.2.5"
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "trusty/esm": {
        "Status": "ignored",
        "Note": "change too intrusive"
      },
      "upstream": {
        "Status": "released",
        "Note": "3.2.5"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support"
      }
    }
  },
  "UpstreamLinks": {
    "rsync": [
      "https://git.samba.org/?p=rsync.git;a=commit;h=6b8db0f6440b28d26ef807d17517715c47e62bd9 (bp)",
      "https://git.samba.org/?p=rsync.git;a=commit;h=635d8c0632fa9549441ed468ff2cc167800f7fab (bp)",
      "https://git.samba.org/?p=rsync.git;a=commit;h=71090b7e2caefb5894c10b02d34e2c57e4de848b (bp)",
      "https://git.samba.org/?p=rsync.git;a=commit;h=b7231c7d02cfb65d291af74ff66e7d8c507ee871",
      "https://git.samba.org/?p=rsync.git;a=commit;h=7e5424b806e8eea053016268ad186276e9083b77",
      "https://git.samba.org/?p=rsync.git;a=commit;h=3d7015afa223494e3318495c2f5de9cb49229da9",
      "https://git.samba.org/?p=rsync.git;a=commit;h=2f7c583143bc6e80902139c23d9d7283f88fbc6a"
    ]
  }
}