{
  "PublicDateAtUSN": "2023-03-29T17:15:00Z",
  "CRD": "0001-01-01T00:00:00Z",
  "Candidate": "CVE-2022-48434",
  "PublicDate": "2023-03-29T17:15:00Z",
  "References": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48434",
    "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/cc867f2c09d2b69cee8a0eccd62aff002cbbfe11 (n6.1-dev)",
    "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/35aa7e70e7ec350319e7634a30d8d8aa1e6ecdda (n5.1.2)",
    "https://wrv.github.io/h26forge.pdf",
    "https://news.ycombinator.com/item?id=35356201",
    "https://ubuntu.com/security/notices/USN-6449-1"
  ],
  "Description": "libavcodec/pthread_frame.c in FFmpeg before 5.1.2, as used in VLC and other products, leaves stale hwaccel state in worker threads, which allows attackers to trigger a use-after-free and execute arbitrary code in some circumstances (e.g., hardware re-initialization upon a mid-video SPS change when Direct3D11 is used).",
  "UbuntuDescription": "",
  "Notes": [
    "ccdm94\u003e As of 2023-04-26 there is no public reproducer available for this issue,",
    "ccdm94\u003e so there is no way to confirm through vulnerability testing that Xenial",
    "ccdm94\u003e and Bionic are vulnerable to this issue.",
    "ccdm94\u003e",
    "ccdm94\u003e Xenial's version of FFmpeg is 2.8. Upstream has only provided patches",
    "ccdm94\u003e for versions 4.4.x, 5.0.x and 5.1.x. Considering that the code for",
    "ccdm94\u003e pthread_frame.c (file altered by the patch) and for FFmpeg has changed",
    "ccdm94\u003e significantly from version 2.8 to version 4.4.3, applying the 4.4.3",
    "ccdm94\u003e patch is very likely to introduce security issues and regressions.",
    "ccdm94\u003e Because of the very intrusive nature of the backport, Xenial and Bionic",
    "ccdm94\u003e (at version 3.4) will not be patched for this issue, and will therefore",
    "ccdm94\u003e be marked as ignored."
  ],
  "Bugs": null,
  "Priority": "medium",
  "DiscoveredBy": "",
  "AssignedTo": "nickgalanis",
  "Patches": {
    "ffmpeg": {
      "bionic": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      },
      "devel": {
        "Status": "not-affected",
        "Note": "7:5.1.2-3ubuntu1"
      },
      "esm-apps/bionic": {
        "Status": "released",
        "Note": "7:3.4.11-0ubuntu0.1+esm3"
      },
      "esm-apps/focal": {
        "Status": "released",
        "Note": "7:4.2.7-0ubuntu0.1+esm3"
      },
      "esm-apps/jammy": {
        "Status": "released",
        "Note": "7:4.4.2-0ubuntu0.22.04.1+esm2"
      },
      "esm-apps/xenial": {
        "Status": "ignored",
        "Note": "see notes"
      },
      "focal": {
        "Status": "needed",
        "Note": ""
      },
      "jammy": {
        "Status": "needed",
        "Note": ""
      },
      "kinetic": {
        "Status": "ignored",
        "Note": "end of life, was needed"
      },
      "lunar": {
        "Status": "not-affected",
        "Note": "7:5.1.2-3ubuntu1"
      },
      "mantic": {
        "Status": "not-affected",
        "Note": "7:5.1.2-3ubuntu1"
      },
      "trusty": {
        "Status": "ignored",
        "Note": "end of standard support"
      },
      "upstream": {
        "Status": "released",
        "Note": "7:5.1.2-1, 5.1.2, 5.0.1, 4.4.3"
      },
      "xenial": {
        "Status": "ignored",
        "Note": "end of standard support, was needed"
      }
    }
  },
  "UpstreamLinks": {
    "ffmpeg": [
      "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/d4b7b3c03ee2baf0166ce49dff17ec9beff684db (4.4.x)",
      "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/3bc28e9d1ab33627cea3c632dd6b0c33e22e93ba (5.0.x)",
      "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/35aa7e70e7ec350319e7634a30d8d8aa1e6ecdda (5.1.x)",
      "https://git.ffmpeg.org/gitweb/ffmpeg.git/commit/cc867f2c09d2b69cee8a0eccd62aff002cbbfe11 (n6.1-dev)"
    ]
  }
}