{
 "Description": "The elevated privilege level required to perform operations such as chroot() should be dropped immediately after the operation is performed.",
 "ExtendedDescription": null,
 "RelatedWeaknesses": {
  "RelatedWeakness": [
   {
    "Nature": "ChildOf",
    "CWEID": 271,
    "ViewID": 1000,
    "ChainID": 0,
    "Ordinal": "Primary"
   }
  ]
 },
 "WeaknessOrdinalities": {
  "WeaknessOrdinality": [
   {
    "Ordinality": "Primary",
    "Description": ""
   }
  ]
 },
 "ApplicablePlatforms": {
  "Language": [
   {
    "Name": "",
    "Class": "Not Language-Specific",
    "Prevalence": "Undetermined"
   }
  ],
  "OperatingSystem": null,
  "Architecture": null,
  "Technology": null
 },
 "BackgroundDetails": {
  "BackgroundDetail": null
 },
 "AlternateTerms": {
  "AlternateTerm": null
 },
 "ModesOfIntroduction": {
  "Introduction": [
   {
    "Phase": "Implementation",
    "Note": null
   },
   {
    "Phase": "Operation",
    "Note": null
   }
  ]
 },
 "ExploitationFactors": {
  "ExploitationFactor": null
 },
 "LikelihoodOfExploit": "",
 "CommonConsequences": {
  "Consequence": [
   {
    "Scope": [
     "Access Control",
     "Confidentiality"
    ],
    "Impact": [
     "Gain Privileges or Assume Identity",
     "Read Application Data",
     "Read Files or Directories"
    ],
    "Likelihood": "",
    "Note": null,
    "ConsequenceID": ""
   }
  ]
 },
 "DetectionMethods": {
  "DetectionMethod": [
   {
    "Method": "Automated Static Analysis - Binary or Bytecode",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                  "
    ],
    "Effectiveness": "SOAR Partial",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Dynamic Analysis with Automated Results Interpretation",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                  "
    ],
    "Effectiveness": "SOAR Partial",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Manual Static Analysis - Source Code",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                     \n                        \n                  "
    ],
    "Effectiveness": "High",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Automated Static Analysis - Source Code",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                  "
    ],
    "Effectiveness": "SOAR Partial",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Automated Static Analysis",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                  "
    ],
    "Effectiveness": "SOAR Partial",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Architecture or Design Review",
    "Description": [
     "According to SOAR [REF-1479], the following detection techniques may be useful:",
     "\n                     \n                        \n                     \n                        \n                  "
    ],
    "Effectiveness": "High",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   }
  ]
 },
 "PotentialMitigations": {
  "Mitigation": [
   {
    "Phase": [
     "Architecture and Design",
     "Operation"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-1"
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "Separation of Privilege",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-48"
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "Separation of Privilege",
    "Description": [
     "Compartmentalize the system to have \"safe\" areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area.",
     "Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges."
    ],
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-46"
   }
  ]
 },
 "DemonstrativeExamples": {
  "DemonstrativeExample": [
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "setuid(0);\n                     \n                     setuid(old_uid);\n                     \n                     \n                  "
     ],
     "Language": "C",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": ""
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "AccessController.doPrivileged(new PrivilegedAction() {\n                  "
     ],
     "Language": "Java",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": "DX-142"
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "chroot(APP_HOME);chdir(\"/\");FILE* data = fopen(argv[1], \"r+\");..."
     ],
     "Language": "C",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": "DX-98"
   }
  ]
 },
 "ObservedExamples": {
  "ObservedExample": null
 },
 "FunctionalAreas": {
  "FunctionalArea": null
 },
 "AffectedResources": {
  "AffectedResource": null
 },
 "TaxonomyMappings": {
  "TaxonomyMapping": [
   {
    "EntryID": "",
    "EntryName": "Least Privilege Violation",
    "MappingFit": "",
    "TaxonomyName": "7 Pernicious Kingdoms"
   },
   {
    "EntryID": "",
    "EntryName": "Failure to drop privileges when reasonable",
    "MappingFit": "",
    "TaxonomyName": "CLASP"
   },
   {
    "EntryID": "POS02-C",
    "EntryName": "Follow the principle of least privilege",
    "MappingFit": "",
    "TaxonomyName": "CERT C Secure Coding"
   },
   {
    "EntryID": "SEC00-J",
    "EntryName": "Do not allow privileged blocks to leak sensitive information across a trust boundary",
    "MappingFit": "",
    "TaxonomyName": "The CERT Oracle Secure Coding Standard for Java (2011)"
   },
   {
    "EntryID": "SEC01-J",
    "EntryName": "Do not allow tainted variables in privileged blocks",
    "MappingFit": "",
    "TaxonomyName": "The CERT Oracle Secure Coding Standard for Java (2011)"
   },
   {
    "EntryID": "SFP36",
    "EntryName": "Privilege",
    "MappingFit": "",
    "TaxonomyName": "Software Fault Patterns"
   }
  ]
 },
 "RelatedAttackPatterns": {
  "RelatedAttackPattern": [
   {
    "CAPECID": 17
   },
   {
    "CAPECID": 35
   },
   {
    "CAPECID": 76
   }
  ]
 },
 "References": {
  "Reference": [
   {
    "ExternalReferenceID": "REF-6",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-1479",
    "Section": ""
   }
  ]
 },
 "MappingNotes": {
  "Usage": "Allowed",
  "Rationale": null,
  "Comments": null,
  "Reasons": {
   "Reason": [
    {
     "Type": "Acceptable-Use"
    }
   ]
  },
  "Suggestions": {
   "Suggestion": null
  }
 },
 "Notes": {
  "Note": [
   {
    "Items": null,
    "Type": "Maintenance"
   },
   {
    "Items": [
     "If system privileges are not dropped when it is reasonable to do so, this is not a vulnerability by itself. According to the principle of least privilege, access should be allowed only when it is absolutely necessary to the function of a given system, and only for the minimal necessary amount of time. Any further allowance of privilege widens the window of time during which a successful exploitation of the system will provide an attacker with that same privilege. If at all possible, limit the allowance of system privilege to small, simple sections of code that may be called atomically.",
     "When a program calls a privileged function, such as chroot(), it must first acquire root privilege. As soon as the privileged operation has completed, the program should drop root privilege and return to the privilege level of the invoking user."
    ],
    "Type": "Other"
   }
  ]
 },
 "ContentHistory": {
  "Submission": {
   "SubmissionName": "7 Pernicious Kingdoms",
   "SubmissionOrganization": "",
   "SubmissionDate": "2006-07-19T00:00:00Z",
   "SubmissionVersion": "Draft 3",
   "SubmissionReleaseDate": "2006-07-19T00:00:00Z",
   "SubmissionComment": ""
  },
  "Modification": [
   {
    "ModificationName": "Eric Dalci",
    "ModificationOrganization": "Cigital",
    "ModificationDate": "2008-07-01T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Time_of_Introduction"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2008-09-08T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Common_Consequences, Relationships, Other_Notes, Taxonomy_Mappings, Weakness_Ordinalities"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2008-10-14T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Maintenance_Notes"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2008-11-24T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-03-10T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-05-27T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-12-28T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2010-06-21T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2010-12-13T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Other_Notes"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2011-06-01T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2012-05-11T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples, Relationships, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2012-10-30T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2014-07-30T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Detection_Factors, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2017-11-08T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Applicable_Platforms, Causal_Nature, Common_Consequences, Demonstrative_Examples, Modes_of_Introduction, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2019-01-03T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2020-02-24T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Detection_Factors, References, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2020-12-10T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2021-03-15T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2023-04-27T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships, Time_of_Introduction"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2023-06-29T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Mapping_Notes"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2025-09-09T00:00:00Z",
    "ModificationVersion": "4.18",
    "ModificationReleaseDate": "2025-09-09T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Detection_Factors, References"
   }
  ],
  "Contribution": null,
  "PreviousEntryName": null
 },
 "ID": 272,
 "Name": "Least Privilege Violation",
 "Abstraction": "Base",
 "Structure": "Simple",
 "Status": "Incomplete",
 "Diagram": ""
}