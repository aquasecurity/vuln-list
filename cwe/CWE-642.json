{
 "Description": "The product stores security-critical state information about its users, or the product itself, in a location that is accessible to unauthorized actors.",
 "ExtendedDescription": [
  "If an attacker can modify the state information without detection, then it could be used to perform unauthorized actions or access unexpected resources, since the application programmer does not expect that the state can be changed.",
  "State information can be stored in various locations such as a cookie, in a hidden web form field, input parameter or argument, an environment variable, a database record, within a settings file, etc. All of these locations have the potential to be modified by an attacker. When this state information is used to control security or determine resource usage, then it may create a vulnerability. For example, an application may perform authentication, then save the state in an \"authenticated=true\" cookie. An attacker may simply create this cookie in order to bypass the authentication."
 ],
 "RelatedWeaknesses": {
  "RelatedWeakness": [
   {
    "Nature": "ChildOf",
    "CWEID": 668,
    "ViewID": 1000,
    "ChainID": 0,
    "Ordinal": "Primary"
   }
  ]
 },
 "WeaknessOrdinalities": {
  "WeaknessOrdinality": null
 },
 "ApplicablePlatforms": {
  "Language": [
   {
    "Name": "",
    "Class": "Not Language-Specific",
    "Prevalence": "Undetermined"
   }
  ],
  "OperatingSystem": null,
  "Architecture": null,
  "Technology": [
   {
    "Name": "Web Server",
    "Class": "",
    "Prevalence": "Often"
   }
  ]
 },
 "BackgroundDetails": {
  "BackgroundDetail": null
 },
 "AlternateTerms": {
  "AlternateTerm": null
 },
 "ModesOfIntroduction": {
  "Introduction": [
   {
    "Phase": "Architecture and Design",
    "Note": null
   },
   {
    "Phase": "Implementation",
    "Note": null
   }
  ]
 },
 "ExploitationFactors": {
  "ExploitationFactor": null
 },
 "LikelihoodOfExploit": "High",
 "CommonConsequences": {
  "Consequence": [
   {
    "Scope": [
     "Access Control"
    ],
    "Impact": [
     "Bypass Protection Mechanism",
     "Gain Privileges or Assume Identity"
    ],
    "Likelihood": "",
    "Note": null,
    "ConsequenceID": ""
   },
   {
    "Scope": [
     "Confidentiality"
    ],
    "Impact": [
     "Read Application Data"
    ],
    "Likelihood": "",
    "Note": null,
    "ConsequenceID": ""
   },
   {
    "Scope": [
     "Availability"
    ],
    "Impact": [
     "DoS: Crash, Exit, or Restart"
    ],
    "Likelihood": "",
    "Note": null,
    "ConsequenceID": ""
   }
  ]
 },
 "DetectionMethods": {
  "DetectionMethod": [
   {
    "Method": "Automated Static Analysis",
    "Description": null,
    "Effectiveness": "High",
    "EffectivenessNotes": null,
    "DetectionMethodID": "DM-14"
   }
  ]
 },
 "PotentialMitigations": {
  "Mitigation": [
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "Attack Surface Reduction",
    "Description": [
     "Store state information and sensitive data on the server side only.",
     "Ensure that the system definitively and unambiguously keeps track of its own state and user state and has rules defined for legitimate state transitions. Do not allow any application user to affect state directly in any way other than through legitimate actions leading to state transitions.",
     "If information must be stored on the client, do not do so without encryption and integrity checking, or otherwise having a mechanism on the server side to catch tampering. Use a message authentication code (MAC) algorithm, such as Hash Message Authentication Code (HMAC) [REF-529]. Apply this against the state or sensitive data that has to be exposed, which can guarantee the integrity of the data - i.e., that the data has not been modified. Ensure that a strong hash function is used (CWE-328)."
    ],
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-14"
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "Libraries or Frameworks",
    "Description": [
     "Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid [REF-1482].",
     "With a stateless protocol such as HTTP, use some frameworks can maintain the state for you.",
     "Examples include ASP.NET View State and the OWASP ESAPI Session Management feature.",
     "Be careful of language features that provide state support, since these might be provided as a convenience to the programmer and may not be considering security."
    ],
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-4"
   },
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-15"
   },
   {
    "Phase": [
     "Operation",
     "Implementation"
    ],
    "Strategy": "Environment Hardening",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": "MIT-16"
   },
   {
    "Phase": [
     "Testing"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Testing"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Testing"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   }
  ]
 },
 "DemonstrativeExamples": {
  "DemonstrativeExample": [
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "Cookie[] cookies = request.getCookies();for (int i =0; i\u003c cookies.length; i++) {}"
     ],
     "Language": "Java",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": ""
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "String rName = request.getParameter(\"reportName\");File rFile = new File(\"/usr/local/apfr/reports/\" + rName);...rFile.delete();"
     ],
     "Language": "Java",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": "DX-65"
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "fis = new FileInputStream(cfg.getProperty(\"sub\")+\".txt\");amt = fis.read(arr);out.println(arr);"
     ],
     "Language": "Java",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": "DX-66"
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "#define DIR \"/restricted/directory\"\n                     char cmd[500];sprintf(cmd, \"ls -l %480s\", DIR);\n                     \n                     \n                     RaisePrivileges(...);system(cmd);DropPrivileges(...);...",
      "\n                     \n                     \n                     \n                     \n                     \n                     \n                  "
     ],
     "Language": "C",
     "Nature": "Attack"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": "DX-67"
   },
   {
    "TitleText": "",
    "IntroText": null,
    "BodyText": null,
    "ExampleCode": {
     "Items": [
      "$ENV{\"HOMEDIR\"} = \"/home/mydir/public/\";my $stream = AcceptUntrustedInputStream();while (\u003c$stream\u003e) {}"
     ],
     "Language": "Perl",
     "Nature": "Bad"
    },
    "References": {
     "Reference": null
    },
    "DemonstrativeExampleID": ""
   }
  ]
 },
 "ObservedExamples": {
  "ObservedExample": [
   {
    "Reference": "CVE-2005-2428",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2005-2428"
   },
   {
    "Reference": "CVE-2008-0306",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-0306"
   },
   {
    "Reference": "CVE-1999-0073",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-1999-0073"
   },
   {
    "Reference": "CVE-2007-4432",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2007-4432"
   },
   {
    "Reference": "CVE-2006-7191",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2006-7191"
   },
   {
    "Reference": "CVE-2008-5738",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-5738"
   },
   {
    "Reference": "CVE-2008-5642",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-5642"
   },
   {
    "Reference": "CVE-2008-5125",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-5125"
   },
   {
    "Reference": "CVE-2008-5065",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-5065"
   },
   {
    "Reference": "CVE-2008-4752",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-4752"
   },
   {
    "Reference": "CVE-2000-0102",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2000-0102"
   },
   {
    "Reference": "CVE-2000-0253",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2000-0253"
   },
   {
    "Reference": "CVE-2008-1319",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2008-1319"
   }
  ]
 },
 "FunctionalAreas": {
  "FunctionalArea": null
 },
 "AffectedResources": {
  "AffectedResource": null
 },
 "TaxonomyMappings": {
  "TaxonomyMapping": [
   {
    "EntryID": "SFP23",
    "EntryName": "Exposed Data",
    "MappingFit": "",
    "TaxonomyName": "Software Fault Patterns"
   }
  ]
 },
 "RelatedAttackPatterns": {
  "RelatedAttackPattern": [
   {
    "CAPECID": 21
   },
   {
    "CAPECID": 31
   }
  ]
 },
 "References": {
  "Reference": [
   {
    "ExternalReferenceID": "REF-528",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-529",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-44",
    "Section": "\"Sin 4: Use of Magic URLs, Predictable Cookies, and Hidden Form\n                  Fields.\" Page 75"
   },
   {
    "ExternalReferenceID": "REF-1482",
    "Section": ""
   }
  ]
 },
 "MappingNotes": {
  "Usage": "Allowed-with-Review",
  "Rationale": null,
  "Comments": null,
  "Reasons": {
   "Reason": [
    {
     "Type": "Abstraction"
    }
   ]
  },
  "Suggestions": {
   "Suggestion": null
  }
 },
 "Notes": {
  "Note": null
 },
 "ContentHistory": {
  "Submission": {
   "SubmissionName": "Evgeny Lebanidze",
   "SubmissionOrganization": "Cigital",
   "SubmissionDate": "2008-01-30T00:00:00Z",
   "SubmissionVersion": "Draft 8",
   "SubmissionReleaseDate": "2008-01-30T00:00:00Z",
   "SubmissionComment": ""
  },
  "Modification": [
   {
    "ModificationName": "Sean Eidemiller",
    "ModificationOrganization": "Cigital",
    "ModificationDate": "2008-07-01T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "added/updated demonstrative examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2008-09-08T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Common_Consequences, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2008-10-14T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Description"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-01-12T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Applicable_Platforms, Common_Consequences, Demonstrative_Examples, Description, Name, Observed_Examples, Potential_Mitigations, References, Relationships, Relevant_Properties, Type"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-03-10T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2009-07-27T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Related_Attack_Patterns"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2010-02-16T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2010-06-21T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2011-06-01T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Common_Consequences"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2012-05-11T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples, Potential_Mitigations, References, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2012-10-30T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2014-02-18T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2014-07-30T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships, Taxonomy_Mappings"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2017-01-19T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Related_Attack_Patterns, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2017-11-08T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Applicable_Platforms, Demonstrative_Examples, Enabling_Factors_for_Exploitation, Modes_of_Introduction, References, Relationships, Relevant_Properties"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2020-02-24T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2020-06-25T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2021-03-15T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Demonstrative_Examples"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2021-10-28T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2023-01-31T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Description, Potential_Mitigations"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2023-04-27T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Detection_Factors, Potential_Mitigations, References, Relationships"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2023-06-29T00:00:00Z",
    "ModificationVersion": "",
    "ModificationReleaseDate": "0001-01-01T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Mapping_Notes"
   },
   {
    "ModificationName": "CWE Content Team",
    "ModificationOrganization": "MITRE",
    "ModificationDate": "2025-09-09T00:00:00Z",
    "ModificationVersion": "4.18",
    "ModificationReleaseDate": "2025-09-09T00:00:00Z",
    "ModificationImportance": "",
    "ModificationComment": "updated Potential_Mitigations, References"
   }
  ],
  "Contribution": null,
  "PreviousEntryName": [
   {
    "Value": "Insufficient Management of User State",
    "Date": "2008-04-11T00:00:00Z",
    "Version": ""
   },
   {
    "Value": "External Control of User State Data",
    "Date": "2009-01-12T00:00:00Z",
    "Version": ""
   }
  ]
 },
 "ID": 642,
 "Name": "External Control of Critical State Data",
 "Abstraction": "Class",
 "Structure": "Simple",
 "Status": "Draft",
 "Diagram": ""
}