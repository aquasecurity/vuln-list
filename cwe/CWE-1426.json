{
 "Description": "The product invokes a generative AI/ML\n\t\t\tcomponent whose behaviors and outputs cannot be directly\n\t\t\tcontrolled, but the product does not validate or\n\t\t\tinsufficiently validates the outputs to ensure that they\n\t\t\talign with the intended security, content, or privacy\n\t\t\tpolicy.",
 "ExtendedDescription": null,
 "RelatedWeaknesses": {
  "RelatedWeakness": [
   {
    "Nature": "ChildOf",
    "CWEID": 707,
    "ViewID": 1000,
    "ChainID": 0,
    "Ordinal": "Primary"
   }
  ]
 },
 "WeaknessOrdinalities": {
  "WeaknessOrdinality": null
 },
 "ApplicablePlatforms": {
  "Language": [
   {
    "Name": "",
    "Class": "Not Language-Specific",
    "Prevalence": "Undetermined"
   }
  ],
  "OperatingSystem": null,
  "Architecture": [
   {
    "Name": "",
    "Class": "Not Architecture-Specific",
    "Prevalence": "Undetermined"
   }
  ],
  "Technology": [
   {
    "Name": "AI/ML",
    "Class": "",
    "Prevalence": "Undetermined"
   },
   {
    "Name": "",
    "Class": "Not Technology-Specific",
    "Prevalence": "Undetermined"
   }
  ]
 },
 "BackgroundDetails": {
  "BackgroundDetail": null
 },
 "AlternateTerms": {
  "AlternateTerm": null
 },
 "ModesOfIntroduction": {
  "Introduction": [
   {
    "Phase": "Architecture and Design",
    "Note": [
     "Developers may rely heavily on protection mechanisms such as\ninput filtering and model alignment, assuming they are more effective\nthan they actually are."
    ]
   },
   {
    "Phase": "Implementation",
    "Note": [
     "Developers may rely heavily on protection mechanisms such as\ninput filtering and model alignment, assuming they are more effective\nthan they actually are."
    ]
   }
  ]
 },
 "ExploitationFactors": {
  "ExploitationFactor": null
 },
 "LikelihoodOfExploit": "",
 "CommonConsequences": {
  "Consequence": [
   {
    "Scope": [
     "Integrity"
    ],
    "Impact": [
     "Execute Unauthorized Code or Commands",
     "Varies by Context"
    ],
    "Likelihood": "",
    "Note": [
     "In an agent-oriented setting,\n\t\t\t\t\toutput could be used to cause unpredictable agent\n\t\t\t\t\tinvocation, i.e., to control or influence agents\n\t\t\t\t\tthat might be invoked from the output.  The impact\n\t\t\t\t\tvaries depending on the access that is granted to\n\t\t\t\t\tthe tools, such as creating a database or writing\n\t\t\t\t\tfiles."
    ],
    "ConsequenceID": ""
   }
  ]
 },
 "DetectionMethods": {
  "DetectionMethod": [
   {
    "Method": "Dynamic Analysis with Manual Results Interpretation",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Dynamic Analysis with Automated Results Interpretation",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   },
   {
    "Method": "Architecture or Design Review",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "DetectionMethodID": ""
   }
  ]
 },
 "PotentialMitigations": {
  "Mitigation": [
   {
    "Phase": [
     "Architecture and Design"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Operation"
    ],
    "Strategy": "",
    "Description": null,
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Operation"
    ],
    "Strategy": "",
    "Description": [
     "Use components that operate\n\t\t\t\t\texternally to the system to monitor the output and\n\t\t\t\t\tact as a moderator. These components are called\n\t\t\t\t\tdifferent terms, such as supervisors or\n\t\t\t\t\tguardrails."
    ],
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   },
   {
    "Phase": [
     "Build and Compilation"
    ],
    "Strategy": "",
    "Description": [
     "During model training, use an appropriate variety of good\n\t\t\t\t  and bad examples to guide preferred outputs."
    ],
    "Effectiveness": "",
    "EffectivenessNotes": null,
    "MitigationID": ""
   }
  ]
 },
 "DemonstrativeExamples": {
  "DemonstrativeExample": null
 },
 "ObservedExamples": {
  "ObservedExample": [
   {
    "Reference": "CVE-2024-3402",
    "Description": null,
    "Link": "https://www.cve.org/CVERecord?id=CVE-2024-3402"
   }
  ]
 },
 "FunctionalAreas": {
  "FunctionalArea": null
 },
 "AffectedResources": {
  "AffectedResource": null
 },
 "TaxonomyMappings": {
  "TaxonomyMapping": null
 },
 "RelatedAttackPatterns": {
  "RelatedAttackPattern": null
 },
 "References": {
  "Reference": [
   {
    "ExternalReferenceID": "REF-1441",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-1442",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-1443",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-1444",
    "Section": ""
   },
   {
    "ExternalReferenceID": "REF-1445",
    "Section": ""
   }
  ]
 },
 "MappingNotes": {
  "Usage": "Discouraged",
  "Rationale": null,
  "Comments": [
   "This CWE entry is only related to \"validation\" of output and might be used mistakenly for other kinds of output-related weaknesses. Careful attention should be paid to whether this CWE should be used for vulnerabilities related to \"prompt injection,\" which is an attack that works against many different weaknesses. See Maintenance Notes and Research Gaps. Analysts should closely investigate the root cause to ensure it is not ultimately due to other well-known weaknesses. The following suggestions are not comprehensive."
  ],
  "Reasons": {
   "Reason": [
    {
     "Type": "Potential Major Changes"
    },
    {
     "Type": "Frequent Misinterpretation"
    }
   ]
  },
  "Suggestions": {
   "Suggestion": [
    {
     "CWEID": 77,
     "Comment": "Command Injection. Use this CWE for most cases of 'prompt injection' attacks in which additional prompts are added to input to, or output from, the model. If OS command injection, consider CWE-78."
    },
    {
     "CWEID": 94,
     "Comment": "Code Injection. Use this CWE for cases in which output from genAI components is directly fed into components that parse and execute code."
    },
    {
     "CWEID": 116,
     "Comment": "Improper Encoding or Escaping of Output. Use this CWE when the product is expected to encode or escape genAI outputs."
    }
   ]
  }
 },
 "Notes": {
  "Note": [
   {
    "Items": null,
    "Type": "Research Gap"
   },
   {
    "Items": null,
    "Type": "Maintenance"
   }
  ]
 },
 "ContentHistory": {
  "Submission": {
   "SubmissionName": "Members of the CWE AI WG",
   "SubmissionOrganization": "CWE Artificial Intelligence (AI) Working Group (WG)",
   "SubmissionDate": "2024-07-02T00:00:00Z",
   "SubmissionVersion": "4.15",
   "SubmissionReleaseDate": "2024-07-16T00:00:00Z",
   "SubmissionComment": ""
  },
  "Modification": null,
  "Contribution": null,
  "PreviousEntryName": null
 },
 "ID": 1426,
 "Name": "Improper Validation of Generative AI Output",
 "Abstraction": "Base",
 "Structure": "Simple",
 "Status": "Incomplete",
 "Diagram": ""
}