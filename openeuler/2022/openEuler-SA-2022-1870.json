{
  "Title": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS",
  "Type": "Security Advisory",
  "Publisher": {
    "ContactDetails": "openeuler-security@openeuler.org",
    "IssuingAuthority": "openEuler security committee"
  },
  "Tracking": {
    "ID": "openEuler-SA-2022-1870",
    "Status": "Final",
    "Version": "1.0",
    "InitialReleaseDate": "2022-08-26",
    "CurrentReleaseDate": "2022-08-26",
    "Generator": {
      "Engine": "openEuler SA Tool V1.0",
      "Date": "2022-08-26"
    },
    "RevisionHistory": [
      {
        "Number": "1.0",
        "Date": "2022-08-26",
        "Description": "Initial"
      }
    ]
  },
  "Notes": [
    {
      "Text": "grafana security update",
      "Title": "Synopsis",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS.",
      "Title": "Summary",
      "Type": "General"
    },
    {
      "Text": "Grafana is an open source, feature rich metrics dashboard and graph editor for Graphite, InfluxDB \u0026 OpenTSDB.\n\nSecurity Fix(es):\n\nGrafana is an open-source platform for monitoring and observability. In versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization to log into a Grafana instance via a configured OAuth IdP which provides a login name to take over the account of another user in that Grafana instance. This can occur when the malicious user is authorized to log in to Grafana via OAuth, the malicious user's external user id is not already associated with an account in Grafana, the malicious user's email address is not already associated with an account in Grafana, and the malicious user knows the Grafana username of the target user. If these conditions are met, the malicious user can set their username in the OAuth provider to that of the target user, then go through the OAuth flow to log in to Grafana. Due to the way that external and internal user accounts are linked together during login, if the conditions above are all met then the malicious user will be able to log in to the target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana instance, or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.(CVE-2022-31107)",
      "Title": "Description",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS.\n\nopenEuler Security has rated this update as having a security impact of high. A Common Vunlnerability Scoring System(CVSS)base score,which gives a detailed severity rating, is available for each vulnerability from the CVElink(s) in the References section.",
      "Title": "Topic",
      "Type": "General"
    },
    {
      "Text": "High",
      "Title": "Severity",
      "Type": "General"
    },
    {
      "Text": "grafana",
      "Title": "Affected Component",
      "Type": "General"
    }
  ],
  "ProductTree": {
    "Branches": [
      {
        "Type": "Product Name",
        "Name": "openEuler",
        "Productions": [
          {
            "ProductID": "openEuler-20.03-LTS-SP1",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "openEuler-20.03-LTS-SP1"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "openEuler-20.03-LTS-SP3"
          },
          {
            "ProductID": "openEuler-22.03-LTS",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "openEuler-22.03-LTS"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "aarch64",
        "Productions": [
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.15-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.15-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.15-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.15-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "grafana-7.5.15-3.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "grafana-debuginfo-7.5.15-3.oe2203.aarch64.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "src",
        "Productions": [
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.15-3.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.15-3.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "grafana-7.5.15-3.oe2203.src.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "x86_64",
        "Productions": [
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.15-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.15-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.15-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.15-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "grafana-7.5.15-3.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.15-3",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "grafana-debuginfo-7.5.15-3.oe2203.x86_64.rpm"
          }
        ]
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1870"
    },
    {
      "URL": "https://www.openeuler.org/en/security/cve/detail.html?id=CVE-2022-31107"
    },
    {
      "URL": "https://nvd.nist.gov/vuln/detail/CVE-2022-31107"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-31107",
      "Note": "Grafana is an open-source platform for monitoring and observability. In versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization to log into a Grafana instance via a configured OAuth IdP which provides a login name to take over the account of another user in that Grafana instance. This can occur when the malicious user is authorized to log in to Grafana via OAuth, the malicious user s external user id is not already associated with an account in Grafana, the malicious user s email address is not already associated with an account in Grafana, and the malicious user knows the Grafana username of the target user. If these conditions are met, the malicious user can set their username in the OAuth provider to that of the target user, then go through the OAuth flow to log in to Grafana. Due to the way that external and internal user accounts are linked together during login, if the conditions above are all met then the malicious user will be able to log in to the target user s Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana instance, or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.",
      "ReleaseDate": "2022-08-26",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-20.03-LTS-SP1",
            "openEuler-20.03-LTS-SP3",
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.5",
        "Vector": "AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "grafana security update",
        "Date": "2022-08-26",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1870"
      }
    }
  ]
}