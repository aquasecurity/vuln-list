{
  "Title": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3",
  "Type": "Security Advisory",
  "Publisher": {
    "ContactDetails": "openeuler-security@openeuler.org",
    "IssuingAuthority": "openEuler security committee"
  },
  "Tracking": {
    "ID": "openEuler-SA-2022-1531",
    "Status": "Final",
    "Version": "1.0",
    "InitialReleaseDate": "2022-02-19",
    "CurrentReleaseDate": "2022-02-19",
    "Generator": {
      "Engine": "openEuler SA Tool V1.0",
      "Date": "2022-02-19"
    },
    "RevisionHistory": [
      {
        "Number": "1.0",
        "Date": "2022-02-19",
        "Description": "Initial"
      }
    ]
  },
  "Notes": [
    {
      "Text": "grafana security update",
      "Title": "Synopsis",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3.",
      "Title": "Summary",
      "Type": "General"
    },
    {
      "Text": "Metrics dashboard and graph editor.\n\nSecurity Fix(es):\n\nGrafana is an open-source platform for monitoring and observability. In affected versions when a data source has the Forward OAuth Identity feature enabled, sending a query to that datasource with an API token (and no other user credentials) will forward the OAuth Identity of the most recently logged-in user. This can allow API token holders to retrieve data for which they may not have intended access. This attack relies on the Grafana instance having data sources that support the Forward OAuth Identity feature, the Grafana instance having a data source with the Forward OAuth Identity feature toggled on, the Grafana instance having OAuth enabled, and the Grafana instance having usable API keys. This issue has been patched in versions 7.5.13 and 8.3.4.(CVE-2022-21673)",
      "Title": "Description",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3.\n\nopenEuler Security has rated this update as having a security impact of medium. A Common Vunlnerability Scoring System(CVSS)base score,which gives a detailed severity rating, is available for each vulnerability from the CVElink(s) in the References section.",
      "Title": "Topic",
      "Type": "General"
    },
    {
      "Text": "Medium",
      "Title": "Severity",
      "Type": "General"
    },
    {
      "Text": "grafana",
      "Title": "Affected Component",
      "Type": "General"
    }
  ],
  "ProductTree": {
    "Branches": [
      {
        "Type": "Product Name",
        "Name": "openEuler",
        "Productions": [
          {
            "ProductID": "openEuler-20.03-LTS-SP1",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "openEuler-20.03-LTS-SP1"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "openEuler-20.03-LTS-SP2"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "openEuler-20.03-LTS-SP3"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "aarch64",
        "Productions": [
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-3.oe1.aarch64.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "src",
        "Productions": [
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-3.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-3.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-3.oe1.src.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "x86_64",
        "Productions": [
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.11-3.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-3.oe1.x86_64.rpm"
          }
        ]
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1531"
    },
    {
      "URL": "https://www.openeuler.org/en/security/cve/detail.html?id=CVE-2022-21673"
    },
    {
      "URL": "https://nvd.nist.gov/vuln/detail/CVE-2022-21673"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-21673",
      "Note": "Grafana is an open-source platform for monitoring and observability. In affected versions when a data source has the Forward OAuth Identity feature enabled, sending a query to that datasource with an API token (and no other user credentials) will forward the OAuth Identity of the most recently logged-in user. This can allow API token holders to retrieve data for which they may not have intended access. This attack relies on the Grafana instance having data sources that support the Forward OAuth Identity feature, the Grafana instance having a data source with the Forward OAuth Identity feature toggled on, the Grafana instance having OAuth enabled, and the Grafana instance having usable API keys. This issue has been patched in versions 7.5.13 and 8.3.4.",
      "ReleaseDate": "2022-02-19",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "Medium"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-20.03-LTS-SP1",
            "openEuler-20.03-LTS-SP2",
            "openEuler-20.03-LTS-SP3"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "4.3",
        "Vector": "AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "grafana security update",
        "Date": "2022-02-19",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1531"
      }
    }
  ]
}