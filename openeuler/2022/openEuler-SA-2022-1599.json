{
  "Title": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3",
  "Type": "Security Advisory",
  "Publisher": {
    "ContactDetails": "openeuler-security@openeuler.org",
    "IssuingAuthority": "openEuler security committee"
  },
  "Tracking": {
    "ID": "openEuler-SA-2022-1599",
    "Status": "Final",
    "Version": "1.0",
    "InitialReleaseDate": "2022-03-26",
    "CurrentReleaseDate": "2022-03-26",
    "Generator": {
      "Engine": "openEuler SA Tool V1.0",
      "Date": "2022-03-26"
    },
    "RevisionHistory": [
      {
        "Number": "1.0",
        "Date": "2022-03-26",
        "Description": "Initial"
      }
    ]
  },
  "Notes": [
    {
      "Text": "grafana security update",
      "Title": "Synopsis",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3.",
      "Title": "Summary",
      "Type": "General"
    },
    {
      "Text": "Grafana is an open source, feature rich metrics dashboard and graph editor for Graphite, InfluxDB and OpenTSDB.\n\nSecurity Fix(es):\n\nGrafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability.(CVE-2022-21702)",
      "Title": "Description",
      "Type": "General"
    },
    {
      "Text": "An update for grafana is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP2 and openEuler-20.03-LTS-SP3.\n\nopenEuler Security has rated this update as having a security impact of medium. A Common Vunlnerability Scoring System(CVSS)base score,which gives a detailed severity rating, is available for each vulnerability from the CVElink(s) in the References section.",
      "Title": "Topic",
      "Type": "General"
    },
    {
      "Text": "Medium",
      "Title": "Severity",
      "Type": "General"
    },
    {
      "Text": "grafana",
      "Title": "Affected Component",
      "Type": "General"
    }
  ],
  "ProductTree": {
    "Branches": [
      {
        "Type": "Product Name",
        "Name": "openEuler",
        "Productions": [
          {
            "ProductID": "openEuler-20.03-LTS-SP1",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "openEuler-20.03-LTS-SP1"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "openEuler-20.03-LTS-SP2"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "openEuler-20.03-LTS-SP3"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "aarch64",
        "Productions": [
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-4.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-4.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.aarch64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-4.oe1.aarch64.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "src",
        "Productions": [
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-4.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-4.oe1.src.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-4.oe1.src.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "x86_64",
        "Productions": [
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "grafana-7.5.11-4.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP2",
            "Text": "grafana-7.5.11-4.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-7.5.11-4.oe1.x86_64.rpm"
          },
          {
            "ProductID": "grafana-debuginfo-7.5.11-4",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "grafana-debuginfo-7.5.11-4.oe1.x86_64.rpm"
          }
        ]
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1599"
    },
    {
      "URL": "https://www.openeuler.org/en/security/cve/detail.html?id=CVE-2022-21702"
    },
    {
      "URL": "https://nvd.nist.gov/vuln/detail/CVE-2022-21702"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-21702",
      "Note": "Grafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability.",
      "ReleaseDate": "2022-03-26",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "Medium"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-20.03-LTS-SP1",
            "openEuler-20.03-LTS-SP2",
            "openEuler-20.03-LTS-SP3"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "5.4",
        "Vector": "AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "grafana security update",
        "Date": "2022-03-26",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1599"
      }
    }
  ]
}