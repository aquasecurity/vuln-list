{
  "Title": "An update for fish is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS",
  "Type": "Security Advisory",
  "Publisher": {
    "ContactDetails": "openeuler-security@openeuler.org",
    "IssuingAuthority": "openEuler security committee"
  },
  "Tracking": {
    "ID": "openEuler-SA-2022-1689",
    "Status": "Final",
    "Version": "1.0",
    "InitialReleaseDate": "2022-06-02",
    "CurrentReleaseDate": "2022-06-02",
    "Generator": {
      "Engine": "openEuler SA Tool V1.0",
      "Date": "2022-06-02"
    },
    "RevisionHistory": [
      {
        "Number": "1.0",
        "Date": "2022-06-02",
        "Description": "Initial"
      }
    ]
  },
  "Notes": [
    {
      "Text": "fish security update",
      "Title": "Synopsis",
      "Type": "General"
    },
    {
      "Text": "An update for fish is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS.",
      "Title": "Summary",
      "Type": "General"
    },
    {
      "Text": "fish is a fully-equipped command line shell (like bash or zsh) that is smart and user-friendly. fish supports powerful features like syntax highlighting, autosuggestions, and tab completions that just work, with nothing to learn or configure.\n\nSecurity Fix(es):\n\nfish is a command line shell. fish version 3.1.0 through version 3.3.1 is vulnerable to arbitrary code execution. git repositories can contain per-repository configuration that change the behavior of git, including running arbitrary commands. When using the default configuration of fish, changing to a directory automatically runs `git` commands in order to display information about the current repository in the prompt. If an attacker can convince a user to change their current directory into one controlled by the attacker, such as on a shared file system or extracted archive, fish will run arbitrary commands under the attacker's control. This problem has been fixed in fish 3.4.0. Note that running git in these directories, including using the git tab completion, remains a potential trigger for this issue. As a workaround, remove the `fish_git_prompt` function from the prompt.(CVE-2022-20001)",
      "Title": "Description",
      "Type": "General"
    },
    {
      "Text": "An update for fish is now available for openEuler-20.03-LTS-SP1,openEuler-20.03-LTS-SP3 and openEuler-22.03-LTS.\n\nopenEuler Security has rated this update as having a security impact of high. A Common Vunlnerability Scoring System(CVSS)base score,which gives a detailed severity rating, is available for each vulnerability from the CVElink(s) in the References section.",
      "Title": "Topic",
      "Type": "General"
    },
    {
      "Text": "High",
      "Title": "Severity",
      "Type": "General"
    },
    {
      "Text": "fish",
      "Title": "Affected Component",
      "Type": "General"
    }
  ],
  "ProductTree": {
    "Branches": [
      {
        "Type": "Product Name",
        "Name": "openEuler",
        "Productions": [
          {
            "ProductID": "openEuler-20.03-LTS-SP1",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "openEuler-20.03-LTS-SP1"
          },
          {
            "ProductID": "openEuler-20.03-LTS-SP3",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "openEuler-20.03-LTS-SP3"
          },
          {
            "ProductID": "openEuler-22.03-LTS",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "openEuler-22.03-LTS"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "aarch64",
        "Productions": [
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-debugsource-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-debugsource-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-debuginfo-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-debuginfo-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-debugsource-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-debugsource-3.3.1-2.oe1.aarch64.rpm"
          },
          {
            "ProductID": "fish-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-3.3.1-4.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-debuginfo-3.3.1-4.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "fish-debugsource-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-debugsource-3.3.1-4.oe2203.aarch64.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "src",
        "Productions": [
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-3.3.1-2.oe1.src.rpm"
          },
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-3.3.1-2.oe1.src.rpm"
          },
          {
            "ProductID": "fish-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-3.3.1-4.oe2203.src.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "x86_64",
        "Productions": [
          {
            "ProductID": "fish-debugsource-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-debugsource-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-debuginfo-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP1",
            "Text": "fish-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-debugsource-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-debugsource-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-2",
            "CPE": "cpe:/a:openEuler:openEuler:20.03-LTS-SP3",
            "Text": "fish-debuginfo-3.3.1-2.oe1.x86_64.rpm"
          },
          {
            "ProductID": "fish-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-3.3.1-4.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "fish-debuginfo-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-debuginfo-3.3.1-4.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "fish-debugsource-3.3.1-4",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "fish-debugsource-3.3.1-4.oe2203.x86_64.rpm"
          }
        ]
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1689"
    },
    {
      "URL": "https://www.openeuler.org/en/security/cve/detail.html?id=CVE-2022-20001"
    },
    {
      "URL": "https://nvd.nist.gov/vuln/detail/CVE-2022-20001"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-20001",
      "Note": "fish is a command line shell. fish version 3.1.0 through version 3.3.1 is vulnerable to arbitrary code execution. git repositories can contain per-repository configuration that change the behavior of git, including running arbitrary commands. When using the default configuration of fish, changing to a directory automatically runs `git` commands in order to display information about the current repository in the prompt. If an attacker can convince a user to change their current directory into one controlled by the attacker, such as on a shared file system or extracted archive, fish will run arbitrary commands under the attacker s control. This problem has been fixed in fish 3.4.0. Note that running git in these directories, including using the git tab completion, remains a potential trigger for this issue. As a workaround, remove the `fish_git_prompt` function from the prompt.",
      "ReleaseDate": "2022-06-02",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-20.03-LTS-SP1",
            "openEuler-20.03-LTS-SP3",
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.8",
        "Vector": "AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "fish security update",
        "Date": "2022-06-02",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1689"
      }
    }
  ]
}