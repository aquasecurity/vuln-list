{
  "Title": "An update for mariadb is now available for openEuler-22.03-LTS",
  "Type": "Security Advisory",
  "Publisher": {
    "ContactDetails": "openeuler-security@openeuler.org",
    "IssuingAuthority": "openEuler security committee"
  },
  "Tracking": {
    "ID": "openEuler-SA-2022-1616",
    "Status": "Final",
    "Version": "1.0",
    "InitialReleaseDate": "2022-04-16",
    "CurrentReleaseDate": "2022-04-16",
    "Generator": {
      "Engine": "openEuler SA Tool V1.0",
      "Date": "2022-04-16"
    },
    "RevisionHistory": [
      {
        "Number": "1.0",
        "Date": "2022-04-16",
        "Description": "Initial"
      }
    ]
  },
  "Notes": [
    {
      "Text": "mariadb security update",
      "Title": "Synopsis",
      "Type": "General"
    },
    {
      "Text": "An update for mariadb is now available for openEuler-22.03-LTS.",
      "Title": "Summary",
      "Type": "General"
    },
    {
      "Text": "MariaDB is a community developed fork from MySQL - a multi-user, multi-threaded SQL database server. It is a client/server implementation consisting of a server daemon (mariadbd) and many different client programs and libraries. The base package contains the standard MariaDB/MySQL client programs and utilities.\n\nMariaDB turns data into structured information in a wide array of applications, ranging from banking to websites. It is an enhanced, drop-in replacement for MySQL. MariaDB is used because it is fast, scalable and robust, with a rich ecosystem of storage engines, plugins and many other tools make it very versatile for a wide variety of use cases.\n\nSecurity Fix(es):\n\nsave_window_function_values in MariaDB before 10.6.3 allows an application crash because of incorrect handling of with_window_func=True for a subquery.(CVE-2021-46658)\n\nMariaDB through 10.5.9 allows an application crash via certain long SELECT DISTINCT statements that improperly interact with storage-engine resource limitations for temporary data structures.(CVE-2021-46668)\n\nMariaDB CONNECT Storage Engine Format String Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of proper validation of a user-supplied string before using it as a format specifier. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16193.(CVE-2022-24051)\n\nMariaDB CONNECT Storage Engine Use-After-Free Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16207.(CVE-2022-24050)\n\nMariaDB CONNECT Storage Engine Stack-based Buffer Overflow Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16191.(CVE-2022-24048)",
      "Title": "Description",
      "Type": "General"
    },
    {
      "Text": "An update for mariadb is now available for openEuler-22.03-LTS.\n\nopenEuler Security has rated this update as having a security impact of high. A Common Vunlnerability Scoring System(CVSS)base score,which gives a detailed severity rating, is available for each vulnerability from the CVElink(s) in the References section.",
      "Title": "Topic",
      "Type": "General"
    },
    {
      "Text": "High",
      "Title": "Severity",
      "Type": "General"
    },
    {
      "Text": "mariadb",
      "Title": "Affected Component",
      "Type": "General"
    }
  ],
  "ProductTree": {
    "Branches": [
      {
        "Type": "Product Name",
        "Name": "openEuler",
        "Productions": [
          {
            "ProductID": "openEuler-22.03-LTS",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "openEuler-22.03-LTS"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "aarch64",
        "Productions": [
          {
            "ProductID": "mariadb-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-config-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-config-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-common-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-common-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-embedded-devel-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-embedded-devel-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-test-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-test-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-server-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-devel-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-devel-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-server-galera-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-galera-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-embedded-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-embedded-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-backup-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-backup-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-gssapi-server-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-gssapi-server-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-errmsg-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-errmsg-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-debugsource-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-debugsource-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-debuginfo-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-debuginfo-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-oqgraph-engine-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-oqgraph-engine-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-pam-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-pam-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-rocksdb-engine-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-rocksdb-engine-10.5.15-2.oe2203.aarch64.rpm"
          },
          {
            "ProductID": "mariadb-server-utils-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-utils-10.5.15-2.oe2203.aarch64.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "src",
        "Productions": [
          {
            "ProductID": "mariadb-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-10.5.15-2.oe2203.src.rpm"
          }
        ]
      },
      {
        "Type": "Package Arch",
        "Name": "x86_64",
        "Productions": [
          {
            "ProductID": "mariadb-gssapi-server-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-gssapi-server-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-common-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-common-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-backup-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-backup-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-debugsource-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-debugsource-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-debuginfo-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-debuginfo-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-devel-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-devel-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-errmsg-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-errmsg-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-embedded-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-embedded-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-oqgraph-engine-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-oqgraph-engine-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-embedded-devel-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-embedded-devel-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-config-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-config-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-server-galera-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-galera-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-server-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-test-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-test-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-pam-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-pam-10.5.15-2.oe2203.x86_64.rpm"
          },
          {
            "ProductID": "mariadb-server-utils-10.5.15-2",
            "CPE": "cpe:/a:openEuler:openEuler:22.03-LTS",
            "Text": "mariadb-server-utils-10.5.15-2.oe2203.x86_64.rpm"
          }
        ]
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
    },
    {
      "URL": "https://www.openeuler.org/en/security/cve/detail.html?id=CVE-2022-24048"
    },
    {
      "URL": "https://nvd.nist.gov/vuln/detail/CVE-2022-24048"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2021-46658",
      "Note": "save_window_function_values in MariaDB before 10.6.3 allows an application crash because of incorrect handling of with_window_func=True for a subquery.",
      "ReleaseDate": "2022-04-16",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "Medium"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "5.5",
        "Vector": "AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "mariadb security update",
        "Date": "2022-04-16",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
      }
    },
    {
      "CVE": "CVE-2021-46668",
      "Note": "MariaDB through 10.5.9 allows an application crash via certain long SELECT DISTINCT statements that improperly interact with storage-engine resource limitations for temporary data structures.",
      "ReleaseDate": "2022-04-16",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.5",
        "Vector": "AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "mariadb security update",
        "Date": "2022-04-16",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
      }
    },
    {
      "CVE": "CVE-2022-24051",
      "Note": "MariaDB CONNECT Storage Engine Format String Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of proper validation of a user-supplied string before using it as a format specifier. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16193.",
      "ReleaseDate": "2022-04-16",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.8",
        "Vector": "AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "mariadb security update",
        "Date": "2022-04-16",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
      }
    },
    {
      "CVE": "CVE-2022-24050",
      "Note": "MariaDB CONNECT Storage Engine Use-After-Free Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of validating the existence of an object prior to performing operations on the object. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16207.",
      "ReleaseDate": "2022-04-16",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.8",
        "Vector": "AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "mariadb security update",
        "Date": "2022-04-16",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
      }
    },
    {
      "CVE": "CVE-2022-24048",
      "Note": "MariaDB CONNECT Storage Engine Stack-based Buffer Overflow Privilege Escalation Vulnerability. This vulnerability allows local attackers to escalate privileges on affected installations of MariaDB. Authentication is required to exploit this vulnerability. The specific flaw exists within the processing of SQL queries. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to escalate privileges and execute arbitrary code in the context of the service account. Was ZDI-CAN-16191.",
      "ReleaseDate": "2022-04-16",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "High"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "openEuler-22.03-LTS"
          ]
        }
      ],
      "CVSSScoreSets": {
        "BaseScore": "7.8",
        "Vector": "AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "Remediations": {
        "Type": "Vendor Fix",
        "Description": "mariadb security update",
        "Date": "2022-04-16",
        "URL": "https://www.openeuler.org/en/security/safety-bulletin/detail.html?id=openEuler-SA-2022-1616"
      }
    }
  ]
}