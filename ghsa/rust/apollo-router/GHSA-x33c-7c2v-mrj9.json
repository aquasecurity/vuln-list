{
  "Severity": "HIGH",
  "UpdatedAt": "2025-11-06T15:47:07Z",
  "Package": {
    "Ecosystem": "RUST",
    "Name": "apollo-router"
  },
  "Advisory": {
    "DatabaseId": 320510,
    "Id": "GSA_kwCzR0hTQS14MzNjLTdjMnYtbXJqOc4ABOP-",
    "GhsaId": "GHSA-x33c-7c2v-mrj9",
    "References": [
      {
        "Url": "https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9"
      },
      {
        "Url": "https://github.com/apollographql/router/commit/75ca43ecb9d38423b63d09896702f9da425cc754"
      },
      {
        "Url": "https://github.com/advisories/GHSA-x33c-7c2v-mrj9"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-x33c-7c2v-mrj9"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-64173"
      }
    ],
    "Description": "# Summary\n\nA vulnerability in Apollo Router allowed for unauthenticated queries to access data that required additional access controls. Router incorrectly handled access control directives on interface types/fields and their implementing object types/fields, applying them to interface types/fields while ignoring directives on their implementing object types/fields when all implementations had the same requirements.\n\n## Details\n\nApollo Federation allows users to specify access control directives ([`@authenticated`, `@requiresScopes`, and `@policy`](https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives)) to protect object and interface types and fields. However, the GraphQL specification does not define inheritance rules for directives from interfaces to their implementations. Apollo Router will enforce any directives on the interface types/fields but ignore any directives on the implementation object types/fields (as long as all implementations have the same requirements). This inconsistent enforcement behavior leads to unexpected runtime security gaps.\n\n## Who is impacted\n\nThis vulnerability impacts Apollo Router customers defining `@authenticated`, `@requiresScopes`, or `@policy` directives inconsistently on polymorphic types (i.e., object types that implement interface types).  Specifically, if the same access control directives are applied to all implementing types/fields but not on their implemented interface types/fields, they could be impacted.\n\n### Scope of Impact\n\nThis vulnerability could allow a malicious actor to craft a query that can bypass access control requirements on the object types/fields by instead querying them via implemented interface types/fields that don't have the same access control requirements.\n\n## Patches\n\nThis vulnerability has been fixed at runtime in Apollo Router. You may update Router to one of the following versions:\n\n- 1.61.12+\n- 2.8.1+\n\n## Workarounds\n\n- If you are not immediately updating Router to a patched version, you should apply any included access control requirements to *both* the appropriate interface types/fields and their implementations.\n- Customers not using Apollo Router access control features (`@authenticated`, `@requiresScopes`, or `@policy` directives) or not specifying inconsistent access control requirements on polymorphic types/fields are not affected and do not need to take action.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-11-06T15:47:05Z",
    "Severity": "HIGH",
    "Summary": "Apollo Router Affected by an Access Control Bypass on Polymorphic Types",
    "UpdatedAt": "2025-11-06T15:47:07Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.8.1"
      },
      "VulnerableVersionRange": "\u003e= 2.0.0-alpha.0, \u003c 2.8.1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "1.61.12"
      },
      "VulnerableVersionRange": "\u003c 1.61.12"
    }
  ]
}