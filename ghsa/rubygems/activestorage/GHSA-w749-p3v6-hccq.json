{
  "Severity": "CRITICAL",
  "UpdatedAt": "2022-03-08T21:25:55Z",
  "Package": {
    "Ecosystem": "RUBYGEMS",
    "Name": "activestorage"
  },
  "Advisory": {
    "DatabaseId": 12481,
    "Id": "GSA_kwCzR0hTQS13NzQ5LXAzdjYtaGNjcc0wwQ",
    "GhsaId": "GHSA-w749-p3v6-hccq",
    "References": [
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2022-21831"
      },
      {
        "Url": "https://github.com/rails/rails/commit/0a72f7d670e9aa77a0bb8584cb1411ddabb7546e"
      },
      {
        "Url": "https://groups.google.com/g/rubyonrails-security/c/n-p-W1yxatI"
      },
      {
        "Url": "https://rubysec.com/advisories/CVE-2022-21831/"
      },
      {
        "Url": "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activestorage/CVE-2022-21831.yml"
      },
      {
        "Url": "https://github.com/advisories/GHSA-w749-p3v6-hccq"
      },
      {
        "Url": "https://lists.debian.org/debian-lts-announce/2022/09/msg00002.html"
      },
      {
        "Url": "https://security.netapp.com/advisory/ntap-20221118-0001/"
      },
      {
        "Url": "https://www.debian.org/security/2023/dsa-5372"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-w749-p3v6-hccq"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2022-21831"
      }
    ],
    "Description": "The Active Storage module of Rails starting with version 5.2.0 is possibly vulnerable to code injection. This issue was patched in versions 5.2.6.3, 6.0.4.7, 6.1.4.7, and 7.0.2.3. To work around this issue, applications should implement a strict allow-list on accepted transformation methods or arguments.  Additionally, a strict ImageMagick security policy will help mitigate this issue.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2022-03-08T21:25:54Z",
    "Severity": "CRITICAL",
    "Summary": "Possible code injection vulnerability in Rails / Active Storage",
    "UpdatedAt": "2023-03-22T05:03:30Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 9.8,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "7.0.2.3"
      },
      "VulnerableVersionRange": "\u003e= 7.0.0, \u003c= 7.0.2.2"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "6.1.4.7"
      },
      "VulnerableVersionRange": "\u003e= 6.1.0, \u003c= 6.1.4.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "6.0.4.7"
      },
      "VulnerableVersionRange": "\u003e= 6.0.0, \u003c= 6.0.4.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "5.2.6.3"
      },
      "VulnerableVersionRange": "\u003e= 5.2.0, \u003c= 5.2.6.2"
    }
  ]
}