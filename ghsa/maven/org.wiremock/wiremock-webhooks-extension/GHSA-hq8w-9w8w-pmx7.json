{
  "Severity": "MODERATE",
  "UpdatedAt": "2023-09-06T20:51:44Z",
  "Package": {
    "Ecosystem": "MAVEN",
    "Name": "org.wiremock:wiremock-webhooks-extension"
  },
  "Advisory": {
    "DatabaseId": 220130,
    "Id": "GSA_kwCzR0hTQS1ocTh3LTl3OHctcG14N84AA1vi",
    "GhsaId": "GHSA-hq8w-9w8w-pmx7",
    "References": [
      {
        "Url": "https://github.com/wiremock/wiremock/security/advisories/GHSA-hq8w-9w8w-pmx7"
      },
      {
        "Url": "https://github.com/wiremock/wiremock/releases/tag/2.35.1"
      },
      {
        "Url": "https://github.com/wiremock/wiremock/releases/tag/3.0.3"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2023-41327"
      },
      {
        "Url": "https://github.com/wiremock/wiremock/releases/tag/3.0.0-beta-15"
      },
      {
        "Url": "https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hq8w-9w8w-pmx7"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hq8w-9w8w-pmx7"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2023-41327"
      }
    ],
    "Description": "### Impact\n\nWireMock can be configured to only permit proxying (and therefore recording) to certain addresses. This is achieved via a list of allowed address rules and a list of denied address rules, where the allowed list is evaluated first. [Documentation](https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses). \n\nUntil WireMock Webhooks Extension [3.0.0-beta-15](https://github.com/wiremock/wiremock/releases/tag/3.0.0-beta-15), the filtering of target addresses from the proxy mode DID NOT work for Webhooks, so the users were potentially vulnerable regardless of the `limitProxyTargets` settings. \n\nVia the WireMock webhooks configuration, POST requests from a webhook might be forwarded to an arbitrary service reachable from WireMockâ€™s instance. For example, If someone is running the WireMock docker Container inside a private cluster, they can trigger internal POST requests against unsecured APIs or even against secure ones by passing a token, discovered using another exploit, via authentication headers.\n\n### Affected  components\n\n- WireMock Webhooks Extension 2.x versions until 2.35.1 (security patch)\n- WireMock 3.x version until 3.0.3 (security patch)\n- All versions of WireMock Studio (discontinued). This distribution bundles the WireMock Webhooks Extension and activates it by default\n\n### Patches and Mitigation\n\n- For WireMock 2.x and 3.x - upgrade to the versions with the security patches\n- Setup network restrictions similarly to https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses \n- For WireMock Studio: Stop using discontinued WireMock Studio, migrate to other distributions. The vendor of WireMock Studio recommends migration to [WireMock Cloud](https://www.wiremock.io/product)\n\nNOTE: It was confirmed that [WireMock Cloud](https://www.wiremock.io/product) does not expose sensitive internal APIs and hence not vulnerable to the issue. No action is needed if you use this SaaS distribution.\n\n### Workarounds\n\n- Use external firewall rules to define the list of permitted destinations\n\n### References\n\n- CVE-2023-39967\n- [Preventing proxying to and recording from specific target addresses](https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses)\n\n### Credits\n\n- @W0rty for reporting CVE-2023-39967 in WireMock Studio\n- WireMock Inc. team for discovering similar exploits in Webhooks and the risk in the Proxy mode defaults for WireMock\n\n",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2023-09-06T20:51:42Z",
    "Severity": "MODERATE",
    "Summary": "WireMock Controlled Server Side Request Forgery vulnerability through URL",
    "UpdatedAt": "2023-11-06T05:04:47Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.6,
      "VectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.35.1"
      },
      "VulnerableVersionRange": "\u003e= 2.0.0, \u003c 2.35.1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.0.3"
      },
      "VulnerableVersionRange": "\u003e= 3.0.0, \u003c 3.0.3"
    }
  ]
}