{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-10-15T20:37:30Z",
  "Package": {
    "Ecosystem": "MAVEN",
    "Name": "org.opensearch.dataprepper.plugins:geoip-processor"
  },
  "Advisory": {
    "DatabaseId": 317324,
    "Id": "GSA_kwCzR0hTQS0yOGdnLThxcWotZmhoNc4ABNeM",
    "GhsaId": "GHSA-28gg-8qqj-fhh5",
    "References": [
      {
        "Url": "https://github.com/opensearch-project/data-prepper/security/advisories/GHSA-28gg-8qqj-fhh5"
      },
      {
        "Url": "https://github.com/opensearch-project/data-prepper/commit/fa21a601512b5193c4b5c84a5b30c6301dab0475"
      },
      {
        "Url": "https://github.com/advisories/GHSA-28gg-8qqj-fhh5"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-28gg-8qqj-fhh5"
      }
    ],
    "Description": "### Impact\n\nThe GeoIP processor and Kafka source and buffer were using the deprecated \"SSL\" protocol identifier when creating SSL contexts, potentially allowing the use of insecure SSL protocols instead of modern TLS versions.\n\nMultiple Data Prepper plugins used `SSLContext.getInstance(\"SSL\")` which could potentially allow the use of deprecated SSL protocols (SSLv2, SSLv3) that have known security vulnerabilities. While modern Java implementations typically default to secure TLS versions even with the \"SSL\" identifier, explicitly using \"TLS\" ensures that only secure TLS protocols are negotiated.\n\nThe affected components were:\n\n* GeoIP Processor: The `DBSource.initiateSSL()` method used for downloading GeoIP databases from external sources\n\n* Kafka Plugin: Both `CustomClientSslEngineFactory` and `InsecureSslEngineFactory` classes used for Kafka client connections\n\nThis could potentially allow connections to negotiate weaker SSL protocols instead of enforcing modern TLS versions, reducing the security of data transmission.\n\n### Patches\n\nData Prepper 2.12.2 contains a fix for this issue.\n\n### Workarounds\n\nIf upgrading is not immediately possible:\n\n1. Ensure your Java runtime is configured to disable deprecated SSL protocols\n2. Use network-level controls to enforce TLS-only connections\n3. Use external tools to verify that deprecated SSL protocols are not allowed.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-10-15T20:37:29Z",
    "Severity": "MODERATE",
    "Summary": "OpenSearch Data Prepper uses deprecated SSL protocol identifier",
    "UpdatedAt": "2025-10-15T20:37:30Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.8,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.12.2"
      },
      "VulnerableVersionRange": "\u003e= 2.4.0, \u003c 2.12.2"
    }
  ]
}