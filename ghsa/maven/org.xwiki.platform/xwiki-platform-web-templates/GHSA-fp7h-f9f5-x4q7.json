{
  "Severity": "CRITICAL",
  "UpdatedAt": "2023-06-20T16:44:35Z",
  "Package": {
    "Ecosystem": "MAVEN",
    "Name": "org.xwiki.platform:xwiki-platform-web-templates"
  },
  "Advisory": {
    "DatabaseId": 212837,
    "Id": "GSA_kwCzR0hTQS1mcDdoLWY5ZjUteDRxN84AAz9l",
    "GhsaId": "GHSA-fp7h-f9f5-x4q7",
    "References": [
      {
        "Url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-fp7h-f9f5-x4q7"
      },
      {
        "Url": "https://github.com/xwiki/xwiki-platform/commit/53e8292a31ec70fba5e1d705a4ac443658b9e6df"
      },
      {
        "Url": "https://jira.xwiki.org/browse/XWIKI-20290"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2023-34464"
      },
      {
        "Url": "https://github.com/advisories/GHSA-fp7h-f9f5-x4q7"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-fp7h-f9f5-x4q7"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2023-34464"
      }
    ],
    "Description": "### Impact\n\nAny user who can edit a document in a wiki like the user profile can create a stored XSS attack by putting plain HTML code into that document and then tricking another user to visit that document with the `displaycontent` or `rendercontent` template and plain output syntax. For example, edit any document with the wiki editor and set the content to `\u003cscript\u003ealert(1)\u003c/script\u003e` , save and then append the parameters `?viewer=displaycontent\u0026sheet=\u0026outputSyntax=plain`. If this displays an alert, the installation is vulnerable. If a user with programming rights is tricked into visiting such a URL, arbitrary actions be performed with this user's rights, impacting the confidentiality, integrity, and availability of the whole XWiki installation.\n\n### Patches\nThis has been patched in XWiki 14.4.8, 14.10.5 and 15.1RC1 by setting the content type of the response to plain text when the output syntax is not an HTML syntax.\n\n### Workarounds\nThe [patch](https://github.com/xwiki/xwiki-platform/commit/53e8292a31ec70fba5e1d705a4ac443658b9e6df#diff-e332fba67335bd2202bdac144be7cd244a16cef0ccee741f9c20025a981027d5) can be manually applied to the `rendercontent.vm` template in an existing installation to patch this vulnerability without upgrading.\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-20290\n* https://github.com/xwiki/xwiki-platform/commit/53e8292a31ec70fba5e1d705a4ac443658b9e6df\n",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2023-06-20T16:44:35Z",
    "Severity": "CRITICAL",
    "Summary": "XWiki vulnerable to stored cross-site scripting via any wiki document and the displaycontent/rendercontent template",
    "UpdatedAt": "2023-11-04T05:01:39Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 9.1,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "15.1-rc-1"
      },
      "VulnerableVersionRange": "\u003e= 15.0-rc-1, \u003c 15.1-rc-1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "14.10.5"
      },
      "VulnerableVersionRange": "\u003e= 14.5, \u003c 14.10.5"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "14.4.8"
      },
      "VulnerableVersionRange": "\u003c 14.4.8"
    }
  ]
}