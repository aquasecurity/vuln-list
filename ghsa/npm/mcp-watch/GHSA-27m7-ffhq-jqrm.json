{
  "Severity": "CRITICAL",
  "UpdatedAt": "2025-12-02T00:38:15Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "mcp-watch"
  },
  "Advisory": {
    "DatabaseId": 323900,
    "Id": "GSA_kwCzR0hTQS0yN203LWZmaHEtanFybc4ABPE8",
    "GhsaId": "GHSA-27m7-ffhq-jqrm",
    "References": [
      {
        "Url": "https://github.com/kapilduraphe/mcp-watch/security/advisories/GHSA-27m7-ffhq-jqrm"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66401"
      },
      {
        "Url": "https://github.com/kapilduraphe/mcp-watch/commit/e7da78c5b4b960f8b66c254059ad9ebc544a91a6"
      },
      {
        "Url": "https://github.com/advisories/GHSA-27m7-ffhq-jqrm"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-27m7-ffhq-jqrm"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66401"
      }
    ],
    "Description": "### Summary\nThe `MCPScanner ` class contains a critical Command Injection vulnerability in the `cloneRepo `method. The application passes the user-supplied githubUrl argument directly to a system shell via execSync without sanitization. This allows an attacker to execute arbitrary commands on the host machine by appending shell metacharacters to the URL.\n\n### Details\nThe vulnerability exists in the src/scanner/MCPScanner.ts file within the cloneRepo method.\n\n[https://github.com/kapilduraphe/mcp-watch/blob/0fca7228bd313ae5aa938d61311377e88ce6e682/src/scanner/McpScanner.ts#L181](https://github.com/kapilduraphe/mcp-watch/blob/0fca7228bd313ae5aa938d61311377e88ce6e682/src/scanner/McpScanner.ts#L181)\n\nThe code uses child_process.execSync to execute a git clone command:\n\nBecause execSync spawns a shell (defaulting to `/bin/sh` on Unix or` cmd.exe` on Windows), any shell metacharacters present in the url argument will be interpreted by the shell. The application does not validate that the url is a valid Git URL, nor does it sanitize input for shell metacharacters.\n\n### PoC\nInstall the package or clone the repository.\n\nRun the scanner using the CLI (or invoke scanRepository programmatically).\n\nProvide a malicious URL containing a command separator (e.g., ;, \u0026, or |) and a system command.\npayload : `npm run scan:github \"https://github.com/kapilduraphe/mcp-watch \u0026 calc.exe\"`\n\n\u003cimg width=\"1918\" height=\"1046\" alt=\"image\" src=\"https://github.com/user-attachments/assets/021c1dfa-3f87-483c-aecb-6939bcf9c925\" /\u003e\n\n\n\n### Impact\nSeverity: **Critical**\n\n**CVSS Score**: 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)\nDescription: This vulnerability allows an attacker to execute arbitrary code on the machine running the scanner.\n\nIf run by a developer locally, it compromises their workstation.\n\nIf deployed as a hosted scanning service, it grants the attacker full control over the server (RCE), leading to potential data exfiltration, service disruption, or further lateral movement within the infrastructure.\n\n**Context Dependent Risk:**\n\nLocal CLI : If you run this tool locally on your own machine, you are \"hacking yourself.\" The risk is limited unless you copy-paste a malicious URL sent by someone else (e.g., \"Hey, check this repo scan: npm run scan \"https://git./..; rm -rf /\").\n\n**Web Service / CI Pipeline (Critical Risk)**: If this scanner is deployed as a web service (e.g., \"Paste your repo URL to scan\"), an attacker can take full control of the server immediately.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-02T00:38:14Z",
    "Severity": "CRITICAL",
    "Summary": "MCP Watch has a Critical Command Injection in cloneRepo allows Remote Code Execution (RCE) via malicious URL",
    "UpdatedAt": "2025-12-02T00:38:15Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 9.8,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 0.1.2"
    }
  ]
}