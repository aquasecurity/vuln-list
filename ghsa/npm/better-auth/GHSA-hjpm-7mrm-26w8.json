{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-02-24T18:27:57Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "better-auth"
  },
  "Advisory": {
    "DatabaseId": 281539,
    "Id": "GSA_kwCzR0hTQS1oanBtLTdtcm0tMjZ3OM4ABEvD",
    "GhsaId": "GHSA-hjpm-7mrm-26w8",
    "References": [
      {
        "Url": "https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723"
      },
      {
        "Url": "https://github.com/better-auth/better-auth/security/advisories/GHSA-hjpm-7mrm-26w8"
      },
      {
        "Url": "https://github.com/better-auth/better-auth/commit/24659aefc35a536b95ea4e5347e52c8803910153"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-27143"
      },
      {
        "Url": "https://github.com/better-auth/better-auth/commit/b381cac7aafd6aa53ef78b6ab771ebfa24643c80"
      },
      {
        "Url": "https://github.com/better-auth/better-auth/releases/tag/v1.1.21"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hjpm-7mrm-26w8"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hjpm-7mrm-26w8"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-27143"
      }
    ],
    "Description": "### Summary\nThe application is vulnerable to an open redirect due to improper validation of the callbackURL parameter in the email verification endpoint and any other endpoint that accepts callback url. While the server blocks fully qualified URLs (e.g., https://evil.com), it incorrectly allows scheme-less URLs (e.g., //malicious-site.com). This results in the browser interpreting the URL as https://malicious-site.com, leading to unintended redirection.\n\nbypass for : https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723\n\n### Affected Versions\nAll versions prior to 1.1.19\n\n### Details\nThe application’s email verification endpoint (/auth/verify-email) accepts a callbackURL parameter intended to redirect users after successful email verification. While the server correctly blocks fully qualified external URLs (e.g., https://evil.com), it improperly allows scheme-less URLs (e.g., //malicious-site.com). This issue occurs because browsers interpret //malicious-site.com as https://malicious-site.com, leading to an open redirect vulnerability.\n\nAn attacker can exploit this flaw by crafting a malicious verification link and tricking users into clicking it. Upon successful email verification, the user will be automatically redirected to the attacker's website, which can be used for phishing, malware distribution, or stealing sensitive authentication tokens.\n\n### Impact\nPhishing \u0026 Credential Theft – Attackers can redirect users to a fake login page, tricking them into entering sensitive credentials, which can then be stolen.\n\nSession Hijacking \u0026 Token Theft – If used in OAuth flows, an attacker could redirect authentication tokens to their own domain, leading to account takeover.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-02-24T18:27:55Z",
    "Severity": "MODERATE",
    "Summary": "Beter Auth has an Open Redirect via Scheme-Less Callback Parameter",
    "UpdatedAt": "2025-02-25T18:00:23Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.1.20"
      },
      "VulnerableVersionRange": "\u003c 1.1.20"
    }
  ]
}