{
  "Severity": "HIGH",
  "UpdatedAt": "2024-12-30T16:49:14Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "better-auth"
  },
  "Advisory": {
    "DatabaseId": 273727,
    "Id": "GSA_kwCzR0hTQS04amh3LTZwamotODcyM84ABC0_",
    "GhsaId": "GHSA-8jhw-6pjj-8723",
    "References": [
      {
        "Url": "https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723"
      },
      {
        "Url": "https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2024-56734"
      },
      {
        "Url": "https://github.com/advisories/GHSA-8jhw-6pjj-8723"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-8jhw-6pjj-8723"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2024-56734"
      }
    ],
    "Description": "## Summary\nAn **open redirect vulnerability** has been identified in the **verify email endpoint** of Better Auth, potentially allowing attackers to redirect users to malicious websites. This issue affects users relying on email verification links generated by the library.\n\n## Affected Versions\n- All versions prior to **v1.1.6**.\n\n## Impact\nAttackers could craft malicious email verification links that exploit the redirect functionality to send users to untrusted domains. This can result in:\n\n- **Phishing attacks** – Users may unknowingly enter sensitive information on fake login pages.\n- **Reputation damage** – Trust issues for applications using Better Auth.\n\n## Vulnerability Details\nThe verify email callback endpoint accepts a `callbackURL` parameter. Unlike other verification methods, email verification only uses JWT to verify and redirect without proper validation of the target domain. The origin checker is bypassed in this scenario because it only checks for `POST` requests. An attacker can manipulate this parameter to redirect users to arbitrary URLs controlled by the attacker.\n\n**Example Exploit:**\n```\nhttps://example.com/auth/verify-email?token=abcd1234\u0026callbackURL=https://malicious-site.com\n```\n\n## Patches\nUpgrade to Better Auth **v1.1.6** or later. This version enforces domain validation for `callbackURL` for `/verify-email` path and for all other `GET` endpoints.\n\n## Workarounds\nYou can also use hooks to pre-check URLs in your auth instance to prevent this without upgrading:\n\n```ts\nconst auth = betterAuth({\n    hooks: {\n         before: (ctx) =\u003e {\n            if (ctx.path === \"/verify-email\") {\n               const callbackURL = ctx.query.callbackURL; // Check if this is a trusted callback URL or not\n            }\n         }\n    }\n})\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2024-12-30T16:49:12Z",
    "Severity": "HIGH",
    "Summary": "Better Auth has an Open Redirect Vulnerability in Verify Email Endpoint",
    "UpdatedAt": "2024-12-30T18:45:18Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.1.6"
      },
      "VulnerableVersionRange": "\u003c 1.1.6"
    }
  ]
}