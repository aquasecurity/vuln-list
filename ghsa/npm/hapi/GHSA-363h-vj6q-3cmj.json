{
  "Severity": "MODERATE",
  "UpdatedAt": "2020-08-31T18:07:45Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "hapi"
  },
  "Advisory": {
    "DatabaseId": 2325,
    "Id": "MDE2OlNlY3VyaXR5QWR2aXNvcnlHSFNBLTM2M2gtdmo2cS0zY21q",
    "GhsaId": "GHSA-363h-vj6q-3cmj",
    "References": [
      {
        "Url": "https://github.com/spumko/hapi/pull/1766"
      },
      {
        "Url": "https://github.com/patrickkettner"
      },
      {
        "Url": "https://www.npmjs.com/advisories/12"
      },
      {
        "Url": "http://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2014-4671"
      },
      {
        "Url": "http://helpx.adobe.com/security/products/flash-player/apsb14-17.html"
      },
      {
        "Url": "http://rhn.redhat.com/errata/RHSA-2014-0860.html"
      },
      {
        "Url": "http://secunia.com/advisories/59774"
      },
      {
        "Url": "http://secunia.com/advisories/59837"
      },
      {
        "Url": "http://security.gentoo.org/glsa/glsa-201407-02.xml"
      },
      {
        "Url": "http://www.securityfocus.com/bid/68457"
      },
      {
        "Url": "http://www.securitytracker.com/id/1030533"
      },
      {
        "Url": "https://github.com/hapijs/hapi/commit/d47f57abf23bdaa84f61aed2bac94ae5f358afb7"
      },
      {
        "Url": "https://github.com/advisories/GHSA-363h-vj6q-3cmj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-363h-vj6q-3cmj"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2014-4671"
      }
    ],
    "Description": "This description taken from the pull request provided by Patrick Kettner.\n\n\n\nVersions 6.1.0 and earlier of hapi are vulnerable to a rosetta-flash attack, which can be used by attackers to send data across domains and break the browser same-origin-policy.\n\n\n\n\n\n## Recommendation\n\n- Update hapi to version 6.1.1 or later.\n\nAlternatively, a solution previously implemented by Google, Facebook, and Github is to prepend callbacks with an empty inline comment. This will cause the flash parser to break on invalid inputs and prevent the issue, and how the issue has been resolved internally in hapi.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2020-08-31T22:45:35Z",
    "Severity": "MODERATE",
    "Summary": "Rosetta-Flash JSONP Vulnerability in hapi",
    "UpdatedAt": "2023-04-14T19:20:03Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "6.1.0"
      },
      "VulnerableVersionRange": "\u003c 6.1.0"
    }
  ]
}