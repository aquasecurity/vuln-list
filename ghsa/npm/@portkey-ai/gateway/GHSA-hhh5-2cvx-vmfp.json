{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-02T01:08:38Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "@portkey-ai/gateway"
  },
  "Advisory": {
    "DatabaseId": 323907,
    "Id": "GSA_kwCzR0hTQS1oaGg1LTJjdngtdm1mcM4ABPFD",
    "GhsaId": "GHSA-hhh5-2cvx-vmfp",
    "References": [
      {
        "Url": "https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66405"
      },
      {
        "Url": "https://github.com/Portkey-AI/gateway/pull/1372"
      },
      {
        "Url": "https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hhh5-2cvx-vmfp"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hhh5-2cvx-vmfp"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66405"
      }
    ],
    "Description": "### Summary\nThe gateway determines the destination baseURL by prioritizing the value in the x-portkey-custom-host request header. The proxy route then appends the client-specified path to perform an external fetch. This can be maliciously used by users for SSRF (CWE-918) attack\n\n### Impact\nThis vulnerability can be exploited to force the server to make requests to arbitrary hosts on the internal network. This could allow an attacker to exfiltrate sensitive data, for instance, by accessing the AWS metadata service.\n\n### Patches\nThe issue is patched in 1.14.0 (https://github.com/Portkey-AI/gateway/pull/1372)\n\nThe vulnerability resides within the gateway's request processing function which handles the `x-portkey-custom-host` header. This parameter was passed directly or with insufficient validation/sanitization to an internal HTTP request function.\n\n**The fix (v1.14.0) implements a robust allow-list policy:**\n\n1. All custom host inputs are now strictly validated to ensure the resulting URI points only to trusted, expected external services.\n\n2. The implementation now explicitly blocks requests to non-routable IP addresses, loopback addresses, private networks and standard metadata endpoints.\n\n### Credit\nThis vulnerability was discovered and reported responsibly by @im-soohyun. We thank them for their adherence to coordinated vulnerability disclosure principles.\n\n### References\nhttps://cwe.mitre.org/data/definitions/918.html",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-02T01:08:37Z",
    "Severity": "MODERATE",
    "Summary": "Portkey.ai Gateway: Server-Side Request Forgery (SSRF) in Custom Host",
    "UpdatedAt": "2025-12-02T01:08:38Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.14.0"
      },
      "VulnerableVersionRange": "\u003c 1.14.0"
    }
  ]
}