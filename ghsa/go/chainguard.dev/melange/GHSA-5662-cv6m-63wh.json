{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-07-18T20:13:22Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "chainguard.dev/melange"
  },
  "Advisory": {
    "DatabaseId": 304267,
    "Id": "GSA_kwCzR0hTQS01NjYyLWN2Nm0tNjN3aM4ABKSL",
    "GhsaId": "GHSA-5662-cv6m-63wh",
    "References": [
      {
        "Url": "https://github.com/chainguard-dev/melange/security/advisories/GHSA-5662-cv6m-63wh"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-54059"
      },
      {
        "Url": "https://github.com/chainguard-dev/melange/pull/1836"
      },
      {
        "Url": "https://github.com/chainguard-dev/melange/pull/2086"
      },
      {
        "Url": "https://github.com/chainguard-dev/melange/commit/1b272db2a0bb3441553284cc56d87236b4b64c04"
      },
      {
        "Url": "https://github.com/chainguard-dev/melange/commit/e29494b4a40a91619ec1c87a09003c6d5164cea1"
      },
      {
        "Url": "https://github.com/chainguard-dev/melange/releases/tag/v0.29.5"
      },
      {
        "Url": "https://github.com/advisories/GHSA-5662-cv6m-63wh"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-5662-cv6m-63wh"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-54059"
      }
    ],
    "Description": "It was discovered that the SBOM files generated by melange in apks had file system permissions mode 666:\n```\n$ apkrane ls https://packages.wolfi.dev/os/x86_64/APKINDEX.tar.gz -P hello-wolfi --full --latest  | xargs wget -q -O  - | tar tzv 2\u003e/dev/null var/lib/db/sbom\ndrwxr-xr-x root/root         0 2025-06-23 14:17 var/lib/db/sbom\n-rw-rw-rw- root/root      3383 2025-06-23 14:17 var/lib/db/sbom/hello-wolfi-2.12.2-r1.spdx.json\n```\n\nThis issue was introduced in commit 1b272db (\"Persist workspace filesystem throughout package builds (#1836)\") ([v0.23.0](https://github.com/chainguard-dev/melange/releases/tag/v0.23.0)).\n\n### Impact\nThis potentially allows an unprivileged user to tamper with apk SBOMs on a running image, potentially confusing security scanners. An attacker could also perform a DoS under special circumstances.\n\n### Patches\nThis issue was addressed in melange in e29494b (\"fix: tighten up permissions for written SBOM files and signature tarballs (#2086)\") ([v0.29.5](https://github.com/chainguard-dev/melange/releases/tag/v0.29.5)).\n\n## Acknowledgements\n\nThanks to Cody Harris [H2O.ai](https://h2o.ai/) and Markus Boehme for independently reporting this issue.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-07-18T20:13:21Z",
    "Severity": "MODERATE",
    "Summary": "melange's world-writable permissions expose SBOM files to potential image tampering",
    "UpdatedAt": "2025-07-18T20:13:22Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.4,
      "VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.29.5"
      },
      "VulnerableVersionRange": "\u003e= 0.23.0, \u003c 0.29.5"
    }
  ]
}