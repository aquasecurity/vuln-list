{
  "Severity": "HIGH",
  "UpdatedAt": "2025-10-14T19:57:32Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/cometbft/cometbft"
  },
  "Advisory": {
    "DatabaseId": 317063,
    "Id": "GSA_kwCzR0hTQS1ocmhmLTJ2Y3ItZ2hjaM4ABNaH",
    "GhsaId": "GHSA-hrhf-2vcr-ghch",
    "References": [
      {
        "Url": "https://github.com/cometbft/cometbft/security/advisories/GHSA-hrhf-2vcr-ghch"
      },
      {
        "Url": "https://github.com/cometbft/cometbft/commit/be5677c3e58f998b7f67bb6186dd2c9b81a041a1"
      },
      {
        "Url": "https://github.com/cometbft/cometbft/commit/dcb1f265b59477be40804f7ccdc4fb30612d6a4f"
      },
      {
        "Url": "https://github.com/cometbft/cometbft/releases/tag/v0.37.16"
      },
      {
        "Url": "https://github.com/cometbft/cometbft/releases/tag/v0.38.19"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hrhf-2vcr-ghch"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hrhf-2vcr-ghch"
      }
    ],
    "Description": "Name: ASA-2025-003: Invalid BitArray handling can lead to network halt\nCriticality: High (Considerable Impact; Possible Likelihood per [ACMv1.2](https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md))\nAffected versions: `\u003c= v0.38.18`, `\u003c= v0.37.15`, and `main` development branches\nAffected users: Validators, Full nodes, Users\n\n### Description\n\nA bug was discovered in CometBFT's handling of `BitArray`'s that have a mismatch between the `BitArray`'s expected number of `Elems` for the specified number of `Bits`. Additional validation was added to prevent processing `BitArray`'s in this invalid state, as well as guards to prevent panics on `BitArray` methods if one of these invalid states is processed.\n\n### Impact\n`BitArray`'s are present in a number of messages received from peers. When handling these messages, insufficient validation was applied to prevent processing messages the aforementioned invalid state. In the worst case, nodes will gossip messages to peers in an invalid state before processing them themselves, leading to a network halt (instead of only the node receiving the malicious message crashing). \n\n### Patches\n\nThe new CometBFT releases [v0.38.19](https://github.com/cometbft/cometbft/releases/tag/v0.38.19) and [v0.37.16](https://github.com/cometbft/cometbft/releases/tag/v0.37.16) fix this issue.\n\nUnreleased code in the main branch is patched as well.\n\n### Workarounds\n\nIf a node is able to identify a malicious peer sending these payloads, they can ban the ip address using common tools like `iptables`.\n\n### Timeline\n\n* October 3, 2025, 11:26am EST: Issue reported to Cosmos Labs via an external team (via their Bug Bounty Program).\n* October 3, 2025, 11:59am EST: Issue triaged by core team and core team completes validation of issue.\n* October 6, 2025, 11:14pm EST: Issue reported to the Cosmos Bug Bounty Program (by original white hat reporter).\n* October 9, 2025, 11:15am EST: Pre-notification delivered.\n* October 10, 2025, 11:37am EST: Core team completes patch for the issue.\n* October 14, 2025, 11:00am EST: Patch made available.\n\nThis issue was reported by @whoismxuse to the Cosmos Bug Bounty Program on HackerOne on October 6, 2025. If you believe you have found a bug in the Cosmos Stack or would like to contribute to the program by reporting a bug, please see https://hackerone.com/cosmos.\n\nIf there are questions about Cosmos security efforts, please reach out to our official communication channel at [security@cosmoslabs.io](mailto:security@cosmoslabs.io).\n\nA Github Security Advisory for this issue is available in the CometBFT [repository](https://github.com/cometbft/cometbft/security/advisories/GHSA-hrhf-2vcr-ghch). For more information about CometBFT, see https://docs.cometbft.com/.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-10-14T19:57:30Z",
    "Severity": "HIGH",
    "Summary": "CometBFT's invalid BitArray handling can lead to network halt",
    "UpdatedAt": "2025-10-14T19:57:32Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.38.19"
      },
      "VulnerableVersionRange": "\u003e= 0.38.0-alpha.1, \u003c= 0.38.18"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "0.37.16"
      },
      "VulnerableVersionRange": "\u003c= 0.37.15"
    }
  ]
}