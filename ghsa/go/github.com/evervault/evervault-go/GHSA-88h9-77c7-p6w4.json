{
  "Severity": "HIGH",
  "UpdatedAt": "2025-11-12T21:45:07Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/evervault/evervault-go"
  },
  "Advisory": {
    "DatabaseId": 321503,
    "Id": "GSA_kwCzR0hTQS04OGg5LTc3YzctcDZ3NM4ABOff",
    "GhsaId": "GHSA-88h9-77c7-p6w4",
    "References": [
      {
        "Url": "https://github.com/evervault/evervault-go/security/advisories/GHSA-88h9-77c7-p6w4"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64186"
      },
      {
        "Url": "https://github.com/evervault/evervault-go/pull/48"
      },
      {
        "Url": "https://github.com/evervault/evervault-go/commit/7c824d289bba11ec0bea46a338023f5b128bbb28"
      },
      {
        "Url": "https://github.com/advisories/GHSA-88h9-77c7-p6w4"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-88h9-77c7-p6w4"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-64186"
      }
    ],
    "Description": "### Summary\n\nA vulnerability was identified in the `evervault-go` SDKâ€™s attestation verification logic that may allow incomplete documents to pass validation. This may cause the client to trust an enclave operator that does not meet expected integrity guarantees.\n\nThe exploitability of this issue is limited in Evervault-hosted environments as an attacker would require the pre-requisite ability to serve requests from specific evervault domain names, following from our ACME challenge based TLS certificate acquisition pipeline. \n\nThe vulnerability primarily affects applications which only check PCR8. Though the efficacy is also reduced for applications that check all PCR values, the impact is largely remediated by checking PCR 0, 1 and 2.\n \n\n### Patches\nThe identified issue has been addressed in version [1.3.2](https://github.com/evervault/evervault-go/pull/48) by validating attestation documents before storing in the cache, and replacing the naive equality checks with a new SatisfiedBy check.\n\n### Workarounds\nIf you are using evervault-go to attest Enclaves that are hosted outside of Evervault environments and cannot upgrade:\n\n1) Modify your application logic to fail verification if PCR8 is not explicitly present and non-empty\n2) Add custom pre-validation to reject documents that omit any required PCRs.\n\n### POC\n```\npackage evervault\nimport (\n        \"testing\"\n\n        \"github.com/evervault/evervault-go/attestation\"\n        \"github.com/stretchr/testify/assert\"\n        \"github.com/hf/nitrite\"\n)\n\n\nfunc TestVulnerableCompare(t *testing.T) {\n          assert := assert.New(t)\n          // arrange\n          expectedPCRs := []attestation.PCRs{\n                attestation.PCRs{\n                      PCR0:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001\",\n                      PCR1:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002\",\n                      PCR2:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003\",\n                      PCR8:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004\",\n                     },\n           }\n            actualDocument := nitrite.Document {}\n            actualDocument.PCRs = map[uint][]byte{\n                    10: make([]byte, 32),\n            }\n            // act\n            v := verifyPCRs(expectedPCRs, actualDocument)\n            \n            // assert\n            // Verify should not pass but it does\n            \n            assert.Equal(true, v)\n}\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-11-12T21:45:06Z",
    "Severity": "HIGH",
    "Summary": "Evervault Go SDK: Incomplete PCR Validation in Enclave Attestation for non-Evervault hosted Enclaves",
    "UpdatedAt": "2025-11-18T17:00:21Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 8.7,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.3.2"
      },
      "VulnerableVersionRange": "\u003c 1.3.2"
    }
  ]
}