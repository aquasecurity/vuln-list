{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-08-26T16:19:42Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/traPtitech/traQ"
  },
  "Advisory": {
    "DatabaseId": 308999,
    "Id": "GSA_kwCzR0hTQS0yN3I3LTNtOXgtcjUzM84ABLcH",
    "GhsaId": "GHSA-27r7-3m9x-r533",
    "References": [
      {
        "Url": "https://github.com/traPtitech/traQ/security/advisories/GHSA-27r7-3m9x-r533"
      },
      {
        "Url": "https://github.com/traPtitech/traQ/pull/2787"
      },
      {
        "Url": "https://github.com/traPtitech/traQ/commit/ce5da94f5d5a8348f9ecdc82140b6f53b3721698"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-57813"
      },
      {
        "Url": "https://github.com/traPtitech/traQ/pull/2788"
      },
      {
        "Url": "https://pkg.go.dev/vuln/GO-2025-3913"
      },
      {
        "Url": "https://github.com/advisories/GHSA-27r7-3m9x-r533"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-27r7-3m9x-r533"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-57813"
      }
    ],
    "Description": "### Impact\nA vulnerability exists where sensitive information, such as OAuth tokens, is recorded in log files when an error occurs during the execution of an SQL query.\nAn attacker could intentionally trigger an SQL error by methods such as placing a high load on the database. This could allow an attacker who has the authority to view the log files to illicitly acquire the recorded sensitive information.\n\n### Patch\nThis vulnerability was temporarily fixed by #2787 and will be completely resolved by #2788. \n\nThis issue may have caused OAuth tokens to be leaked to users who can view logs on traQ instances using versions prior to v3.25.0.\n\nWhile it is possible that OAuth tokens for both human users and Bots were leaked, revoking Bot access tokens is not recommended as it may cause errors. This issue will be resolved in a future update.\n\nCurrently, the recommended mitigation is to invalidate the OAuth tokens of human users only. To apply this measure, please execute the following SQL statement directly:\n```sql\nUPDATE oauth2_tokens SET deleted_at = NOW() WHERE deleted_at IS NULL AND scopes != \"bot\"\n```\n\n### Workaround\nIf you cannot apply the update immediately, as a temporary workaround, please review access permissions for SQL error logs and strictly limit access to prevent unauthorized users from viewing them.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-08-26T16:19:41Z",
    "Severity": "MODERATE",
    "Summary": "traQ Allows Insertion of Sensitive Information into Log File",
    "UpdatedAt": "2025-08-29T21:03:36Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.9,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.25.0"
      },
      "VulnerableVersionRange": "\u003c 3.25.0"
    }
  ]
}