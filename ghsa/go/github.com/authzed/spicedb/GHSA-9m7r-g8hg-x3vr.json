{
  "Severity": "LOW",
  "UpdatedAt": "2025-11-21T18:06:02Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/authzed/spicedb"
  },
  "Advisory": {
    "DatabaseId": 322573,
    "Id": "GSA_kwCzR0hTQS05bTdyLWc4aGcteDN2cs4ABOwN",
    "GhsaId": "GHSA-9m7r-g8hg-x3vr",
    "References": [
      {
        "Url": "https://github.com/authzed/spicedb/security/advisories/GHSA-9m7r-g8hg-x3vr"
      },
      {
        "Url": "https://github.com/authzed/spicedb/commit/8c2edbe1e7bd3851fa2138f4cc344bfde986dcf2"
      },
      {
        "Url": "https://github.com/advisories/GHSA-9m7r-g8hg-x3vr"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-9m7r-g8hg-x3vr"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-65111"
      }
    ],
    "Description": "### Impact\n\nIf a schema includes the following characteristics:\n\n1. Permission defined in terms of a union (`+`)\n1. That union references the same relation on both sides, but one side arrows to a different permission\n\nThen you might have missing `LookupResources` results when checking the permission. This only affects `LookupResources`; other APIs calculate permissionship correctly.\n\nA small concrete example:\n\n```\nrelation doer_of_things: user | group#member\npermission do_the_thing = doer_of_things + doer_of_things-\u003eadmin\n```\n\nA CheckPermission on `do_the_thing` will return the correct permissionship, but a LookupResources on `do_the_thing` may miss resources.\n\n#### A Comprehensive Example\n\nIf you have a schema with a structure like this:\n\n```\ndefinition special_user {}\n\ndefinition user {\n  relation special_user_mapping: special_user\n  permission special_user = special_user_mapping\n}\ndefinition group {\n   relation member: user\n   permission membership = member + member-\u003especial_user\n}\n\ndefinition system {\n  relation viewer: user | group#membership\n  // This is the problematic permission\n  permission view = viewer + viewer-\u003especial_user\n}\n```\n\nAnd these relationships:\n```\nsystem:somesystem#viewer@group:somegroup#membership\ngroup:somegroup#member@user:someuser1\nuser:someuser1#special_user_mapping@special_user:specialuser\n```\n\nAnd you call LookupResources with:\n```\nsubject_type: user\nsubject_id: someuser1\npermission: view\nresource_type: system\n```\n\nYou would expect to receive `system:somesystem` in the results, but you do not.\n\nNote that this only applies to `LookupResources`; if you `CheckPermission` for that resource specifically, it will return `HasPermission`.\n\n### Patches\n\nThe issue is fixed in v1.47.1. Upgrading to this version will remediate this issue.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-11-21T18:06:00Z",
    "Severity": "LOW",
    "Summary": "SpiceDB: LookupResources with Multiple Entrypoints across Different Definitions Can Return Incomplete Results",
    "UpdatedAt": "2025-11-21T18:06:02Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.47.1"
      },
      "VulnerableVersionRange": "\u003c 1.47.1"
    }
  ]
}