{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-07-01T17:35:18Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/juju/utils/v4/cert"
  },
  "Advisory": {
    "DatabaseId": 301471,
    "Id": "GSA_kwCzR0hTQS1oMzRyLWp4cW0tcWdwcs4ABJmf",
    "GhsaId": "GHSA-h34r-jxqm-qgpr",
    "References": [
      {
        "Url": "https://github.com/juju/utils/security/advisories/GHSA-h34r-jxqm-qgpr"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-6224"
      },
      {
        "Url": "https://github.com/juju/utils/commit/766f27d7bcd10433453a9764509a864c17a46a76"
      },
      {
        "Url": "https://github.com/juju/utils/releases/tag/v4.0.4"
      },
      {
        "Url": "https://github.com/advisories/GHSA-h34r-jxqm-qgpr"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-h34r-jxqm-qgpr"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-6224"
      }
    ],
    "Description": "### Summary\n\nCerts generated by v4 contain their private key.\n\n## Details\n\n### Background\n\nRecently, I encountered an API in Go that’s easy to misuse: sha512.Sum384 and sha512.New384().Sum look very similar and behave very differently. https://go.dev/play/p/kDCqqoYk84k demonstrates this. I want to discuss extending static analysis to detect this case with the go community, but before I do that, I want to make a best-effort pass at open-source projects to fix the existing bugs. I figured that if there were any vulnerabilities out there, they would be easy to find once that discussion begins, so it’s better to address them early. \n\nThis work is a hobby project and has no affiliation with my employer, so I may be slow to respond due to existing commitments. \n\n### PoC\n\nhttps://go.dev/play/p/vSW0U3Hq4qk\n\n### Impact\n\n[This code](https://github.com/juju/utils/blob/0141ef0ee74a0cac603c5c9e4aff194008722f41/cert/cert.go#L120) (cert.NewLeaf) generates certs with the SubjectKeyId set to `sha512.New384().Sum(/* private */ key)`.\n\nIf a cert which was generated by cert.NewLeaf is transferred over the network in plaintext, as is often the case in TLS handshakes, an attacker listening on that network may sniff the cert and trivially extract the private key from it. This applies to client and server TLS certs generated by vulnerable versions of this library.\n\nGetting the server cert and its key would only require performing a TLS handshake (with a matching SNI) with the server. At that point, the attacker could impersonate the server.\n\nSimilarly, getting the client cert and its key would require getting the client to perform a TLS handshake against an attacker-controlled server. At that point, an attacker could impersonate the client.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-07-01T17:35:16Z",
    "Severity": "MODERATE",
    "Summary": "juju/utils leaks private key in certs",
    "UpdatedAt": "2025-07-01T17:35:18Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.0.4"
      },
      "VulnerableVersionRange": "\u003c= 4.0.3"
    }
  ]
}