{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-09-30T18:01:50Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/argoproj/argo-cd/v3"
  },
  "Advisory": {
    "DatabaseId": 314517,
    "Id": "GSA_kwCzR0hTQS1nODhwLXI0MnItcHBwOc4ABMyV",
    "GhsaId": "GHSA-g88p-r42r-ppp9",
    "References": [
      {
        "Url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-g88p-r42r-ppp9"
      },
      {
        "Url": "https://github.com/argoproj/argo-cd/pull/6103"
      },
      {
        "Url": "https://github.com/argoproj/argo-cd/commit/701bc50d01c752cad96185f848088d287a97c7b7"
      },
      {
        "Url": "https://github.com/advisories/GHSA-g88p-r42r-ppp9"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-g88p-r42r-ppp9"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-55191"
      }
    ],
    "Description": "### Summary\n\nA race condition in the repository credentials handler can cause the Argo CD server to panic and crash when concurrent operations are performed on the same repository URL.\n\n### Details\nThe vulnerability is located in numerous repository related handlers in the `util/db/repository_secrets.go` file. For example, in the `secretToRepoCred` function. The issue manifests as a concurrent map access panic:\n\n```\nconcurrent map read and map write\n...\ngoroutine 1104 [running]:\ngithub.com/argoproj/argo-cd/v2/util/db.(*secretsRepositoryBackend).secretToRepoCred(0xc000e50ea8?, 0xc000c65540)\n        /go/src/github.com/argoproj/argo-cd/util/db/repository_secrets.go:404 +0x31e\n```\n\nThe race condition occurs due to:\n1. Concurrent repository credential operations (create/update/delete) accessing the same map\n2. Kubernetes informer re-syncs happening simultaneously\n3. Background watchers updating the same secret data\n4. No mutex protection for map access\n\nA valid API token with `repositories` resource permissions (`create`, `update`, or `delete` actions) is required to trigger the race condition.\n\n### Impact\n\nThis vulnerability causes the entire Argo CD server to crash and become unavailable. Attackers can repeatedly and continuously trigger the race condition to maintain a denial-of-service state, disrupting all GitOps operations. Default ArgoCD configuration is vulnerable.\n\nThe affected code was originally introduced in [PR #6103](https://github.com/argoproj/argo-cd/pull/6103) and released in [v2.1.0](https://github.com/argoproj/argo-cd/releases/tag/v2.1.0).\n\nThis data race was addressed by deep-copying the `Secret` objects before reading/writing.\n\n### Credits\n\nThis vulnerability was found, reported and fixed by:\n\n@thevilledev\n\nThe Argo team would like to thank him for his responsible disclosure and constructive communications during the resolve of this issue.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-30T18:01:48Z",
    "Severity": "MODERATE",
    "Summary": "Repository Credentials Race Condition Crashes Argo CD Server",
    "UpdatedAt": "2025-09-30T18:01:50Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.0.19"
      },
      "VulnerableVersionRange": "\u003e= 3.0.0-rc1, \u003c= 3.0.18"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.1.8"
      },
      "VulnerableVersionRange": "\u003e= 3.1.0-rc1, \u003c= 3.1.7"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.2.0-rc2"
      },
      "VulnerableVersionRange": "= 3.2.0-rc1"
    }
  ]
}