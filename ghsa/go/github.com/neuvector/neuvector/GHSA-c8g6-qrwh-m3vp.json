{
  "Severity": "CRITICAL",
  "UpdatedAt": "2025-10-21T20:25:12Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/neuvector/neuvector"
  },
  "Advisory": {
    "DatabaseId": 317865,
    "Id": "GSA_kwCzR0hTQS1jOGc2LXFyd2gtbTN2cM4ABNmp",
    "GhsaId": "GHSA-c8g6-qrwh-m3vp",
    "References": [
      {
        "Url": "https://github.com/neuvector/neuvector/security/advisories/GHSA-c8g6-qrwh-m3vp"
      },
      {
        "Url": "https://github.com/advisories/GHSA-c8g6-qrwh-m3vp"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-c8g6-qrwh-m3vp"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-54469"
      }
    ],
    "Description": "### Impact\nA vulnerability was identified in NeuVector, where the enforcer used environment variables `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` to generate a command to be executed via `popen`, without first sanitising their values.\n\nThe entry process of the enforcer container is the monitor process. When the enforcer container stops, the monitor process checks whether the consul subprocess has exited. To perform this check, the monitor process uses the `popen` function to execute a shell command that determines whether the ports used by the consul subprocess are still active.\n\nThe values of environment variables `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` are used directly to compose shell commands via popen without validation or sanitization.  This behavior could allow a malicious user to inject malicious commands through these variables within the enforcer container.\n\nIn the patched version, the monitor process validates the values of `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` to ensure they contain only valid port numbers before invoking the `popen` command.\n\nIf validation fails, the monitor process exits immediately, causing the enforcer container to terminate. This prevents the execution of any injected or malicious commands.\n\n\n### Patches\nPatched versions include release `v5.4.7` and above.\n\n### Workarounds\nThere is no workaround for this issue. Users are recommended to upgrade, as soon as possible, to a version of NeuVector that contains the fix.\n\n### References\nIf you have any questions or comments about this advisory:\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\n- Open an issue in the [NeuVector](https://github.com/neuvector/neuvector/issues/new/choose) repository.\n- Verify with our [support matrix](https://www.suse.com/suse-neuvector/support-matrix/all-supported-versions/neuvector-v-all-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/#suse-security).",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-10-21T20:25:11Z",
    "Severity": "CRITICAL",
    "Summary": "NeuVector Enforcer is vulnerable to Command Injection and Buffer overflow",
    "UpdatedAt": "2025-10-21T20:25:12Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 10,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.0.0-20251020133207-084a437033b4"
      },
      "VulnerableVersionRange": "\u003e= 0.0.0-20230727023453-1c4957d53911, \u003c 0.0.0-20251020133207-084a437033b4"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "5.4.7"
      },
      "VulnerableVersionRange": "\u003e= 5.4.0, \u003c= 5.4.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "5.3.5"
      },
      "VulnerableVersionRange": "\u003e= 5.3.0, \u003c 5.3.5"
    }
  ]
}