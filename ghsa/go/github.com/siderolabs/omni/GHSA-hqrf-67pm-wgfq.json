{
  "Severity": "LOW",
  "UpdatedAt": "2025-09-24T18:57:20Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/siderolabs/omni"
  },
  "Advisory": {
    "DatabaseId": 313820,
    "Id": "GSA_kwCzR0hTQS1ocXJmLTY3cG0td2dmcc4ABMnc",
    "GhsaId": "GHSA-hqrf-67pm-wgfq",
    "References": [
      {
        "Url": "https://github.com/siderolabs/omni/security/advisories/GHSA-hqrf-67pm-wgfq"
      },
      {
        "Url": "https://github.com/siderolabs/omni/commit/a5efd816a239e6c9e5ea7c0d43c02c04504d7b60"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hqrf-67pm-wgfq"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hqrf-67pm-wgfq"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-59824"
      }
    ],
    "Description": "## Overview\n\nOmni and each Talos machine establish a peer-to-peer (P2P) SideroLink connection using WireGuard to mutually authenticate and authorize access.\n\nIn this setup, Omni assigns a random IPv6 address to each Talos machine from a `/64` network block. Omni itself uses the fixed `::1` address within that same block.\n\nFrom Omni's perspective, this is a WireGuard interface with multiple peers, where each peer corresponds to a Talos machine. The WireGuard interface on Omni is configured to ensure that the **source IP address** of an incoming packet matches the IPv6 address assigned to the Talos peer. However, it **performs no validation on the packet's destination address**.\n\nThe Talos end of the SideroLink connection cannot be considered a trusted environment. Workloads running on Kubernetes, especially those configured with host networking, could gain direct access to this link. Therefore, a malicious workload could theoretically send arbitrary packets over the SideroLink interface.\n\n---\n\n## Impact\n\nThis vulnerability creates two distinct attack scenarios based on Omni's `IP forwarding` configuration.\n\n1.  **IP Forwarding Disabled (Default)**\n    If `IP forwarding` is disabled, an attacker on a Talos machine can send packets over SideroLink to any listening service on Omni itself (e.g., an internal API). If Omni is running in host networking mode, any service on the host machine could also be targeted. While this is the default configuration, Omni does not enforce it.\n\n2.  **IP Forwarding Enabled**\n    If `IP forwarding` is enabled, an attacker on a Talos machine can communicate with other machines connected to Omni or route packets deeper into Omni's network. Although this is not the default configuration, Omni does not check for or prevent this state.\n\n### Patches\n\nThe problem has been fixed in Omni \u003e= [0.48.0](https://github.com/siderolabs/omni/releases/tag/v0.48.0), the commit is https://github.com/siderolabs/omni/commit/a5efd816a239e6c9e5ea7c0d43c02c04504d7b60\n\n### Workarounds\n\nDisable IP forwarding, implement strict firewall rules.\n\n### References\n\nNone",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-09-24T18:57:19Z",
    "Severity": "LOW",
    "Summary": "Omni Wireguard SideroLink potential escape",
    "UpdatedAt": "2025-09-24T18:57:20Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.48.0"
      },
      "VulnerableVersionRange": "\u003c 0.48.0"
    }
  ]
}