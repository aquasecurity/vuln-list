{
  "Severity": "HIGH",
  "UpdatedAt": "2025-06-30T17:44:59Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/filebrowser/filebrowser/v2"
  },
  "Advisory": {
    "DatabaseId": 301342,
    "Id": "GSA_kwCzR0hTQS1oYzhmLW04ZzUtODM2Ms4ABJke",
    "GhsaId": "GHSA-hc8f-m8g5-8362",
    "References": [
      {
        "Url": "https://github.com/filebrowser/filebrowser/security/advisories/GHSA-hc8f-m8g5-8362"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-52904"
      },
      {
        "Url": "https://github.com/filebrowser/filebrowser/issues/5199"
      },
      {
        "Url": "https://github.com/GoogleContainerTools/distroless"
      },
      {
        "Url": "https://sloonz.github.io/posts/sandboxing-1"
      },
      {
        "Url": "https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250326-01_Filebrowser_Command_Execution_Not_Limited_To_Scope"
      },
      {
        "Url": "https://pkg.go.dev/vuln/GO-2025-3793"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hc8f-m8g5-8362"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hc8f-m8g5-8362"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-52904"
      }
    ],
    "Description": "## Summary ##\n\nIn the web application, all users have a *scope* assigned, and they only have access to the files within that *scope*.\nThe *Command Execution* feature of Filebrowser allows the execution of shell commands which are not restricted to the scope, potentially giving an attacker read and write access to all files managed by the server.\n\n## Impact ##\n\nShell commands are executed with the *uid* of the server process without any further restrictions.\nThis means, that they will have access to at least\n\n* all files managed by the application from all *scopes*, even those the user does not have access to in the GUI.\n* the Filebrowser database file containing the password hashes of all accounts.\n\nThe concrete impact depends on the commands being granted to the attacker, but due to other vulnerabilities identified (\"Bypass Command Execution Allowlist\", \"Shell Commands Can Spawn Other Commands\", \"Insecure File Permissions\") it is likely, that full read- and write-access will exist.\n\nRead access to the database means, that the attacker is capable of extracting all user password hashes.\nThis enables an offline dictionary attack on the passwords of all accounts, though the choice of the password hash function (*bcrypt* with a complexity of 10) gives a strong protection against such attacks.\nWrite access to the database means that attackers are capable of changing a user's password hash, allowing them to impersonate any user account, including an administrator.\n\n## Vulnerability Description ##\n\nShell commands executed by a user are created as a simple subprocess of the application without any further restrictions.\nThat means, that they have full access to files accessible by the application.\nThe *scope* that is assigned to every account is not considered.\n\nAs a prerequisite, an attacker needs an account with the `Execute Commands` permission and some permitted commands.\n\n## Proof of Concept ##\n\nAny exploit highly depends on the commands granted to the attacker.\nThe following screenshot shows, how all password hashes can be extracted using only the `grep` command:\n\n![image](https://github.com/user-attachments/assets/a6fb98e0-2daa-4e10-8480-7963b3d9b214)\n\n## Recommended Countermeasures ##\n\nUntil this issue is fixed, we recommend to completely disable `Execute commands` for all accounts.\nSince the command execution is an inherently dangerous feature that is not used by all deployments, it should be possible to completely disable it in the application's configuration.\nAs a defense-in-depth measure, organizations not requiring command execution should operate the Filebrowser from a *distroless* container image.\n\nThere are two approaches to fixing this issue:\n\n1. Limiting the process when it is started e.g., by using *user namespaces* with a tool like *Bubblewrap*. If this path is chosen, it is important to use a method that works both on a bare-metal server and within an unprivileged container.\n2. Re-architecting the command execution feature so that file in the various *scopes* have a distinct *uid* as an owner and all shell command are executed under the *uid* of the user's *scope*.\n\n## Timeline ##\n\n* `2025-03-26` Identified the vulnerability in version 2.32.0\n* `2025-04-11` Contacted the project\n* `2025-04-18` Vulnerability disclosed to the project\n* `2025-06-25` Uploaded advisories to the project's GitHub repository\n* `2025-06-25` CVE ID assigned by GitHub\n* `2025-06-25` A patch version has been pushed to disable the feature for all existent installations, and making it **opt-in**. A warning has been added to the documentation and is printed on the console if the feature is enabled. Due to the project being in maintenance-only mode, the bug has not been fixed. Fix is tracked on https://github.com/filebrowser/filebrowser/issues/5199.\n\n## References ##\n\n* [Sandboxing Applications with Bubblewrap: Securing a Basic Shell](https://sloonz.github.io/posts/sandboxing-1/)\n* [\"Distroless\" Container Images.](https://github.com/GoogleContainerTools/distroless)\n* [Original Advisory](https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250326-01_Filebrowser_Command_Execution_Not_Limited_To_Scope)\n\n## Credits ##\n\n* Mathias Tausig ([SBA Research](https://www.sba-research.org/))",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-06-30T17:44:58Z",
    "Severity": "HIGH",
    "Summary": "File Browser: Command Execution not Limited to Scope",
    "UpdatedAt": "2025-08-04T20:30:26Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 8.1,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 2.35.0"
    }
  ]
}