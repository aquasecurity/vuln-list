{
  "Severity": "HIGH",
  "UpdatedAt": "2025-11-13T23:01:45Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "lxd"
  },
  "Advisory": {
    "DatabaseId": 321693,
    "Id": "GSA_kwCzR0hTQS0zZzJqLXZtNDcteDRtas4ABOid",
    "GhsaId": "GHSA-3g2j-vm47-x4mj",
    "References": [
      {
        "Url": "https://github.com/canonical/lxd/security/advisories/GHSA-3g2j-vm47-x4mj"
      },
      {
        "Url": "https://github.com/lxc/incus/security/advisories/GHSA-56mx-8g9f-5crf"
      },
      {
        "Url": "https://github.com/lxc/incus/issues/2641"
      },
      {
        "Url": "https://github.com/canonical/lxd/pull/16904"
      },
      {
        "Url": "https://github.com/canonical/lxd/pull/16922"
      },
      {
        "Url": "https://github.com/canonical/lxd/pull/16923"
      },
      {
        "Url": "https://github.com/canonical/lxd/pull/16924"
      },
      {
        "Url": "https://github.com/advisories/GHSA-3g2j-vm47-x4mj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-3g2j-vm47-x4mj"
      }
    ],
    "Description": "**Impact**\n\nThis affects any LXD user in an environment where an unprivileged user may have root access to a container with an attached custom storage volume that has the `security.shifted` property set to `true` as well as access to the host as an unprivileged user.\n\nThe most common case for this would be systems using `lxd-user` with the less privileged lxd group to provide unprivileged users with an isolated restricted access to LXD. Such users may be able to create a custom storage volume with the necessary property (depending on kernel and filesystem support) and can then write a setuid binary from within the container which can be executed as an unprivileged user on the host to gain root privileges.\n\n**Patches**\n\nPatches for this issue are available: \n\n- LXD 6 series: https://github.com/canonical/lxd/pull/16904\n- LXD 5.21 LTS series: https://github.com/canonical/lxd/pull/16922\n- LXD 5.0 LTS series: https://github.com/canonical/lxd/pull/16923\n- LXD 4.0 LTS series: https://github.com/canonical/lxd/pull/16924 \n\nThe first commit changes the permissions for any new storage pool, the later commit adds a patch that applies it on startup to all existing storage pools.\n\nThese fixes are also available in the associated candidate snap channels for each LTS series:\n\n- 5.21/candidate (5.21.4-8a3cf61)\n- 5.0/candidate (5.0.5-5c60378)\n- 4.0/candidate (4.0.10-35a8127)\n\nWe will be preparing intermediate releases to the associated stable snap channels shortly.\n\n**Workarounds**\n\nPermissions can be manually restricted until a patched version of LXD is deployed.\n\nThis is done with:\n\n```\nsudo nsenter --mount=/run/snapd/ns/lxd.mnt -- chmod 0700 /var/snap/lxd/common/lxd/storage-pools/*/{custom*,virtual-machines*,images}\nsudo nsenter --mount=/run/snapd/ns/lxd.mnt -- chmod 0711 /var/snap/lxd/common/lxd/storage-pools/*/{containers*,buckets*}\n```\n\nThose are the same permissions which will be applied by the patched LXD for both new and existing storage pools.\n\n**References**\n\nThis was reported to Incus publicly on Github here: \n\n- https://github.com/lxc/incus/security/advisories/GHSA-56mx-8g9f-5crf\n- https://github.com/lxc/incus/issues/2641",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-11-13T23:01:44Z",
    "Severity": "HIGH",
    "Summary": "LXD vulnerable to a local privilege escalation through custom storage volumes",
    "UpdatedAt": "2025-11-13T23:01:45Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 6.18.0"
    }
  ]
}