{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-02T01:24:56Z",
  "Package": {
    "Ecosystem": "COMPOSER",
    "Name": "getgrav/grav"
  },
  "Advisory": {
    "DatabaseId": 323915,
    "Id": "GSA_kwCzR0hTQS03Zzc4LTVnNWctbXZmas4ABPFL",
    "GhsaId": "GHSA-7g78-5g5g-mvfj",
    "References": [
      {
        "Url": "https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66310"
      },
      {
        "Url": "https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-7g78-5g5g-mvfj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-7g78-5g5g-mvfj"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66310"
      }
    ],
    "Description": "## Summary\n\nA Stored Cross-Site Scripting (XSS) vulnerability was identified in the `/admin/pages/[page]` endpoint of the _Grav_ application. This vulnerability allows attackers to inject malicious scripts into the `data[header][template]` parameter. The script is saved within the page's frontmatter and executed automatically whenever the affected content is rendered in the administrative interface or frontend view.\n\n---\n\n## Details\n\n**Vulnerable Endpoint:** `POST /admin/pages/[page]`  \n**Parameter:** `data[header][template]`\n\nThe application fails to properly sanitize user input in the `data[header][template]` field, which is stored in the YAML frontmatter of the page. An attacker can inject JavaScript code using this field, and the payload is rendered and executed when the page is accessed, especially within the Admin Panel interface.\n\n---\n\n## PoC\n\n**Payload:**\n\n`\u003cscript\u003ealert('PoC-XXS73')\u003c/script\u003e`\n\n### Steps to Reproduce:\n\n1. Log in to the _Grav_ Admin Panel and navigate to **Pages**.\n    \n2. Create a new page or edit an existing one.\n    \n3. In the **Advanced \u003e Template** field (which maps to `data[header][template]`), insert the payload:\n![image](https://github.com/user-attachments/assets/fc92aa09-e363-4422-b577-63aa27097886)\n\n4. Save the page.\n    \n5. Return to the **Pages** section and click on the **three-dot menu** of the affected page: \n![image](https://github.com/user-attachments/assets/ea6a023b-f838-4700-b2a8-8dcfbca37f00)\n\n6. The stored XSS payload is triggered, and the script is executed in the browser:\n![image](https://github.com/user-attachments/assets/8cf1cca5-ce8f-4b09-a57c-0848090918ac)\n---\n\n## Impact\n\nStored XSS vulnerabilities can have serious consequences, including:\n\n- **Session hijacking:** Capturing admin session cookies or tokens\n    \n- **Malware delivery:** Executing scripts that load malicious resources\n    \n- **Credential theft:** Creating fake login prompts to steal usernames/passwords\n    \n- **Data exposure:** Reading sensitive metadata or page contents\n    \n- **Privilege escalation:** Performing actions as an authenticated user\n    \n- **Website defacement:** Altering visual or functional elements of the site\n    \n- **Reputation damage:** Undermining user trust in the application\n\nbyÂ [CVE-Hunters](https://github.com/Sec-Dojo-Cyber-House/cve-hunters)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-02T01:24:56Z",
    "Severity": "MODERATE",
    "Summary": "Grav vulnerable to Cross-Site Scripting (XSS) Stored endpoint `/admin/pages/[page]` parameter `data[header][template]` in Advanced Tab",
    "UpdatedAt": "2025-12-02T01:24:56Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.8.0-beta.27"
      },
      "VulnerableVersionRange": "\u003c 1.8.0-beta.27"
    }
  ]
}