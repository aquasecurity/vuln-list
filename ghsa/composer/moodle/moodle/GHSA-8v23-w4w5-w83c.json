{
  "Severity": "MODERATE",
  "UpdatedAt": "2022-11-23T22:20:33Z",
  "Package": {
    "Ecosystem": "COMPOSER",
    "Name": "moodle/moodle"
  },
  "Advisory": {
    "DatabaseId": 196688,
    "Id": "GSA_kwCzR0hTQS04djIzLXc0dzUtdzgzY84AAwBQ",
    "GhsaId": "GHSA-8v23-w4w5-w83c",
    "References": [
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2022-45149"
      },
      {
        "Url": "https://bugzilla.redhat.com/show_bug.cgi?id=2142772"
      },
      {
        "Url": "https://moodle.org/mod/forum/discuss.php?d=440769"
      },
      {
        "Url": "http://git.moodle.org/gw?p=moodle.git\u0026a=search\u0026h=HEAD\u0026st=commit\u0026s=MDL-75862"
      },
      {
        "Url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2DHYIIAUXUBHMBEDYU7TYNZXEN2W2SA2/"
      },
      {
        "Url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/74SXNGA5RIWM7QNX7H3G7SYIQLP4UUGV/"
      },
      {
        "Url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NLRJB5JNKK3VVBLV3NH3RI7COEDAXSAB/"
      },
      {
        "Url": "https://github.com/advisories/GHSA-8v23-w4w5-w83c"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-8v23-w4w5-w83c"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2022-45149"
      }
    ],
    "Description": "A vulnerability was found in Moodle which exists due to insufficient validation of the HTTP request origin in course redirect URL. A user's CSRF token was unnecessarily included in the URL when being redirected to a course they have just restored. A remote attacker can trick the victim to visit a specially crafted web page and perform arbitrary actions on behalf of the victim on the vulnerable website. This flaw allows an attacker to perform cross-site request forgery attacks.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2022-11-23T15:30:21Z",
    "Severity": "MODERATE",
    "Summary": "Cross-Site Request Forgery in Moodle",
    "UpdatedAt": "2023-02-01T05:03:21Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.4,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.0.5"
      },
      "VulnerableVersionRange": "\u003e= 4.0.0, \u003c 4.0.5"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.11.11"
      },
      "VulnerableVersionRange": "\u003e= 3.11.0, \u003c 3.11.11"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.9.18"
      },
      "VulnerableVersionRange": "\u003e= 3.9.0, \u003c 3.9.18"
    }
  ]
}