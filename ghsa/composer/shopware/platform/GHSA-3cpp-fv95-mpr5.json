{
  "Severity": "LOW",
  "UpdatedAt": "2025-10-21T18:02:53Z",
  "Package": {
    "Ecosystem": "COMPOSER",
    "Name": "shopware/platform"
  },
  "Advisory": {
    "DatabaseId": 317839,
    "Id": "GSA_kwCzR0hTQS0zY3BwLWZ2OTUtbXByNc4ABNmP",
    "GhsaId": "GHSA-3cpp-fv95-mpr5",
    "References": [
      {
        "Url": "https://github.com/shopware/shopware/security/advisories/GHSA-3cpp-fv95-mpr5"
      },
      {
        "Url": "https://github.com/shopware/shopware/commit/f32737b34798d4800b81c67efee17905380d2be4"
      },
      {
        "Url": "https://github.com/advisories/GHSA-3cpp-fv95-mpr5"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-3cpp-fv95-mpr5"
      }
    ],
    "Description": "### Impact\nThis vulnerability allows malicious actors to force the application server to send HTTP requests to both external and internal servers. In certain cases, this may lead to access to internal resources such as databases, file systems, or other services that are not supposed to be directly accessible from the internet.\n\nThe overall impact of this vulnerability is considered limited, as the functionality is highly restricted and only processes IMG tags.\n\n#### Description\nServer-Side Request Forgery (SSRF) is a vulnerability that enables a malicious actor to manipulate an application server into performing HTTP requests to arbitrary domains. SSRF is commonly exploited to make the server initiate requests to its internal systems or other services within the same network, which are typically not exposed to external users. In some cases, SSRF can also be used to target external systems. A successful SSRF attack can result in unauthorized actions or access to data within the\norganization, the web application itself, or other backend systems the application communicates with. In worst-case scenario, a SSRF vulnerability can be exploited to execute malicious code on the server.\n\n#### Applicability \nThe PDF generator used to create order invoices contains a Server-Side Request Forgery (SSRF)\nvulnerability.\nAdministrative users can generate invoices for completed orders and have the option to add a note to the invoice. This input is currently not adequately filtered for (malicious) HTML characters. When a malicious actor submits an IMG tag as input, the PDF generator attempts to retrieve an external image while processing the IMG tag. As a result, the application server can be used to perform an HTTP request, enabling the malicious actors to reach both external and internal servers.\nTo exploit this vulnerability, an admin account is required.\n\n#### Reproduction\nTo reproduce this vulnerability, the steps below can be followed.\n1. Log in as an admin and navigate to the following URL:\nhttps://\u003cyour-site\u003e.shopware.store/admin#/sw/order/detail/0198e0afa2cb70ceb76ad64fc7864ca6/documents?limit=25\u0026page=1\u0026term=\u0026sortBy\u0026sortDirection=ASC\u0026naturalSorting=false\n2. Click the button ‘Create document’ and create a ‘Partial cancellation’ document.\n3. As a comment add the following code:\n```\n\u003cimg src=\"\u003cmalicious image link\u003e\" width=\"250\" height=\"100\"/\u003e\n```\n4. Press the preview button to view the PFD.\n5. Observe that the image is shown in the PDF.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-10-21T18:02:52Z",
    "Severity": "LOW",
    "Summary": "Shopware vulnerable to Server-Side Request Forgery (SSRF) – order invoice",
    "UpdatedAt": "2025-10-21T18:02:53Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 2.7,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "6.6.10.7"
      },
      "VulnerableVersionRange": "\u003c 6.6.10.7"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "6.7.3.1"
      },
      "VulnerableVersionRange": "\u003e= 6.7.0.0, \u003c 6.7.3.1"
    }
  ]
}