{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-11-14T20:42:25Z",
  "Package": {
    "Ecosystem": "COMPOSER",
    "Name": "shopware/core"
  },
  "Advisory": {
    "DatabaseId": 321773,
    "Id": "GSA_kwCzR0hTQS0ydzQ2LXZxOGgtOTh2aM4ABOjt",
    "GhsaId": "GHSA-2w46-vq8h-98vh",
    "References": [
      {
        "Url": "https://github.com/shopware/shopware/security/advisories/GHSA-2w46-vq8h-98vh"
      },
      {
        "Url": "https://github.com/shopware/shopware/commit/1338dd9a11e361639704bf8f09b6878552eb8c13"
      },
      {
        "Url": "https://github.com/shopware/shopware/commit/2fb94855696a90045b81c503d216ba7df8e64e52"
      },
      {
        "Url": "https://github.com/shopware/shopware/releases/tag/v6.6.10.9"
      },
      {
        "Url": "https://github.com/shopware/shopware/releases/tag/v6.7.0.0"
      },
      {
        "Url": "https://github.com/shopware/shopware/releases/tag/v6.7.4.1"
      },
      {
        "Url": "https://github.com/advisories/GHSA-2w46-vq8h-98vh"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-2w46-vq8h-98vh"
      }
    ],
    "Description": "### Summary\nWhen a customer changes their email address after requesting a password reset, the old password reset link (tied to the previous email) remains valid. An attacker with access to the old email inbox is potentially able to reset the customer’s password even after the user changes their email address.\n\n### PoC\n\n1. Log in to a Shopware account.\n2. Request a password reset for your current email address.\n3. Copy the password reset link but do not open it.\n4. Log back into your account.n\n5. Navigate to Account Settings → Email and change your email address.\n6. Use the previously copied reset link (from before the email change).\n7. The system allows password change using the old link.\n\n### Impact\nReproduced on Stable 6.6.10.7 and trunk.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-11-14T20:42:24Z",
    "Severity": "MODERATE",
    "Summary": "Shopware 6's password recovery link does not expire after email change",
    "UpdatedAt": "2025-11-14T20:42:25Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "6.7.4.1"
      },
      "VulnerableVersionRange": "\u003e= 6.7.0.0, \u003c 6.7.4.1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "6.6.10.9"
      },
      "VulnerableVersionRange": "\u003c 6.6.10.9"
    }
  ]
}