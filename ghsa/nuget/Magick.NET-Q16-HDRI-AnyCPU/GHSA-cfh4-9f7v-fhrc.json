{
  "Severity": "LOW",
  "UpdatedAt": "2025-08-25T15:54:00Z",
  "Package": {
    "Ecosystem": "NUGET",
    "Name": "Magick.NET-Q16-HDRI-AnyCPU"
  },
  "Advisory": {
    "DatabaseId": 308856,
    "Id": "GSA_kwCzR0hTQS1jZmg0LTlmN3YtZmhyY84ABLZ4",
    "GhsaId": "GHSA-cfh4-9f7v-fhrc",
    "References": [
      {
        "Url": "https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-cfh4-9f7v-fhrc"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-53019"
      },
      {
        "Url": "https://github.com/ImageMagick/ImageMagick/commit/fc3ab0812edef903bbb2473c0ee652ddfd04fe5c"
      },
      {
        "Url": "https://github.com/ImageMagick/ImageMagick6/commit/d49460522669232159c2269fa64f73ed30555c1b"
      },
      {
        "Url": "https://github.com/dlemstra/Magick.NET/releases/tag/14.7.0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-cfh4-9f7v-fhrc"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-cfh4-9f7v-fhrc"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-53019"
      }
    ],
    "Description": "## Summary\n\nIn ImageMagick's `magick stream` command, specifying multiple consecutive `%d` format specifiers in a filename template causes a memory leak.\n\n## Details\n\n- **Vulnerability Type:** Memory leak\n- **Affected Version:** ImageMagick 7.1.1-47 (as of commit 82572afc, June 2025)\n\n## Reproduction\n\n### Tested Environment\n\n- **Operating System:** Ubuntu 22.04 LTS\n- **Architecture:** x86_64\n- **Compiler:** gcc with AddressSanitizer (gcc version: 11.4.0)\n\n### Reproduction Steps\n\n```bash\n# Clone source\ngit clone --depth 1 --branch 7.1.1-47 https://github.com/ImageMagick/ImageMagick.git ImageMagick-7.1.1\ncd ImageMagick-7.1.1\n\n# Build with ASan\nCFLAGS=\"-g -O0 -fsanitize=address -fno-omit-frame-pointer\" CXXFLAGS=\"$CFLAGS\" LDFLAGS=\"-fsanitize=address\" ./configure --enable-maintainer-mode --enable-shared \u0026\u0026 make -j$(nproc) \u0026\u0026 make install\n\n# Trigger crash\n./utilities/magick stream %d%d a a\n```\n\n### Output\n```\n$ magick stream %d%d a a\nstream: no decode delegate for this image format `' @ error/constitute.c/ReadImage/746.\nstream: missing an image filename `a' @ error/stream.c/StreamImageCommand/755.\n\n=================================================================\n==114==ERROR: LeakSanitizer: detected memory leaks\n\nDirect leak of 152 byte(s) in 1 object(s) allocated from:\n    #0 0x7fc4ebe58887 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145\n    #1 0x7fc4eb563c5c in AcquireMagickMemory MagickCore/memory.c:559\n    #2 0x7fc4eb563c82 in AcquireCriticalMemory MagickCore/memory.c:635\n    #3 0x7fc4eb60c2be in AcquireQuantumInfo MagickCore/quantum.c:119\n    #4 0x7fc4eb6b6621 in StreamImage MagickCore/stream.c:1335\n    #5 0x7fc4eb09d889 in StreamImageCommand MagickWand/stream.c:292\n    #6 0x7fc4eaf1295d in MagickCommandGenesis MagickWand/magick-cli.c:177\n    #7 0x55a34f7c0a0c in MagickMain utilities/magick.c:153\n    #8 0x55a34f7c0cba in main utilities/magick.c:184\n    #9 0x7fc4ea38fd8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58\n\nIndirect leak of 64 byte(s) in 1 object(s) allocated from:\n    #0 0x7fc4ebe5957c in __interceptor_posix_memalign ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:226\n    #1 0x7fc4eb680e2f in AcquireSemaphoreMemory MagickCore/semaphore.c:154\n    #2 0x7fc4eb680f30 in AcquireSemaphoreInfo MagickCore/semaphore.c:200\n    #3 0x7fc4eb60d38d in GetQuantumInfo MagickCore/quantum.c:435\n    #4 0x7fc4eb60c30e in AcquireQuantumInfo MagickCore/quantum.c:121\n    #5 0x7fc4eb6b6621 in StreamImage MagickCore/stream.c:1335\n    #6 0x7fc4eb09d889 in StreamImageCommand MagickWand/stream.c:292\n    #7 0x7fc4eaf1295d in MagickCommandGenesis MagickWand/magick-cli.c:177\n    #8 0x55a34f7c0a0c in MagickMain utilities/magick.c:153\n    #9 0x55a34f7c0cba in main utilities/magick.c:184\n    #10 0x7fc4ea38fd8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58\n\nSUMMARY: AddressSanitizer: 216 byte(s) leaked in 2 allocation(s).\n```\n\n### Commits\nFixed in https://github.com/ImageMagick/ImageMagick/commit/fc3ab0812edef903bbb2473c0ee652ddfd04fe5c and https://github.com/ImageMagick/ImageMagick6/commit/d49460522669232159c2269fa64f73ed30555c1b",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-08-25T15:53:57Z",
    "Severity": "LOW",
    "Summary": "ImageMagick has a Memory Leak in magick stream",
    "UpdatedAt": "2025-08-25T15:54:00Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 3.7,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "14.7.0"
      },
      "VulnerableVersionRange": "\u003c 14.7.0"
    }
  ]
}