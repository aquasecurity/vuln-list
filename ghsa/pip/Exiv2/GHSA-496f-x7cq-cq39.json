{
  "Severity": "LOW",
  "UpdatedAt": "2025-08-29T14:49:42Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "Exiv2"
  },
  "Advisory": {
    "DatabaseId": 309466,
    "Id": "GSA_kwCzR0hTQS00OTZmLXg3Y3EtY3EzOc4ABLja",
    "GhsaId": "GHSA-496f-x7cq-cq39",
    "References": [
      {
        "Url": "https://github.com/Exiv2/exiv2/security/advisories/GHSA-496f-x7cq-cq39"
      },
      {
        "Url": "https://github.com/Exiv2/exiv2/commit/e737332427711f15bcdc4e903203d6b7493eaec0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-496f-x7cq-cq39"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-496f-x7cq-cq39"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-54080"
      }
    ],
    "Description": "### Impact\nAn out-of-bounds read was found in Exiv2 versions v0.28.5 and earlier. Exiv2 is a command-line utility and C++ library for reading, writing, deleting, and modifying the metadata of image files. The out-of-bounds read is triggered when Exiv2 is used to write metadata into a crafted image file. An attacker could potentially exploit the vulnerability to cause a denial of service by crashing Exiv2, if they can trick the victim into running Exiv2 on a crafted image file.\n\nNote that this bug is only triggered when writing the metadata, which is a less frequently used Exiv2 operation than reading the metadata. For example, to trigger the bug in the Exiv2 command-line application, you need to add an extra command-line argument such as delete.\n\n### Patches\nThe bug is fixed in version v0.28.6.\n\n### Credit\nThank you to @dragonArthurX for reporting this issue.\n\n### Details (from original report by @dragonArthurX )\n**Version:**\nTested on v0.28.5 (latest official release)\nCommit: 907169fa643c2c74c14fd4106e55eaeee3634d9f\n\n**Platform:**\nUbuntu 20.04.6 LTS (x86_64)\n\n**Build Steps:**\n```bash\ngit clone https://github.com/Exiv2/exiv2.git\ncd exiv2\ngit checkout v0.28.5\nmkdir build-v0.28.5 \u0026\u0026 cd build-v0.28.5\ncmake -DCMAKE_C_COMPILER=/fuzzer/afl-clang-fast -DCMAKE_CXX_COMPILER=/fuzzer/afl-clang-fast++ -DCMAKE_C_FLAGS=\"-g -fsanitize=address\" -DCMAKE_CXX_FLAGS=\"-g -fsanitize=address\" -DBUILD_SHARED_LIBS=OFF ../\n```\n\n**Command line to reproduce:**\n```bash\n/home/exiv2/build/bin/exiv2 -d a -f /home/poc \n```\n\n**Crash Output:** \n```\nAddressSanitizer:DEADLYSIGNAL\n ================================================================ = \n==376531==ERROR: AddressSanitizer: SEGV on unknown address 0x7fd92236b0e7 (pc 0x7fd82314dcd2 bp 0x7ffd540ceba0 sp 0x7ffd540ce358 T0)\n==376531==The signal is caused by a READ memory access.\n    #0 0x7fd82314dcd2  /build/glibc-B3wQXB/glibc-2.31/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:383\n    #1 0x4ed131 in __asan_memcpy (/home/exiv2/build-v0.28.5/bin/exiv2+0x4ed131)\n    #2 0x6184b1 in Exiv2::MemIo::write(unsigned char const*, unsigned long) /home/exiv2/src/basicio.cpp:704:5\n    #3 0xad336d in (anonymous namespace)::writeTemp(Exiv2::BasicIo\u0026, unsigned char const*, unsigned long) /home/exiv2/src/epsimage.cpp:90:14\n    #4 0xac3a07 in (anonymous namespace)::readWriteEpsMetadata(Exiv2::BasicIo\u0026, std::__cxx11::basic_string\u003cchar, std::char_traits\u003cchar\u003e, std::allocator\u003cchar\u003e \u003e\u0026, std::vector\u003cExiv2::NativePreview, std::allocator\u003cExiv2::NativePreview\u003e \u003e\u0026, bool) /home/exiv2/src/epsimage.cpp:1009:7\n    #5 0xad1175 in Exiv2::EpsImage::writeMetadata() /home/exiv2/src/epsimage.cpp:1103:3\n    #6 0x5d2383 in Action::Erase::run(std::__cxx11::basic_string\u003cchar, std::char_traits\u003cchar\u003e, std::allocator\u003cchar\u003e \u003e const\u0026) /home/exiv2/app/actions.cpp:713:14\n    #7 0x522d02 in main /home/exiv2/app/exiv2.cpp:177:25\n    #8 0x7fd8230b6082 in __libc_start_main /build/glibc-B3wQXB/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #9 0x4714dd in _start (/home/exiv2/build-v0.28.5/bin/exiv2+0x4714dd)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /build/glibc-B3wQXB/glibc-2.31/string/../sysdeps/x86_64/multiarch/memmove-vec-unaligned-erms.S:383 \n==376531==ABORTING\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-08-29T14:49:41Z",
    "Severity": "LOW",
    "Summary": "Exiv2 Segmentation Faults in Exiv2::EpsImage::writeMetadata() via crafted EPS file",
    "UpdatedAt": "2025-08-29T14:49:42Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 0.17.3"
    }
  ]
}