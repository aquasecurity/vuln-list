{
  "Severity": "MODERATE",
  "UpdatedAt": "2024-02-09T15:04:11Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "nonebot2"
  },
  "Advisory": {
    "DatabaseId": 234216,
    "Id": "GSA_kwCzR0hTQS01OWo4LTc3NnYteHh4Z84AA5Lo",
    "GhsaId": "GHSA-59j8-776v-xxxg",
    "References": [
      {
        "Url": "https://github.com/nonebot/nonebot2/security/advisories/GHSA-59j8-776v-xxxg"
      },
      {
        "Url": "https://github.com/nonebot/nonebot2/pull/2509"
      },
      {
        "Url": "https://github.com/nonebot/nonebot2/commit/b65b3b438c95894654fd9081139989c757bdc6c1"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2024-21624"
      },
      {
        "Url": "https://github.com/advisories/GHSA-59j8-776v-xxxg"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-59j8-776v-xxxg"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2024-21624"
      }
    ],
    "Description": "### Impact\nThis security advisory pertains to a potential information leak (e.g., environment variables) in instances where developers utilize `MessageTemplate` and incorporate user-provided data into templates.\n\n### Patches\nThe identified vulnerability has been remedied in fix #2509 and will be included in versions released after 2.1.3. Users are strongly advised to upgrade to these patched versions to safeguard against the vulnerability.\n\n### Workarounds\nA temporary workaround involves filtering underscores before incorporating user input into the message template.\n\n### References\n- [Pull Request #2509](https://github.com/nonebot/nonebot2/pull/2509)\n- [CWE-1336](https://cwe.mitre.org/data/definitions/1336.html)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2024-02-09T15:04:08Z",
    "Severity": "MODERATE",
    "Summary": "NoneBot Potential Information Leak in User-Constructed Message Templates",
    "UpdatedAt": "2024-02-12T15:03:07Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.7,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.2.0"
      },
      "VulnerableVersionRange": "\u003e= 2.0.0a16, \u003c= 2.1.3"
    }
  ]
}