{
  "id": "GHSA-796p-j2gh-9m2q",
  "modified": "2026-01-26T19:11:20.735316Z",
  "published": "2026-01-26T18:55:13Z",
  "aliases": [
    "CVE-2026-22696"
  ],
  "summary": "dcap-qvl has Missing Verification for QE Identity",
  "details": "## Impact\nThis vulnerability involves a critical gap in the cryptographic verification process within the dcap-qvl.\n\nThe library fetches QE Identity collateral (including qe_identity, qe_identity_signature, and qe_identity_issuer_chain) from the PCCS. However, it skips to verify the QE Identity signature against its certificate chain and does not enforce policy constraints on the QE Report.\n\n## Consequences\nAn attacker can forge the QE Identity data to whitelist a malicious or non-Intel Quoting Enclave. This allows the attacker to forge the QE and sign untrusted quotes that the verifier will accept as valid. Effectively, this bypasses the entire remote attestation security model, as the verifier can no longer trust the entity responsible for signing the quotes.\n\n## Who is impacted\nAll deployments utilizing the dcap-qvl library for SGX or TDX quote verification are affected.\n\n## Patches\nThe vulnerability has been patched in dcap-qvl version 0.3.9. The fix implements the missing cryptographic verification for the QE Identity signature and enforces the required checks for MRSIGNER, ISVPRODID, and ISVSVN against the QE Report.\n\nUsers of the `@phala/dcap-qvl-node` and `@phala/dcap-qvl-web` packages should switch to the pure JavaScript implementation, `@phala/dcap-qvl`.\n\n## Workarounds\nThere are no known workarounds for this vulnerability. Users must upgrade to the patched version to ensure that QE Identity collateral is properly verified.\n\n## Credit\nThis bug was reported by Rahul Saxena \u003csaxenism@bluethroatlabs.com\u003e.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "dcap-qvl",
        "purl": "pkg:cargo/dcap-qvl"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.3.9"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json"
      }
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@phala/dcap-qvl",
        "purl": "pkg:npm/%40phala/dcap-qvl"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.3.9"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 0.3.0",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json"
      }
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@phala/dcap-qvl-web",
        "purl": "pkg:npm/%40phala/dcap-qvl-web"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "0.3.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json"
      }
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "@phala/dcap-qvl-node",
        "purl": "pkg:npm/%40phala/dcap-qvl-node"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "0.3.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json"
      }
    },
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "dcap-qvl",
        "purl": "pkg:pypi/dcap-qvl"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.3.9"
            }
          ]
        }
      ],
      "versions": [
        "0.1.0",
        "0.1.1",
        "0.1.2",
        "0.1.3",
        "0.2.2",
        "0.3.0",
        "0.3.2",
        "0.3.4",
        "0.3.5",
        "0.3.6",
        "0.3.7",
        "0.3.8"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-796p-j2gh-9m2q/GHSA-796p-j2gh-9m2q.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/Phala-Network/dcap-qvl/security/advisories/GHSA-796p-j2gh-9m2q"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/Phala-Network/dcap-qvl"
    }
  ]
}