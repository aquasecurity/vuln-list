{
  "id": "GHSA-q428-6v73-fc4q",
  "modified": "2025-11-13T15:36:03Z",
  "published": "2025-11-13T15:36:03Z",
  "aliases": [
    "CVE-2025-64517"
  ],
  "summary": "sudo-rs doesn't record authenticating user properly in timestamp",
  "details": "### Summary\nWhen `Defaults targetpw` (or `Defaults rootpw`) is enabled, the password of the target account (or root account) instead of the invoking user is used for authentication. `sudo-rs` prior to 0.2.10 incorrectly recorded the invoking userâ€™s UID instead of the authenticated-as user's UID in the authentication timestamp. Any later `sudo` invocation on the same terminal while the timestamp was still valid would use that timestamp, potentially bypassing new authentication even if the policy would have required it.\n\n### Impact\nA highly-privileged user (able to run commands as other users, or as root, through sudo) who knows one password of an account they are allowed to run commands as, would be able to run commands as any other account the policy permits them to run commands for, even if they don't know the password for those accounts.\n\nA common instance of this would be that a user can still use their own password to run commands as root (the default behaviour of `sudo`), effectively negating the intended behaviour of the `targetpw` or `rootpw` options.\n\n### Example\n\nWith this in /etc/sudoers:\n```\nDefaults targetpw\nuser ALL=(ALL:ALL) ALL\n```\nFirst run:\n```\nuser@machine$ sudo -g root whoami\n[sudo: authenticate] Password: \u003cpassword for user\u003e\nuser\n```\nThen run:\n```\nuser@machine$ sudo -u root whoami\nroot\n```\n\n### Affected versions\n\nsudo-rs prior to 0.2.5 are not affected, since they do not offer `Defaults targetpw` or `Defaults rootpw`.\n\n### Credits\n\nThis issue was discovered and reported by @Pingasmaster.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "sudo-rs",
        "purl": "pkg:cargo/sudo-rs"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.2.5"
            },
            {
              "fixed": "0.2.10"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-q428-6v73-fc4q/GHSA-q428-6v73-fc4q.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/trifectatechfoundation/sudo-rs/security/advisories/GHSA-q428-6v73-fc4q"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64517"
    },
    {
      "type": "WEB",
      "url": "https://github.com/trifectatechfoundation/sudo-rs/commit/8423fd986c3fa58b357f238c0db5e54baca5255d"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/trifectatechfoundation/sudo-rs"
    },
    {
      "type": "WEB",
      "url": "https://github.com/trifectatechfoundation/sudo-rs/releases/tag/v0.2.10"
    }
  ]
}