{
  "id": "GHSA-7vm2-j586-vcvc",
  "modified": "2025-09-11T21:53:23Z",
  "published": "2025-09-11T21:53:23Z",
  "summary": "SurrealDB is Vulnerable to Unauthorized Data Exposure via LIVE Query Subscriptions",
  "details": "`LIVE SELECT` statements are used to capture changes to data within a table in real time. Documents included in `WHERE` conditions and `DELETE` notifications were not properly reduced to respect the querying user's security context. Instead the leaked documents reflect the context of the user triggering the notification.\n\nThis allows a record or guest user with permissions to run live query subscriptions on a table to observe unauthorised records within the same table, when another user is altering or deleting these records, bypassing access controls.\n\n### Impact\nA record or guest user with permissions to run live query subscriptions on a table is able to observe unauthorised records within the same table, with unauthorised records returned when deleted, or when records matching the WHERE conditions are created, updated, or deleted, by another user. This impacts confidentiality, limited to the table the attacker has access to, and with the data disclosed dependent of the actions taken by other users.\n\n### Patches\nA patch has been created for the following versions:\n\n- Versions 2.1.9, 2.2.8 and 2.3.8 and later are not affected by this issue. \n- The first release following v3.0.0-alpha.7 will be patched.\n\n### Workarounds\nAssess the impact of users with permissions on table records effectively having full read access to the table, use separate tables if required, with impacts to functionality.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "SurrealDB",
        "purl": "pkg:cargo/SurrealDB"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.3.0"
            },
            {
              "fixed": "2.3.8"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-7vm2-j586-vcvc/GHSA-7vm2-j586-vcvc.json"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "SurrealDB",
        "purl": "pkg:cargo/SurrealDB"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.2.0"
            },
            {
              "fixed": "2.2.8"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-7vm2-j586-vcvc/GHSA-7vm2-j586-vcvc.json"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "SurrealDB",
        "purl": "pkg:cargo/SurrealDB"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.1.9"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-7vm2-j586-vcvc/GHSA-7vm2-j586-vcvc.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/surrealdb/surrealdb/security/advisories/GHSA-7vm2-j586-vcvc"
    },
    {
      "type": "WEB",
      "url": "https://github.com/surrealdb/surrealdb/pull/6247"
    },
    {
      "type": "WEB",
      "url": "https://github.com/surrealdb/surrealdb/commit/d81169a06b89f0c588134ddf2d62eeb8d5e8fd0c"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/surrealdb/surrealdb"
    },
    {
      "type": "WEB",
      "url": "https://surrealdb.com/docs/surrealql/statements/live"
    }
  ]
}