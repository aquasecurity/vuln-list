{
  "id": "GHSA-xrv8-2pf5-f3q7",
  "modified": "2025-12-05T19:09:38.158008Z",
  "published": "2025-12-05T18:57:55Z",
  "summary": "nitro-tpm-pcr-compute may allow kernel command line modification by an account operator",
  "details": "## Summary\n\nAdding default PCR12 validation to ensure that account operators can not modify kernel command line parameters, potentially bypassing root filesystem integrity validation.\n\nAttestable AMIs are based on the systemd Unified Kernel Image (UKI) concept which uses systemd-boot to create a single measured UEFI binary from a Linux kernel, its initramfs, and kernel command line. The embedded kernel command line contains a dm-verity hash value that establishes trust in the root file system.\n\nWhen UEFI Secure Boot is disabled, systemd-boot appends any command line it receives to the kernel command line. Account operators with the ability to modify UefiData can install a boot variable with a command line that deactivates root file system integrity validation, while preserving the original PCR4 value.\n\nSystemd-boot provides separate measurement of command line modifications in PCR12.\n\n## Impact\n\nIn line with the TPM 2.0 specification and systemd-stub logic, KMS policies that do not include validation for PCR12 (command line measurement) or PCR7 (enabled Secure Boot) may allow kernel command line modification by an account operator.\n\n## Patches \n\nVersion 1.1.0 of nitro-tpm-pcr-compute has been updated to include PCR12 with a static zero value. The updated tool now outputs PCR12 in the JSON measurements:\n\n```json\n{\n  \"Measurements\": {\n    \"HashAlgorithm\": \"SHA384\",\n    \"PCR4\": \"\u003chex string\u003e\",\n    \"PCR7\": \"\u003chex string\u003e\",\n    \"PCR12\": \"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n  }\n}\n```\n\n## Workarounds\n\nFor users who cannot upgrade to version 1.1.0 of nitro-tpm-pcr-compute immediately, the following workarounds are available:\n\n1. **Manually add PCR12 to KMS policies:** Add PCR12 with a static zero value to your AWS KMS key policies:\n\n```txt\nkms:RecipientAttestation:NitroTPMPCR12:000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n```\n\n2. **Enable and validate UEFI Secure Boot:** Configure your Attestable AMI to use UEFI Secure Boot and validate its enablement via PCR7 in your KMS policy. When UEFI Secure Boot is active, the command line cannot be overwritten.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "nitro-tpm-pcr-compute",
        "purl": "pkg:cargo/nitro-tpm-pcr-compute"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.1.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-xrv8-2pf5-f3q7/GHSA-xrv8-2pf5-f3q7.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/aws/nitrotpm-attestation-samples/security/advisories/GHSA-xrv8-2pf5-f3q7"
    },
    {
      "type": "WEB",
      "url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/attestable-ami.html"
    },
    {
      "type": "WEB",
      "url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/uefi-secure-boot.html"
    },
    {
      "type": "WEB",
      "url": "https://github.com/aws/NitroTPM-Tools"
    },
    {
      "type": "WEB",
      "url": "https://github.com/aws/NitroTPM-Tools/blob/main/CHANGELOG.md"
    },
    {
      "type": "WEB",
      "url": "https://github.com/aws/NitroTPM-Tools/releases/tag/v1.1.0"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/aws/nitrotpm-attestation-samples"
    },
    {
      "type": "WEB",
      "url": "https://www.freedesktop.org/software/systemd/man/latest/systemd-stub.html"
    }
  ]
}