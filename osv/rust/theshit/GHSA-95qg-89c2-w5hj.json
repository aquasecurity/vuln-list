{
  "id": "GHSA-95qg-89c2-w5hj",
  "modified": "2026-01-04T20:56:14.645708Z",
  "published": "2025-12-30T23:45:51Z",
  "aliases": [
    "CVE-2025-69257",
    "RUSTSEC-2025-0139"
  ],
  "summary": "theshit vulnerable to unsafe loading of user-owned Python rules when running as root",
  "details": "### Impact\n\n**Vulnerability Type:** Local Privilege Escalation (LPE) / Arbitrary Code Execution.\n\nThe application loads custom Python rules and configuration files from user-writable locations (e.g., `~/.config/theshit/`) without validating ownership or permissions when executed with elevated privileges.\n\nIf the tool is invoked with `sudo` or otherwise runs with an effective UID of root, it continues to trust configuration files originating from the unprivileged user's environment. This allows a local attacker to inject arbitrary Python code via a malicious rule or configuration file, which is then executed with root privileges.\n\n**Who is impacted:**\nAny system where this tool is executed with elevated privileges is affected. In environments where the tool is permitted to run via `sudo` without a password (`NOPASSWD`), a local unprivileged user can escalate privileges to root without additional interaction.\n\n### Patches\n\nThe issue has been fixed in version **0.1.1**.\n\nThe patch introduces strict ownership and permission checks for all configuration files and custom rules. The application now enforces that rules are only loaded if they are owned by the effective user executing the tool.\n\nWhen executed with elevated privileges (`EUID=0`), the application refuses to load any files that are not owned by root or that are writable by non-root users. When executed as a non-root user, it similarly refuses to load rules owned by other users. This prevents both vertical and horizontal privilege escalation via execution of untrusted code.\n\n### Workarounds\n\nIf upgrading is not possible, users should avoid executing the pplication with `sudo` or as the root user.\n\nAs a temporary mitigation, ensure that directories containing custom rules and configuration files are owned by root and are not writable by non-root users. Administrators may also audit existing custom rules before running the tool with elevated privileges.\n\n### References\n\n* [Commit fixing the issue](https://github.com/AsfhtgkDavid/theshit/commit/3dc12905cafb5fd47fff4071a05c231f925ac113)\n* CWE-269: Improper Privilege Management\n* CWE-284: Improper Access Control\n* CWE-829: Inclusion of Functionality from Untrusted Control Sphere",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "theshit",
        "purl": "pkg:cargo/theshit"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.1.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-95qg-89c2-w5hj/GHSA-95qg-89c2-w5hj.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/AsfhtgkDavid/theshit/security/advisories/GHSA-95qg-89c2-w5hj"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-69257"
    },
    {
      "type": "WEB",
      "url": "https://github.com/AsfhtgkDavid/theshit/commit/8e0b565e7876a83b0e1cfbacb8af39dadfdcc500"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/AsfhtgkDavid/theshit"
    }
  ]
}