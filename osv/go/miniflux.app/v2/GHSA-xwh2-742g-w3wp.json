{
  "id": "GHSA-xwh2-742g-w3wp",
  "modified": "2026-01-07T19:35:31.518019Z",
  "published": "2026-01-07T19:22:14Z",
  "summary": "Miniflux Media Proxy SSRF via /proxy endpoint allows access to internal network resources",
  "details": "### Summary\nMiniflux's media proxy endpoint (`GET /proxy/{encodedDigest}/{encodedURL}`) can be abused to perform Server-Side Request Forgery (SSRF). An authenticated user can cause Miniflux to generate a signed proxy URL for attacker-chosen media URLs embedded in feed entry content, including internal addresses (e.g., localhost, private RFC1918 ranges, or link-local metadata endpoints). Requesting the resulting `/proxy/...` URL makes Miniflux fetch and return the internal response.\n\n### Details\n- **Vulnerable route**: `GET /proxy/{encodedDigest}/{encodedURL}` (accessible without authentication, but requires a server-generated HMAC-signed URL)\n- **Handler**: `internal/ui/proxy.go` (`(*handler).mediaProxy`)\n- **Trigger**: entry content is rewritten to proxy media URLs (e.g., `mediaproxy.RewriteDocumentWithAbsoluteProxyURL(...)`), producing signed `/proxy/...` URLs.\n- **Root cause**: the proxy validates the URL scheme and HMAC signature, but does not restrict target hosts/IPs. As a result, requests to loopback/private/link-local addresses are allowed and fetched by the server.\n\n### PoC\n1) Run Miniflux 2.2.15 with default configuration (media proxy enabled by default: `MEDIA_PROXY_MODE=http-only`).\n\n2) Log in with any normal user account.\n\n3) Subscribe to a feed you control that contains an entry with an image URL pointing to an internal address reachable from the Miniflux server, e.g.:\n   - `\u003cimg src=\"http://\u003cinternal-target\u003e/secret\"\u003e`\n   (Note: `\u003cinternal-target\u003e` must be reachable *from the Miniflux process/network*; in containerized setups, `127.0.0.1` may not refer to the host.)\n\n4) Open the entry and locate the rewritten media proxy URL (`/proxy/\u003cencodedDigest\u003e/\u003cencodedURL\u003e`) in the rendered HTML/page source.\n\n5) Request the `/proxy/...` URL.\nExpected (vulnerable): Miniflux fetches the internal URL and returns the internal response (SSRF).\n\n### Impact\n**Type**: SSRF (Server-Side Request Forgery) via media proxy  \n**Who is impacted**: Miniflux instances with media proxy enabled (default configuration typically enables it for HTTP/mixed content handling).  \n**Impact**: attackers with a valid Miniflux account can fetch internal resources reachable from the Miniflux server (e.g., localhost services, private network services, and link-local endpoints such as 169.254.169.254), potentially exposing sensitive data.\n\n### Suggested CVSS (v3.1)\n`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N` (Base 6.5)\n\n\n\n\nIf there any questions or issues reproducing this, please contact: jeongwoolee340@gmail.com",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "miniflux.app/v2",
        "purl": "pkg:golang/miniflux.app/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.2.16"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 2.2.15",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-xwh2-742g-w3wp/GHSA-xwh2-742g-w3wp.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/miniflux/v2/security/advisories/GHSA-xwh2-742g-w3wp"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/miniflux/v2"
    }
  ]
}