{
  "id": "GHSA-hr5w-cwwq-2v4m",
  "modified": "2025-01-08T20:47:00Z",
  "published": "2024-03-28T17:07:33Z",
  "aliases": [
    "CVE-2024-29891",
    "GO-2024-2665"
  ],
  "summary": "ZITADEL's Improper Content-Type Validation Leads to Account Takeover via Stored XSS + CSP Bypass",
  "details": "### Impact\n\nZITADEL users can upload their own avatar image and various image types are allowed.\n\nDue to a missing check, an attacker could upload HTML and pretend it is an image to gain access to the victim's account in certain scenarios.\nA possible victim would need to directly open the supposed image in the browser, where a session in ZITADEL needs to be active for this exploit to work.\n\nThe exploit could only be reproduced if the victim was using Firefox. Chrome, Safari as well as Edge did not execute the code.\n\n### Patches\n\n2.x versions are fixed on \u003e= [2.48.3](https://github.com/zitadel/zitadel/releases/tag/v2.48.3)\n2.47.x versions are fixed on \u003e= [2.47.8](https://github.com/zitadel/zitadel/releases/tag/v2.47.8)\n2.46.x versions are fixed on \u003e= [2.46.5](https://github.com/zitadel/zitadel/releases/tag/v2.46.5)\n2.45.x versions are fixed on \u003e= [2.45.5](https://github.com/zitadel/zitadel/releases/tag/v2.45.5)\n2.44.x versions are fixed on \u003e= [2.44.7](https://github.com/zitadel/zitadel/releases/tag/v2.44.7)\n2.43.x versions are fixed on \u003e= [2.43.11](https://github.com/zitadel/zitadel/releases/tag/v2.43.11)\n2.42.x versions are fixed on \u003e= [2.42.17](https://github.com/zitadel/zitadel/releases/tag/v2.42.17)\n\nZITADEL recommends upgrading to the latest versions available in due course.\n\n### Workarounds\n\nThere is no workaround since a patch is already available.\n\n### References\n\nNone\n\n### Questions\n\nIf you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)\n\n### Credits\n\nThanks to Amit Laish â€“ GE Vernova for finding and reporting the vulnerability.\n",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.42.17"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.43.0"
            },
            {
              "fixed": "2.43.11"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.44.0"
            },
            {
              "fixed": "2.44.7"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.45.0"
            },
            {
              "fixed": "2.45.5"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.46.0"
            },
            {
              "fixed": "2.46.5"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.47.0"
            },
            {
              "fixed": "2.47.8"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.48.0"
            },
            {
              "fixed": "2.48.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/03/GHSA-hr5w-cwwq-2v4m/GHSA-hr5w-cwwq-2v4m.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/security/advisories/GHSA-hr5w-cwwq-2v4m"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-29891"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/zitadel/zitadel"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.42.17"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.43.11"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.44.7"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.45.5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.46.5"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.47.8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.48.3"
    }
  ]
}