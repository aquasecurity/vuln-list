{
  "id": "GHSA-j4g7-v4m4-77px",
  "modified": "2025-11-17T19:58:43.820518Z",
  "published": "2025-11-14T21:11:38Z",
  "aliases": [
    "CVE-2025-64717",
    "GO-2025-4124"
  ],
  "summary": "ZITADEL is vulnerable to Account Takeover with deactivated Instance IdP",
  "details": "### Summary\n\nA vulnerability in ZITADEL's federation process allowed auto-linking users from external identity providers to existing users in ZITADEL even if the corresponding IdP was not active or if the organization did not allow federated authentication.\n\n### Impact\n\nThis vulnerability stems from the platform's failure to correctly check or enforce an organization's specific security settings during the authentication flow. An Organization Administrator can explicitly disable an IdP or disallow federation, but this setting was not being honored during the auto-linking process.\n\nThis allowed an unauthenticated attacker to initiate a login using an IdP that should have been disabled for that organization. The platform would incorrectly validate the login and, based on a matching criteria, link the attacker's external identity to an existing internal user account.\n\nThis may result in a full Account Takeover, bypassing the organization's mandated security controls. Note that accounts with MFA enabled can not be taken over by this attack. Also note that only IdPs create on an instance level would allow this to work. IdPs registered on another organization would always be denied in the (auto-)linking process.\n\n### Affected Versions\n\nSystems running one of the following versions are affected:\n- **v4.x**: `4.0.0-rc.1` through `4.6.5`\n- **v3.x**: `3.0.0-rc.1` through `3.4.3`\n- **v2.x**: `2.50.0` through `2.71.18`\n\n### Patches\n\nThe vulnerability has been addressed in the latest release. The patch resolves the issue by correctly validating the organization's login policy before auto-linking an external user.\n\n- v4.x: Upgrade to version [4.6.6](https://github.com/zitadel/zitadel/releases/tag/v4.6.6) or later.\n- v3.x: Update to version [3.4.4](https://github.com/zitadel/zitadel/releases/tag/v3.4.4) or later.\n- v2.x: Update to version [2.71.19](https://github.com/zitadel/zitadel/releases/tag/v2.71.19) or later.\n\n### Workarounds\n\nUpgrading to a patched version is the recommended solution.\n\n### Questions\n\nIf you have any questions or comments about this advisory, please email Zitadel at [security@zitadel.com](mailto:security@zitadel.com)\n\n### Credits\n\nThanks to Jan KÃ¼hnlein - kultify for finding and reporting the vulnerability.",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "4.0.0-rc.1"
            },
            {
              "fixed": "4.6.6"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j4g7-v4m4-77px/GHSA-j4g7-v4m4-77px.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "3.0.0-rc.1"
            },
            {
              "fixed": "3.4.4"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j4g7-v4m4-77px/GHSA-j4g7-v4m4-77px.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.50.0"
            },
            {
              "fixed": "2.71.19"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j4g7-v4m4-77px/GHSA-j4g7-v4m4-77px.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/zitadel/zitadel",
        "purl": "pkg:golang/github.com/zitadel/zitadel"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.80.0-v2.20.0.20240403060621-5b3946b67ef6"
            },
            {
              "fixed": "1.80.0-v2.20.0.20251112124840-33c51deb2040"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-j4g7-v4m4-77px/GHSA-j4g7-v4m4-77px.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/security/advisories/GHSA-j4g7-v4m4-77px"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64717"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/commit/33c51deb20402dd5720e32cfb0c1d5fdc752f2e0"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/zitadel/zitadel"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v2.71.19"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v3.4.4"
    },
    {
      "type": "WEB",
      "url": "https://github.com/zitadel/zitadel/releases/tag/v4.6.6"
    }
  ]
}