{
  "id": "GHSA-g754-hx8w-x2g6",
  "modified": "2025-12-17T00:56:03.775985Z",
  "published": "2025-12-11T16:48:27Z",
  "aliases": [
    "CVE-2025-64702",
    "GO-2025-4233"
  ],
  "related": [
    "CGA-4vqr-44x2-g698",
    "CGA-666p-7frx-3rhh",
    "CGA-7836-4m8g-rhmh",
    "CGA-8g9q-pq95-vp35",
    "CGA-8phg-4448-fw3h",
    "CGA-c9wf-pj5j-cv77",
    "CGA-f8f9-mr5c-r4gv",
    "CGA-pq4f-92mp-hxjp",
    "CGA-rjpq-6978-w42c",
    "CGA-vwf8-3c88-m8gv",
    "CGA-xqxf-3rw3-8595"
  ],
  "summary": "quic-go HTTP/3 QPACK Header Expansion DoS",
  "details": "## Summary\n\nAn attacker can cause excessive memory allocation in quic-go's HTTP/3 client and server implementations by sending a QPACK-encoded HEADERS frame that decodes into a large header field section (many unique header names and/or large values). The implementation builds an `http.Header` (used on the `http.Request` and `http.Response`, respectively), while only enforcing limits on the size of the (QPACK-compressed) HEADERS frame, but not on the decoded header, leading to memory exhaustion.\n\n## Impact\n\nA misbehaving or malicious peer can cause a denial-of-service (DoS) attack on quic-go's HTTP/3 servers or clients by triggering excessive memory allocation, potentially leading to crashes or exhaustion. It affects both servers and clients due to symmetric header construction.\n\n## Details\n\nIn HTTP/3, headers are compressed using QPACK (RFC 9204). quic-go's HTTP/3 server (and client) decodes the QPACK-encoded HEADERS frame into header fields, then constructs an http.Request (or response).\n\n`http3.Server.MaxHeaderBytes` and `http3.Transport.MaxResponseHeaderBytes`, respectively, limit encoded HEADERS frame size (default: 1 MB server, 10 MB client), but not decoded size. A maliciously crafted HEADERS frame can expand to ~50x the encoded size using QPACK static table entries with long names / values.\n\nRFC 9114 requires enforcing decoded field section size limits via SETTINGS, which quic-go did not do.\n\n## The Fix\n\nquic-go now enforces RFC 9114 decoded field section size limits, sending SETTINGS_MAX_FIELD_SECTION_SIZE and using incremental QPACK decoding to check the header size after each entry, aborting early on violations with HTTP 431 (on the server side) and stream reset (on the client side).",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/quic-go/quic-go",
        "purl": "pkg:golang/github.com/quic-go/quic-go"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.57.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-g754-hx8w-x2g6/GHSA-g754-hx8w-x2g6.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/quic-go/quic-go/security/advisories/GHSA-g754-hx8w-x2g6"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64702"
    },
    {
      "type": "WEB",
      "url": "https://github.com/quic-go/quic-go/commit/5b2d2129f8315da41e01eff0a847ab38a34e83a8"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/quic-go/quic-go"
    }
  ]
}