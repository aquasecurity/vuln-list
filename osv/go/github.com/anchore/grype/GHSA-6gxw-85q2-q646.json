{
  "id": "GHSA-6gxw-85q2-q646",
  "modified": "2025-11-25T18:57:29.186808Z",
  "published": "2025-11-25T14:18:46Z",
  "aliases": [
    "CVE-2025-65965",
    "GO-2025-4160"
  ],
  "summary": "Grype has a credential disclosure vulnerability in its JSON output",
  "details": "A credential disclosure vulnerability was found in Grype, affecting versions `v0.68.0` through `v0.104.0`. If registry credentials are defined and the output of grype is written using the `--file` or `--output json=\u003cfile\u003e` option, the registry credentials will be included unsanitized in the output file.\n\n## Impact\n\nIn Grype versions `v0.68.0` through `v0.104.0`, when registry authentication is configured, those credentials can be incorrectly included in the output of a Grype scan (regardless of whether those credentials are actively being used for the current scan). Users that do not have registry authentication configured are not affected by this issue.\n\nRegistry credentials can be set via the Grype configuration file (e.g. `registry.auth[].username`, `registry.auth[].password`, `registry.auth[].token`) or environment variables (e.g., `GRYPE_REGISTRY_AUTH_USERNAME`, `GRYPE_REGISTRY_AUTH_PASSWORD`, `GRYPE_REGISTRY_AUTH_TOKEN`).\n\nIn order for the authentication details to be improperly included, the Grype file output format must be set to `json` with output target set to a file. For example `--output json=file.json` or `--output json --file file.json`. When these conditions are met, the configured credentials are not sanitized as they should be in the resulting JSON output file.\n\nThe authentication details could also be leaked via a malformed Grype Template. A Grype Template that includes the `Descriptor.Registry.Auth` fields would also include the unsanitized registry credentials. There are no known templates that include these fields.\n\n## Patches\nThe patch has been released in `v0.104.1`.\n\n## Workaround\nUsers running affected versions of grype can work around this vulnerability by redirecting stdout to a file instead of using the `--file` or `--output` options.\n\nFor example, replacing the command:\n\n```\n# using `--output json=path` (or `--file`) leaks credentials\ngrype --output json=test.json alpine:latest\n```\n\nwith\n\n```\n# no use of `--output json=path` or `--file`. Output is sanitized...\ngrype --output json alpine:latest \u003e test.json\n```\n\n...results in the same `test.json` output, but the credentials will be properly sanitized.\n\n## Resources\nPatch pull request: https://github.com/anchore/grype/pull/3068",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/anchore/grype",
        "purl": "pkg:golang/github.com/anchore/grype"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.68.0"
            },
            {
              "fixed": "0.104.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-6gxw-85q2-q646/GHSA-6gxw-85q2-q646.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/anchore/grype/security/advisories/GHSA-6gxw-85q2-q646"
    },
    {
      "type": "WEB",
      "url": "https://github.com/anchore/grype/pull/3068"
    },
    {
      "type": "WEB",
      "url": "https://github.com/anchore/grype/commit/c99f79de49a58dc16d7fd8f35160b169b87db9de"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/anchore/grype"
    }
  ]
}