{
  "id": "GHSA-66jq-2c23-2xh5",
  "modified": "2025-11-27T09:16:08.278006Z",
  "published": "2025-11-25T20:40:13Z",
  "aliases": [
    "CVE-2025-65942"
  ],
  "summary": "VictoriaMetrics' Snappy Decoder DoS Vulnerability is Causing OOM",
  "details": "### Impact\nAffected versions are vulnerable to DoS attacks because the snappy decoder ignored VictoriaMetrics request size limits allowing malformed blocks to trigger excessive memory use. This could lead to OOM errors and service instability. The fix enforces block-size checks based on MaxRequest limits.\n\n### Patches\nVersions 1.129.1, 1.122.8, 1.110.23\n\n### Resources\n - https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.129.1\n - https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.122.8\n - https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.110.23\n \n### Note \nVictoriaMetrics' security model assumes its APIs are properly secured (e.g. via access control flags or a firewall); this advisory addresses malicious input that should not be possible under a [correctly secured](https://docs.victoriametrics.com/victoriametrics/single-server-victoriametrics/#security) deployment.",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/VictoriaMetrics/VictoriaMetrics",
        "purl": "pkg:golang/github.com/VictoriaMetrics/VictoriaMetrics"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.123.0"
            },
            {
              "fixed": "1.129.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-66jq-2c23-2xh5/GHSA-66jq-2c23-2xh5.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/VictoriaMetrics/VictoriaMetrics",
        "purl": "pkg:golang/github.com/VictoriaMetrics/VictoriaMetrics"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.111.0"
            },
            {
              "fixed": "1.122.8"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-66jq-2c23-2xh5/GHSA-66jq-2c23-2xh5.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/VictoriaMetrics/VictoriaMetrics",
        "purl": "pkg:golang/github.com/VictoriaMetrics/VictoriaMetrics"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.0.0"
            },
            {
              "fixed": "1.110.23"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-66jq-2c23-2xh5/GHSA-66jq-2c23-2xh5.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/security/advisories/GHSA-66jq-2c23-2xh5"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-65942"
    },
    {
      "type": "WEB",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/commit/51b44afd34d2c9a392d4ebedeeb5b4a7f5beca24"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics"
    },
    {
      "type": "WEB",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.110.23"
    },
    {
      "type": "WEB",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.122.8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/VictoriaMetrics/VictoriaMetrics/releases/tag/v1.129.1"
    }
  ]
}