{
  "id": "GHSA-mw39-9qc2-f7mg",
  "modified": "2025-10-31T20:21:17Z",
  "published": "2025-10-24T15:27:13Z",
  "aliases": [
    "CVE-2024-58269"
  ],
  "summary": "Rancher exposes sensitive information through audit logs",
  "details": "### Impact\n**Note: The exploitation of this issue requires that the malicious user have access to Rancherâ€™s audit log storage.**\n\nA vulnerability has been identified in Rancher Manager, where sensitive information, including secret data, cluster import URLs, and registration tokens, is exposed to any entity with access to Rancher audit logs. This happens in two different ways:\n\n1. Secret Annotation Leakage: When creating Kubernetes Secrets using the `stringData` field, the cleartext value is embedded in the `kubectl.kubernetes.io/last-applied-configuration` annotation. This annotation is included in Rancher audit logs within both the request and response bodies, exposing secret material that should be redacted.\n2. Cluster Registration Token Leakage: During the import or creation of downstream clusters (Custom, Imported, or Harvester), Rancher audit logs record full cluster registration manifests and tokens, including:\na. Non-expiring import URLs such as `/v3/import/\u003ctoken\u003e_c-m-xxxx.yaml`.\nb. Full `kubectl apply` and `curl` commands containing registration tokens and CA checksums.\nc. Token values associated with cluster registration resources (`clusterRegistrationToken`).\nd. These tokens are valid until explicitly revoked and can be used to re-register nodes, granting unauthorized cluster access.\n\nAn attacker or internal user who gains access to these logs could:\n- Recover plaintext secret values from annotations.\n- Use cluster registration tokens or import URLs to re-enroll agents or compromise downstream clusters.\n- Access clusters that rely on these tokens for authentication, enabling lateral movement.\n\nPlease consult the associated  [MITRE ATT\u0026CK - Technique - Log Enumeration](https://attack.mitre.org/techniques/T1654/) for further information about this category of attack.\n\n### Patches\nThis vulnerability is addressed by applying redaction to sensitive information that was leaking.\n\nPatched versions of Rancher include release `v2.12.3`.\n\n### Workarounds\nIf the deployment can't be upgraded to a fixed version, users are encouraged to create `AuditPolicies` to redact and filter some of those requests as described in our [documentation](https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-api-audit-log#audit-log-policies).\n\nThe following AuditPolicy can be applied to redact the secrets:\n```yaml\napiVersion: auditlog.cattle.io/v1\nkind: AuditPolicy\nmetadata:\n  name: redactions\nspec:\n  enabled: true\n  additionalRedactions:\n    - headers:\n      - \"Referer\"\n    - paths:\n      - \"$..metadata.annotations['kubectl.kubernetes.io/last-applied-configuration']\"\n```\n\nAlso consider granting access to Rancher's logs only for trusted users.\n\n\n### References\nIf you have any questions or comments about this advisory:\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/rancher",
        "purl": "pkg:golang/github.com/rancher/rancher"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.0.0-20251013203444-50dc516a19ea"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/10/GHSA-mw39-9qc2-f7mg/GHSA-mw39-9qc2-f7mg.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/rancher/rancher/security/advisories/GHSA-mw39-9qc2-f7mg"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-58269"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rancher/rancher/commit/26ad9216e94f77b5471f638256a6989030572adc"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rancher/rancher/commit/50dc516a19ea216e270f738912dc8d0c9ca99d5d"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58269"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/rancher/rancher"
    }
  ]
}