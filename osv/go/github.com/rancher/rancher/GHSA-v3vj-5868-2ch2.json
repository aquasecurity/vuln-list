{
  "id": "GHSA-v3vj-5868-2ch2",
  "modified": "2025-10-02T15:11:56Z",
  "published": "2025-09-26T13:02:44Z",
  "aliases": [
    "CVE-2024-58267"
  ],
  "summary": "Rancher CLI SAML authentication is vulnerable to phishing attacks",
  "details": "### Impact\n\nA vulnerability has been identified within Rancher Manager whereby the SAML authentication from the Rancher CLI  tool is vulnerable to phishing attacks. The custom authentication protocol for SAML-based providers can be abused to steal Rancher’s authentication tokens.\n\nRancher Manager deployments without SAML authentication enabled are not affected by this vulnerability.\n\nAn attacker can generate a phishing SAML login URL which contains a `publicKey` and `requestId` controlled by the attacker. The attacker can then give the link to another user (eg: admin) and if the victim goes to the link unsuspectingly, they might not notice the bad parameters in the URL. The user will be prompted to login and might believe that its session has ended so they need to re-login. By clicking on the link, they will be logged in and an encrypted token will be created with the attacker's public key. The attacker can then decrypt the victim’s Rancher token, enabling the attack\n\nPlease consult the associated [MITRE ATTACK Techniques - Privilege Escalation](https://attack.mitre.org/tactics/TA0004/) for further information about this category of attack.\n\n### Patches\n\nThis vulnerability is addressed by changes in both Rancher Manager and the CLI. The fixed versions:\n\n1. The Rancher CLI now reports the `requestId` that is relevant to the authentication session in process as a separate message to the terminal, making it easier for the user to identify and compare.\n2. The Rancher login page for SAML authentication will display a suitable warning to ensure that the user seeing the login page is aware of the login process with the related `requestId`, enabling users to verify whether the request was intended or not.\n\nPatched versions of Rancher include releases v2.12.2, v2.11.6, v2.10.10, and v2.9.12.\n\n### Workarounds\n\nIf you cannot update to one of the fixed versions, make sure to check the URL printed by the Rancher CLI when performing a SAML authentication flow, especially the `requestId` parameter. The URL and the `requestId` printed by the CLI must be the same URL that you access and see when finalizing the SAML authentication flow in your browser for the Rancher UI. The URL has the format:\n\n-  `\u003crancher_ui_address\u003e/dashboard/auth/login?requestId=\u003crequestid\u003e\u0026publicKey=\u003cpubkey\u003e\u0026responseType=\u003cresponsetype\u003e` \n\nIf the URL presented in the browser is different from the one logged by the CLI, the user must not proceed with the login, as they might be under a phishing attack.\n\n### References\n\nIf you have any questions or comments about this advisory:\n\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/rancher",
        "purl": "pkg:golang/github.com/rancher/rancher"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.12.0"
            },
            {
              "fixed": "2.12.2"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-v3vj-5868-2ch2/GHSA-v3vj-5868-2ch2.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/rancher",
        "purl": "pkg:golang/github.com/rancher/rancher"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.11.0"
            },
            {
              "fixed": "2.11.6"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-v3vj-5868-2ch2/GHSA-v3vj-5868-2ch2.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/rancher",
        "purl": "pkg:golang/github.com/rancher/rancher"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.10.0"
            },
            {
              "fixed": "2.10.10"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-v3vj-5868-2ch2/GHSA-v3vj-5868-2ch2.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/rancher/rancher",
        "purl": "pkg:golang/github.com/rancher/rancher"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "2.9.0"
            },
            {
              "fixed": "2.9.12"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-v3vj-5868-2ch2/GHSA-v3vj-5868-2ch2.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-58267"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/rancher/rancher"
    }
  ]
}