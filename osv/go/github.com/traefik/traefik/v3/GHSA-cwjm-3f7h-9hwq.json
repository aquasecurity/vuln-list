{
  "id": "GHSA-cwjm-3f7h-9hwq",
  "modified": "2026-01-23T02:56:12.843177Z",
  "published": "2026-01-15T22:58:23Z",
  "aliases": [
    "CVE-2026-22045",
    "GO-2026-4322"
  ],
  "summary": "Traefik's ACME TLS-ALPN fast path lacks timeouts and close on handshake stall",
  "details": "## Impact\n\nThere is a potential vulnerability in Traefik ACME TLS certificates' automatic generation: the ACME TLS-ALPN fast path can allow unauthenticated clients to tie up goroutines and file descriptors indefinitely when the ACME TLS challenge is enabled.\n\nA malicious client can open many connections, send a minimal ClientHello with `acme-tls/1`, then stop responding, leading to denial of service of the entrypoint.  \n\n## Patches\n\n- https://github.com/traefik/traefik/releases/tag/v2.11.35\n- https://github.com/traefik/traefik/releases/tag/v3.6.7\n\n## For more information\n\nIf you have any questions or comments about this advisory, please [open an issue](https://github.com/traefik/traefik/issues).\n\n\u003cdetails\u003e\n\u003csummary\u003eOriginal Description\u003c/summary\u003e\n\n# \\[Security\\] ACME TLS-ALPN fast path lacks timeouts and close on handshake stall\n\nDear Traefik security team,\n\nWe believe we have identified a resource-exhaustion issue in the ACME TLS-ALPN fast path that can allow unauthenticated clients to tie up goroutines and file descriptors indefinitely when the ACME TLS challenge is enabled.\n\n## Summary\n\n- Affected code: `pkg/server/router/tcp/router.go` (ACME TLS-ALPN handling).  \n- When a ClientHello advertises `acme-tls/1`, Traefik intercepts it and calls `tls.Server(...).Handshake()` without any read/write deadlines and without closing the connection afterward.  \n- Immediately before this branch, existing deadlines set by the entrypoint are cleared.  \n- A client that sends the ALPN marker and then stops responding can keep the goroutine and socket open indefinitely, potentially exhausting the entrypoint under load.  \n- Exposure is limited to entrypoints where the ACME TLS-ALPN challenge is enabled and ACME bypass is not allowed.\n\n## Relevant snippets\n```143:171:pkg/server/router/tcp/router.go\n// Deadlines are cleared before protocol dispatch\nif err := conn.SetDeadline(time.Time{}); err != nil {\n    log.Error().Err(err).Msg(\"Error while setting deadline\")\n}\n\n// ACME TLS-ALPN fast path\nif !r.acmeTLSPassthrough \u0026\u0026 slices.Contains(hello.protos, tlsalpn01.ACMETLS1Protocol) {\n    r.acmeTLSALPNHandler().ServeTCP(r.GetConn(conn, hello.peeked))\n    return\n}\n```\n\n```224:226:pkg/server/router/tcp/router.go\n// Handler invoked by the branch above\nreturn tcp.HandlerFunc(func(conn tcp.WriteCloser) {\n    _ = tls.Server(conn, r.httpsTLSConfig).Handshake()\n})\n```\n\n## Impact\n\n- Each stalled handshake consumes a goroutine and FD with no timeout and no server-side close.  \n- A malicious client can open many connections, send a minimal ClientHello with `acme-tls/1`, then stop responding, leading to denial of service of the entrypoint.  \n- Normal HTTPS handling uses `http.Server` timeouts; this bespoke path bypasses them.\n\n## Conditions for exploitation\n\n- ACME TLS-ALPN challenge enabled (default when configured).  \n- `allowACMEByPass` disabled for the entrypoint (the default when ACME TLS challenge is handled by Traefik).\n\n## CWE\n\n- CWE-400: Uncontrolled Resource Consumption.\n\n## Proposed fix (illustrative)\n\n```\n@@ func (r *Router) acmeTLSALPNHandler() tcp.Handler {\n-    return tcp.HandlerFunc(func(conn tcp.WriteCloser) {\n-        _ = tls.Server(conn, r.httpsTLSConfig).Handshake()\n-    })\n+    return tcp.HandlerFunc(func(conn tcp.WriteCloser) {\n+        // Ensure the handshake cannot block indefinitely and always closes the socket.\n+        _ = conn.SetReadDeadline(time.Now().Add(10 * time.Second))\n+        _ = conn.SetWriteDeadline(time.Now().Add(10 * time.Second))\n+\n+        tlsConn := tls.Server(conn, r.httpsTLSConfig)\n+        _ = tlsConn.Handshake()\n+        _ = tlsConn.Close() // close regardless of handshake outcome\n+    })\n }\n```\n\nAlternatively, route ACME TLS-ALPN through the existing `tcp.TLSHandler`/HTTP server path so the configured timeouts and lifecycle management apply automatically.\n\n## CVSS v3.1 (estimate)\n\n- Vector: AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H  \n- Base score: 7.5 (High)  \n- Rationale: Network-only, no auth/user interaction required; impact is service availability via resource exhaustion; no confidentiality or integrity impact.\n\nPlease let us know if you would like a PoC or further details. We have not made any code changes in this report.\n\nLet us know if you have any questions or need clarification\\!\n\nBest wishes,  \nPavel Kohout  \n Aisle Research  \n\u003c/details\u003e",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/traefik/traefik/v3",
        "purl": "pkg:golang/github.com/traefik/traefik/v3"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "3.6.7"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 3.6.6",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cwjm-3f7h-9hwq/GHSA-cwjm-3f7h-9hwq.json"
      }
    },
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/traefik/traefik/v2",
        "purl": "pkg:golang/github.com/traefik/traefik/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.11.35"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 2.11.34",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-cwjm-3f7h-9hwq/GHSA-cwjm-3f7h-9hwq.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/traefik/traefik/security/advisories/GHSA-cwjm-3f7h-9hwq"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-22045"
    },
    {
      "type": "WEB",
      "url": "https://github.com/traefik/traefik/commit/e9f3089e9045812bcf1b410a9d40568917b26c3d"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/traefik/traefik"
    },
    {
      "type": "WEB",
      "url": "https://github.com/traefik/traefik/releases/tag/v2.11.35"
    },
    {
      "type": "WEB",
      "url": "https://github.com/traefik/traefik/releases/tag/v3.6.7"
    }
  ]
}