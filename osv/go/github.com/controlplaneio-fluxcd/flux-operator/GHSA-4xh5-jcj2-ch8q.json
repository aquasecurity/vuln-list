{
  "id": "GHSA-4xh5-jcj2-ch8q",
  "modified": "2026-01-21T22:41:18.798857Z",
  "published": "2026-01-21T22:23:33Z",
  "aliases": [
    "CVE-2026-23990"
  ],
  "summary": "Flux Operator Web UI Impersonation Bypass via Empty OIDC Claims",
  "details": "A privilege escalation vulnerability exists in the Flux Operator Web UI authentication code that allows an attacker to bypass Kubernetes RBAC impersonation and execute API requests with the operator's service account privileges.\n\nAfter OIDC token claims are processed through CEL expressions, there is no validation that the resulting `username` and `groups` values are non-empty. When both values are empty, the Kubernetes client-go library does not add impersonation headers to API requests, causing them to be executed with the flux-operator service account's credentials instead of the authenticated user's limited permissions.\n\n### Impact\n\n- **Privilege Escalation**: Any authenticated user can escalate to operator-level read permissions and perform suspend/resume/reconcile actions\n- **Data Exposure**: Unauthorized read access to Flux resources across all namespaces, bypassing RBAC restrictions\n- **Information Disclosure**: View sensitive GitOps pipeline configurations, source URLs, and deployment status across the entire cluster\n\n### Attack Scenario\n\n**Prerequisite**: Cluster admins must configure the Flux Operator with an OIDC provider that issues tokens lacking the expected claims (e.g., `email`, `groups`), or configure custom CEL expressions that can evaluate to empty values.\n\n1. Cluster admin configures OIDC authentication with a provider that does not include `email` or `groups` claims in tokens\n2. User authenticates with a valid token from that provider\n3. The default CEL expressions evaluate to empty values:\n   - Username: `has(claims.email) ? claims.email : ''` → `\"\"`\n   - Groups: `has(claims.groups) ? claims.groups : []` → `[]`\n4. Authentication succeeds (token signature is valid)\n5. A userClient is created with empty impersonation config\n6. All subsequent API requests bypass impersonation and execute as the flux-operator service account\n7. User gains operator-level read access across all namespaces\n\n### Patches\n\nThis vulnerability was fixed in Flux Operator v0.40.0.\n\n### Workarounds\n\nThe workaround is to make the `email` and `groups` claims required in the web config `impersonation` section.\n\nExample config:\n\n```yaml\napiVersion: web.fluxcd.controlplane.io/v1\nkind: Config\nspec:\n  baseURL: https://flux.example.com\n  authentication:\n    type: OAuth2\n    oauth2:\n      provider: OIDC\n      clientID: \"\u003credacted\u003e\"\n      clientSecret: \"\u003credacted\u003e\"\n      issuerURL: \"https://login.microsoftonline.com/\u003credacted\u003e/v2.0\"\n      scopes: [openid, profile, email, offline_access]\n      impersonation:\n        username: claims.email\n        groups: claims.groups\n```\n\n### References\n\nSee the Pull Request fixing this vulnerability https://github.com/controlplaneio-fluxcd/flux-operator/pull/610 \n\n### Credits\n\nThis vulnerability was discovered by the Flux Operator maintainers during a debugging session with end-users.",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/controlplaneio-fluxcd/flux-operator",
        "purl": "pkg:golang/github.com/controlplaneio-fluxcd/flux-operator"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0.36.0"
            },
            {
              "fixed": "0.40.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-4xh5-jcj2-ch8q/GHSA-4xh5-jcj2-ch8q.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/controlplaneio-fluxcd/flux-operator/security/advisories/GHSA-4xh5-jcj2-ch8q"
    },
    {
      "type": "WEB",
      "url": "https://github.com/controlplaneio-fluxcd/flux-operator/pull/610"
    },
    {
      "type": "WEB",
      "url": "https://github.com/controlplaneio-fluxcd/flux-operator/commit/084540424f6de8ba5d88fb1fd1e8472ba29afd7e"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/controlplaneio-fluxcd/flux-operator"
    },
    {
      "type": "WEB",
      "url": "https://github.com/controlplaneio-fluxcd/flux-operator/releases/tag/v0.40.0"
    }
  ]
}