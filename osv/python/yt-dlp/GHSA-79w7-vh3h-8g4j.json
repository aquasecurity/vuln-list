{
  "id": "GHSA-79w7-vh3h-8g4j",
  "modified": "2025-01-14T12:26:54.765069Z",
  "published": "2024-07-02T15:58:35Z",
  "aliases": [
    "CVE-2024-38519"
  ],
  "related": [
    "CVE-2024-38519"
  ],
  "summary": "yt-dlp File system modification and RCE through improper file-extension sanitization",
  "details": "### Summary\n`yt-dlp` does not limit the extensions of downloaded files, which could lead to arbitrary filenames being created in the download folder (and path traversal on Windows). Since `yt-dlp` also reads config from the working directory (and on Windows executables will be executed from the yt-dlp directory) this could lead to arbitrary code being executed.\n\n### Patches\n`yt-dlp` version 2024.07.01 fixes this issue by whitelisting the allowed extensions.\nThis means some very uncommon extensions might not get downloaded; however, it will also limit the possible exploitation surface.\n\n### Workarounds\nIt is recommended to upgrade yt-dlp to version 2024.07.01 as soon as possible, **always** have `.%(ext)s` at the end of the output template, and make sure you trust the websites that you are downloading from. Also, make sure to never download to a directory within PATH or other sensitive locations like your user directory, `system32`, or other binaries locations.\n\nFor users not able to upgrade:\n- Make sure the extension of the media to download is a common video/audio/sub/... one\n- Try to avoid the generic extractor (`--ies default,-generic`)\n- Keep the default output template (`-o \"%(title)s [%(id)s].%(ext)s`)\n- Omit any of the subtitle options (`--write-subs`, `--write-auto-subs`, `--all-subs`, `--write-srt`)\n- Use `--ignore-config --config-location ...` to not load config from common locations\n\n### Details\nOne potential exploitation might look like this:\n\nFrom a mimetype we do not know, we default to trimming the leading bit and using the remainder. Given a webpage that contains\n```html\n\u003cscript type=\"application/ld+json\"\u003e\n{\n    \"@context\": \"https://schema.org\",\n    \"@type\": \"VideoObject\",\n    \"name\": \"ffmpeg\",\n    \"encodingFormat\": \"video/exe\",\n    \"contentUrl\": \"https://example.com/video.mp4\"\n}\n\u003c/script\u003e\n```\nthis will try and download a file called `ffmpeg.exe` (`-o \"%(title)s.%(ext)s`).\n`ffmpeg.exe` will be searched for in the current directory, and so upon the next run arbitrary code can be executed.\n\nAlternatively, when engineering a file called `yt-dlp.conf` to be created, the config file could contain `--exec ...` and so would also execute arbitrary code.\n\n### Acknowledgement\nA big thanks to @JarLob for independently finding a new application of the same underlying issue.\nMore can be read about on the dedicated GitHub Security Lab disclosure here: [Path traversal saving subtitles (GHSL-2024-090)](\u003chttps://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp\u003e)\n\n### References\n- https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j\n- https://nvd.nist.gov/vuln/detail/CVE-2024-38519\n- https://github.com/yt-dlp/yt-dlp/releases/tag/2024.07.01\n- https://github.com/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a\n- https://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp\n",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "yt-dlp",
        "purl": "pkg:pypi/yt-dlp"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2024.07.01"
            }
          ]
        }
      ],
      "versions": [
        "2021.1.15",
        "2021.1.15.post1",
        "2021.1.16",
        "2021.1.20",
        "2021.1.24",
        "2021.1.24.post1",
        "2021.1.29",
        "2021.10.10",
        "2021.10.22",
        "2021.10.9",
        "2021.11.10",
        "2021.11.10.1",
        "2021.12.1",
        "2021.12.25",
        "2021.12.27",
        "2021.2.15",
        "2021.2.19",
        "2021.2.24",
        "2021.2.4",
        "2021.2.9",
        "2021.3.1",
        "2021.3.15",
        "2021.3.21",
        "2021.3.24",
        "2021.3.24.1",
        "2021.3.3",
        "2021.3.3.1",
        "2021.3.3.2",
        "2021.3.7",
        "2021.4.11",
        "2021.4.22",
        "2021.4.3",
        "2021.5.11",
        "2021.5.20",
        "2021.6.1",
        "2021.6.23",
        "2021.6.8",
        "2021.6.9",
        "2021.7.21",
        "2021.7.24",
        "2021.7.7",
        "2021.8.10",
        "2021.8.2",
        "2021.9.1",
        "2021.9.2",
        "2021.9.25",
        "2022.1.21",
        "2022.10.4",
        "2022.11.11",
        "2022.2.3",
        "2022.2.4",
        "2022.3.8",
        "2022.3.8.1",
        "2022.3.8.2",
        "2022.4.8",
        "2022.5.18",
        "2022.6.22",
        "2022.6.22.1",
        "2022.6.29",
        "2022.7.17",
        "2022.7.18",
        "2022.8.14",
        "2022.8.19",
        "2022.8.8",
        "2022.9.1",
        "2023.1.2",
        "2023.1.6",
        "2023.10.13",
        "2023.10.7",
        "2023.11.13.232715.dev0",
        "2023.11.13.5826.dev0",
        "2023.11.14",
        "2023.11.15.232826.dev0",
        "2023.11.16",
        "2023.11.16.232727.dev0",
        "2023.11.18.232705.dev0",
        "2023.11.19.232719.dev0",
        "2023.11.20.232729.dev0",
        "2023.11.26.232703.dev0",
        "2023.11.28.232715.dev0",
        "2023.11.29.232714.dev0",
        "2023.12.12.232727.dev0",
        "2023.12.13.232710.dev0",
        "2023.12.17.232710.dev0",
        "2023.12.18.232711.dev0",
        "2023.12.19.232701.dev0",
        "2023.12.20.232717.dev0",
        "2023.12.21.232720.dev0",
        "2023.12.22.232735.dev0",
        "2023.12.24.232657.dev0",
        "2023.12.26.232752.dev0",
        "2023.12.30",
        "2023.12.30.232719.dev0",
        "2023.12.31.232713.dev0",
        "2023.12.5.232702.dev0",
        "2023.12.6.232721.dev0",
        "2023.2.17",
        "2023.3.3",
        "2023.3.4",
        "2023.6.21",
        "2023.6.22",
        "2023.7.6",
        "2023.9.24",
        "2024.1.14.232710.dev0",
        "2024.1.18.232658.dev0",
        "2024.1.19.232708.dev0",
        "2024.1.2.232714.dev0",
        "2024.1.20.232722.dev0",
        "2024.1.21.232719.dev0",
        "2024.1.22.232713.dev0",
        "2024.1.23.232723.dev0",
        "2024.1.28.232706.dev0",
        "2024.1.29.232706.dev0",
        "2024.1.31.232703.dev0",
        "2024.1.5.232702.dev0",
        "2024.1.8.232709.dev0",
        "2024.1.9.232723.dev0",
        "2024.2.13.232701.dev0",
        "2024.2.14.232704.dev0",
        "2024.2.15.232705.dev0",
        "2024.2.16.232705.dev0",
        "2024.2.17.232706.dev0",
        "2024.2.18.232707.dev0",
        "2024.2.19.232703.dev0",
        "2024.2.2.232707.dev0",
        "2024.2.20.232712.dev0",
        "2024.2.21.232721.dev0",
        "2024.2.22.232849.dev0",
        "2024.2.23.232656.dev0",
        "2024.2.24.232815.dev0",
        "2024.2.25.232703.dev0",
        "2024.2.28.232744.dev0",
        "2024.2.29.232658.dev0",
        "2024.2.3.232712.dev0",
        "2024.2.4.232659.dev0",
        "2024.2.5.232712.dev0",
        "2024.2.9.232659.dev0",
        "2024.3.10",
        "2024.3.10.232703.dev0",
        "2024.3.14.232657.dev0",
        "2024.3.17.232657.dev0",
        "2024.3.18.232707.dev0",
        "2024.3.19.232701.dev0",
        "2024.3.2.232720.dev0",
        "2024.3.20.232704.dev0",
        "2024.3.22.232703.dev0",
        "2024.3.29.232706.dev0",
        "2024.3.3.232706.dev0",
        "2024.3.30.232704.dev0",
        "2024.3.31.232706.dev0",
        "2024.3.4.232716.dev0",
        "2024.3.6.232659.dev0",
        "2024.3.7.232716.dev0",
        "2024.3.8.232718.dev0",
        "2024.3.9.232714.dev0",
        "2024.4.1.232704.dev0",
        "2024.4.13.232802.dev0",
        "2024.4.18.232703.dev0",
        "2024.4.20.232659.dev0",
        "2024.4.21.232710.dev0",
        "2024.4.28.232723.dev0",
        "2024.4.3.233315.dev0",
        "2024.4.4.232729.dev0",
        "2024.4.6.232655.dev0",
        "2024.4.7.232657.dev0",
        "2024.4.8.232708.dev0",
        "2024.4.9",
        "2024.4.9.232723.dev0",
        "2024.5.10.232705.dev0",
        "2024.5.11.232654.dev0",
        "2024.5.12.232709.dev0",
        "2024.5.13.232704.dev0",
        "2024.5.16.232713.dev0",
        "2024.5.17.232726.dev0",
        "2024.5.18.232655.dev0",
        "2024.5.20.232721.dev0",
        "2024.5.22.232749.dev0",
        "2024.5.23.232707.dev0",
        "2024.5.25.232709.dev0",
        "2024.5.26",
        "2024.5.26.232731.dev0",
        "2024.5.27",
        "2024.5.27.232744.dev0",
        "2024.5.29.232700.dev0",
        "2024.5.30.232720.dev0",
        "2024.5.4.232706.dev0",
        "2024.5.5.232701.dev0",
        "2024.5.8.232715.dev0",
        "2024.6.1.232725.dev0",
        "2024.6.11.232712.dev0",
        "2024.6.13.232720.dev0",
        "2024.6.15.232712.dev0",
        "2024.6.16.232832.dev0",
        "2024.6.17.232743.dev0",
        "2024.6.20.232815.dev0",
        "2024.6.21.232706.dev0",
        "2024.6.22.232706.dev0",
        "2024.6.24.232830.dev0",
        "2024.6.27.232805.dev0",
        "2024.6.29.232730.dev0",
        "2024.6.30.232744.dev0"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-79w7-vh3h-8g4j/GHSA-79w7-vh3h-8g4j.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/dirkf/youtube-dl/security/advisories/GHSA-22fp-mf44-f2mq"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-79w7-vh3h-8g4j"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-38519"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ytdl-org/youtube-dl/pull/32830"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yt-dlp/yt-dlp/commit/5ce582448ececb8d9c30c8c31f58330090ced03a"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ytdl-org/youtube-dl/commit/d42a222ed541b96649396ef00e19552aef0f09ec"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/yt-dlp/yt-dlp"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yt-dlp/yt-dlp/releases/tag/2024.07.01"
    },
    {
      "type": "ADVISORY",
      "url": "https://securitylab.github.com/advisories/GHSL-2024-089_youtube-dl"
    },
    {
      "type": "ADVISORY",
      "url": "https://securitylab.github.com/advisories/GHSL-2024-090_yt-dlp"
    }
  ]
}