{
  "id": "GHSA-g2jx-37x6-6438",
  "modified": "2025-12-02T18:27:49.172827Z",
  "published": "2025-12-02T17:55:44Z",
  "aliases": [
    "CVE-2025-66454"
  ],
  "summary": "arcade-mcp-server Has Default Hardcoded Worker Secret That Allows Full Unauthorized Access to All HTTP MCP Worker Endpoints",
  "details": "### Summary\n\nThe arcade-mcp HTTP server uses a hardcoded default worker secret (\"dev\") that is never validated or overridden during normal server startup. As a result, any unauthenticated attacker who knows this default key can forge valid JWTs and fully bypass the FastAPI authentication layer. This grants remote access to all worker endpoints—including tool enumeration and tool invocation—without credentials.\n\nAnyone following the official quick-start guide is vulnerable unless they manually override ARCADE_WORKER_SECRET.\n\n### Details\n\nThe documented method for launching an HTTP MCP server (python server.py http) implicitly sets the worker secret to the hardcoded default \"dev\":\n\nArcadeSettings.server_secret defaults to \"dev\"\n(libs/arcade-mcp-server/arcade_mcp_server/settings.py:129–158)\n\ncreate_arcade_mcp() passes this value directly to FastAPIWorker without validation\n(libs/arcade-mcp-server/arcade_mcp_server/worker.py:118–188)\n\nBaseWorker._set_secret() accepts this value and does not enforce rotation\n(libs/arcade-serve/arcade_serve/core/base.py:42–83)\n\nBecause the worker’s signing key is constant and publicly documented, attackers can trivially generate valid HS256 JWTs:\n\nThe FastAPI worker auth middleware (arcade_serve/fastapi/auth.py) trusts any JWT signed with the worker secret.\n\nThe core auth layer (arcade_serve/core/auth.py) does not distinguish forged tokens from legitimate ones.\n\nThe official quick-start instructions (README.md:164–190) demonstrate launching an MCP server without mentioning worker-secret rotation. Users are told how to define tool secrets in .env, but not that the worker’s authentication key must be changed.\n\nAs a result, servers deployed following the documented workflow expose all /worker/* endpoints to anyone capable of generating a simple HS256 token using the known key.\n\nThis CVE was resolved by https://github.com/ArcadeAI/arcade-mcp/pull/691\n\n### PoC\n\nStart the server using the official guide\nhttps://docs.arcade.dev/en/home/build-tools/create-a-mcp-server\n\nVerify that unauthenticated access is rejected (expected)\n```\ncurl -s -D - http://127.0.0.1:8000/worker/tools\n# → 403 Forbidden\n```\n\nForge a valid HS256 token using the hardcoded default secret \"dev\"\n```\nimport jwt\nprint(jwt.encode({'ver': '1', 'aud': 'worker'}, 'dev', algorithm='HS256'))\n```\n\nUse the forged token to bypass authentication\n```\ncurl -s -D - \\\n  -H \"Authorization: Bearer $(cat /tmp/forged_token.txt)\" \\\n  http://127.0.0.1:8000/worker/tools\n```\n\nResult:\nThe server responds 200 OK with the full tool catalog and allows invocation of all worker tools.\n\nServer logs show a rejected request immediately followed by a successful forged request, confirming the bypass.\n\n### Impact\n\nThis is an authentication bypass that results in full remote access to all MCP worker endpoints:\n\nUnauthenticated attackers can enumerate tools\n\nInvoke arbitrary tools remotely\n\nAccess any data returned by tools (including secrets loaded into ToolContext)\n\nExecute actions inside internal systems if tools expose operational capabilities\n\nPerform these actions without any brute forcing or guesswork due to the known default signing key\n\nAny user who follows the official setup guide is exposed unless they manually override ARCADE_WORKER_SECRET, which is not documented.\n\nThis vulnerability effectively gives complete remote control over the MCP worker API to any attacker aware of the default key.",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "arcade-mcp-server",
        "purl": "pkg:pypi/arcade-mcp-server"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.9.1"
            }
          ]
        }
      ],
      "versions": [
        "1.0.0",
        "1.0.0rc1",
        "1.0.0rc2",
        "1.0.0rc3",
        "1.0.1",
        "1.1.0",
        "1.1.1",
        "1.2.0",
        "1.2.1",
        "1.3.0",
        "1.3.1",
        "1.3.2",
        "1.4.0",
        "1.4.1",
        "1.5.0",
        "1.6.0",
        "1.6.1",
        "1.7.0",
        "1.7.1",
        "1.7.2",
        "1.7.3",
        "1.8.0"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-g2jx-37x6-6438/GHSA-g2jx-37x6-6438.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ArcadeAI/arcade-mcp/security/advisories/GHSA-g2jx-37x6-6438"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ArcadeAI/arcade-mcp/pull/691"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ArcadeAI/arcade-mcp/commit/44660d18ceb220600401303df860a31ca766c817"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ArcadeAI/arcade-mcp/commit/7fb097f20fbea35e382a1b78da6fd90609c55a9e"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/ArcadeAI/arcade-mcp"
    }
  ]
}