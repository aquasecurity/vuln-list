{
  "id": "GHSA-8g72-gq68-6gqh",
  "modified": "2024-02-16T08:07:42.302932Z",
  "published": "2022-05-14T03:49:10Z",
  "aliases": [
    "CVE-2017-1000481",
    "PYSEC-2018-70"
  ],
  "summary": "Products.CMFPlone Open Redirect Vulnerability",
  "details": "When you visit a page where you need to login, Plone 2.5-5.1rc1 sends you to the login form with a 'came_from' parameter set to the previous url. After you login, you get redirected to the page you tried to view before. An attacker might try to abuse this by letting you click on a specially crafted link. You would login, and get redirected to the site of the attacker, letting you think that you are still on the original Plone site. Or some javascript of the attacker could be executed. Most of these types of attacks are already blocked by Plone, using the `isURLInPortal` check to make sure we only redirect to a page on the same Plone site. But a few more ways of tricking Plone into accepting a malicious link were discovered, and fixed with this hotfix.",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "products-cmfplone",
        "purl": "pkg:pypi/products-cmfplone"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.3.17"
            }
          ]
        }
      ],
      "versions": [
        "4.0b1",
        "4.1",
        "4.1.1",
        "4.1.2",
        "4.1.3",
        "4.1.4",
        "4.1.5",
        "4.1.6",
        "4.1a1",
        "4.1a2",
        "4.1a3",
        "4.1b1",
        "4.1b2",
        "4.1rc2",
        "4.1rc3",
        "4.2",
        "4.2.0.1",
        "4.2.1",
        "4.2.1.1",
        "4.2.2",
        "4.2.3",
        "4.2.4",
        "4.2.5",
        "4.2.6",
        "4.2.7",
        "4.2a1",
        "4.2a2",
        "4.2b1",
        "4.2b2",
        "4.2rc1",
        "4.2rc2",
        "4.3",
        "4.3.1",
        "4.3.10",
        "4.3.10rc1",
        "4.3.11",
        "4.3.12",
        "4.3.13",
        "4.3.14",
        "4.3.15",
        "4.3.16",
        "4.3.2",
        "4.3.3",
        "4.3.4",
        "4.3.4.1",
        "4.3.5",
        "4.3.6",
        "4.3.7",
        "4.3.8",
        "4.3.8rc1",
        "4.3.9",
        "4.3a1",
        "4.3a2",
        "4.3b1",
        "4.3b2",
        "4.3rc1"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json"
      }
    },
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "products-cmfplone",
        "purl": "pkg:pypi/products-cmfplone"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.0.0"
            },
            {
              "fixed": "5.0.10"
            }
          ]
        }
      ],
      "versions": [
        "5.0",
        "5.0.1",
        "5.0.10rc1",
        "5.0.2",
        "5.0.3",
        "5.0.3.1",
        "5.0.3rc1",
        "5.0.4",
        "5.0.4rc1",
        "5.0.5",
        "5.0.5rc1",
        "5.0.5rc2",
        "5.0.6",
        "5.0.6rc1",
        "5.0.7",
        "5.0.8",
        "5.0.9"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json"
      }
    },
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "products-cmfplone",
        "purl": "pkg:pypi/products-cmfplone"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.1a1"
            },
            {
              "fixed": "5.1.0"
            }
          ]
        }
      ],
      "versions": [
        "5.1a1",
        "5.1a2",
        "5.1b2",
        "5.1b3",
        "5.1b4",
        "5.1rc1",
        "5.1rc2"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/05/GHSA-8g72-gq68-6gqh/GHSA-8g72-gq68-6gqh.json"
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2017-1000481"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/issues/2232"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/pull/2233"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/pull/2234"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/pull/2235"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/pull/2236"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/commit/05a943ecbcdda56bacc93b55c9e2e908d8a7dfab"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/commit/0e50e1e67ea3b6d3187f78cb1a1628081f654d3b"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/commit/236b62b756ff46a92783b3897e717dfb15eb07d8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/plone/Products.CMFPlone/commit/7db5b2c8fb684055987b8c4fdedc29289bd26373"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/plone/Products.CMFPlone"
    },
    {
      "type": "WEB",
      "url": "https://plone.org/security/hotfix/20171128/open-redirection-on-login-form"
    }
  ]
}