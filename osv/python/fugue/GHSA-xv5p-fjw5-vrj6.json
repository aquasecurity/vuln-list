{
  "id": "GHSA-xv5p-fjw5-vrj6",
  "modified": "2025-11-27T09:16:42.085070Z",
  "published": "2025-11-25T20:39:15Z",
  "aliases": [
    "CVE-2025-62703"
  ],
  "summary": "Fugue is Vulnerable to Remote Code Execution by Pickle Deserialization via FlaskRPCServer",
  "details": "### Summary\nThe Fugue framework implements an RPC server system for distributed computing operations. In the core functionality of the RPC server implementation, I found that the _decode() function in fugue/rpc/flask.py directly uses cloudpickle.loads() to deserialize data without any sanitization. This creates a remote code execution vulnerability when malicious pickle data is processed by the RPC server.The vulnerability exists in the RPC communication mechanism where the client can send arbitrary serialized Python objects that will be deserialized on the server side, allowing attackers to execute arbitrary code on the victim's machine.\n\n### Details\n_decode() function in fugue/rpc/flask.py directly uses cloudpickle.loads() to deserialize data without any sanitization.\n\n### PoC\n* Step1:\nThe victim user starts an RPC server binding to open network using the Fugue framework. Here, I use the official RPC server code to initialize the server. \n\n* Step2:\nThe attacker modifies the _encode() function in fugue/rpc/flask.py to inject malicious pickle data:\n\n\u003cimg width=\"740\" height=\"260\" alt=\"image\" src=\"https://github.com/user-attachments/assets/6064516b-e1a6-45fa-a91c-8e276bc4a106\" /\u003e\n\nIn this example, attacker modifies _encode to let the victim execute command “ls -l”\n\n* Step 3:\nThe attacker then uses the RPC client to send the malicious request\n\nFugue gives a demo video and the PoC in the attachment, along with modified flask.py. When users reproduce this issue, in the server side (as an victim), users can run python rpc_server.py.  In the client side (as an attacker), users can first replace fugue/rpc/flask.py in pip site-packages with provided flask.py in the attachment and then run rpc_client.py.\n\n\n### Impact\nRemote code execution in the victim's machine. Once the victim starts the RPCServer with network binding (especially 0.0.0.0), an attacker on the network can gain arbitrary code execution by connecting to the RPCServer and sending crafted pickle payloads. This vulnerability allows for:\n\n- Complete system compromise\n- Data exfiltration\n- Lateral movement within the network\n- Denial of service attacks\n- Installation of persistent backdoors\n\n### Mitigation\n1. **Replace unsafe deserialization**: Replace `pickle.loads()` with safer alternatives such as:\n   - JSON serialization for simple data structures\n   - Protocol Buffers or MessagePack for complex data\n   - If pickle must be used, implement a custom `Unpickler` with a restricted `find_class()` method that only allows whitelisted classes\n\n2. **Network security**: \n   - If the service is intended for internal use only, bind to localhost (`127.0.0.1`) instead of `0.0.0.0`\n   - Implement authentication and authorization mechanisms\n\n3. **Security warnings**: When starting the service on public interfaces, display clear security warnings to inform users about the risks.\n\nAttachment: https://drive.google.com/file/d/1y8bBBp7dnWoT_WHBtdB0Fts4NRUIfdWi/view?usp=sharing",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "fugue",
        "purl": "pkg:pypi/fugue"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "0.9.2"
            }
          ]
        }
      ],
      "versions": [
        "0.0.2",
        "0.4.0",
        "0.4.1",
        "0.4.2",
        "0.4.3",
        "0.4.5",
        "0.4.6",
        "0.4.7",
        "0.4.8",
        "0.4.9",
        "0.5.0",
        "0.5.0.dev0",
        "0.5.0.dev1",
        "0.5.0.dev2",
        "0.5.1",
        "0.5.1.dev0",
        "0.5.1.dev1",
        "0.5.1.dev2",
        "0.5.1.dev3",
        "0.5.1.dev4",
        "0.5.1.dev5",
        "0.5.1.dev6",
        "0.5.2",
        "0.5.2.dev0",
        "0.5.2.dev1",
        "0.5.2.dev2",
        "0.5.3",
        "0.5.3.dev1",
        "0.5.4",
        "0.5.5",
        "0.5.5.dev1",
        "0.5.6",
        "0.5.6.dev1",
        "0.5.6.dev2",
        "0.5.7.dev1",
        "0.6.0",
        "0.6.0.dev1",
        "0.6.0.dev2",
        "0.6.0.dev3",
        "0.6.1",
        "0.6.1.dev1",
        "0.6.1.dev2",
        "0.6.1.dev3",
        "0.6.2",
        "0.6.3",
        "0.6.4",
        "0.6.4.dev1",
        "0.6.4.dev2",
        "0.6.5",
        "0.6.5.dev1",
        "0.6.5.dev2",
        "0.6.5.dev3",
        "0.6.5.dev4",
        "0.6.5.dev5",
        "0.6.5.dev6",
        "0.6.5.dev7",
        "0.6.5.dev8",
        "0.6.5.dev9",
        "0.6.6",
        "0.6.6.dev1",
        "0.6.6.dev2",
        "0.6.6.dev3",
        "0.7.0",
        "0.7.0.dev1",
        "0.7.0.dev2",
        "0.7.0.dev3",
        "0.7.0.dev4",
        "0.7.0.dev5",
        "0.7.1",
        "0.7.1.dev1",
        "0.7.2",
        "0.7.3",
        "0.7.3.dev0",
        "0.7.3.dev1",
        "0.7.4.dev0",
        "0.7.4.dev1",
        "0.8.0",
        "0.8.0.dev1",
        "0.8.0.dev2",
        "0.8.0.dev3",
        "0.8.0.dev4",
        "0.8.1",
        "0.8.1.dev1",
        "0.8.1.dev3",
        "0.8.1.dev4",
        "0.8.2",
        "0.8.2.dev1",
        "0.8.2.dev2",
        "0.8.2.dev3",
        "0.8.2.dev4",
        "0.8.3",
        "0.8.3.dev1",
        "0.8.4",
        "0.8.4.dev1",
        "0.8.4.dev2",
        "0.8.5",
        "0.8.5.dev1",
        "0.8.6",
        "0.8.6.dev1",
        "0.8.6.dev2",
        "0.8.6.dev3",
        "0.8.7",
        "0.8.7.dev1",
        "0.8.7.dev2",
        "0.8.7.dev3",
        "0.8.7.dev4",
        "0.8.7.dev5",
        "0.8.7.dev6",
        "0.8.7.dev7",
        "0.8.7.dev8",
        "0.9.0",
        "0.9.0.dev2",
        "0.9.0.dev3",
        "0.9.0.dev4",
        "0.9.1",
        "0.9.2",
        "0.9.2.dev1",
        "0.9.2.dev2"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-xv5p-fjw5-vrj6/GHSA-xv5p-fjw5-vrj6.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/fugue-project/fugue/security/advisories/GHSA-xv5p-fjw5-vrj6"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-62703"
    },
    {
      "type": "WEB",
      "url": "https://github.com/fugue-project/fugue/commit/6f25326779fd1f528198098d6287c5a863176fc0"
    },
    {
      "type": "WEB",
      "url": "https://drive.google.com/file/d/1y8bBBp7dnWoT_WHBtdB0Fts4NRUIfdWi/view?usp=sharing"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/fugue-project/fugue"
    }
  ]
}