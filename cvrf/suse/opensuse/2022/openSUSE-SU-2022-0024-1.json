{
  "Title": "Security update for lighttpd",
  "Tracking": {
    "ID": "openSUSE-SU-2022:0024-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2022-02-02T12:46:24Z",
    "CurrentReleaseDate": "2022-02-02T12:46:24Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2022-02-02T12:46:24Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for lighttpd",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for lighttpd fixes the following issues:\n\nlighttpd was updated to 1.4.64:\n\n* CVE-2022-22707: off-by-one stack overflow in the mod_extforward\n  plugin (boo#1194376)\n* graceful restart/shutdown timeout changed from 0 (disabled) to\n  8 seconds. configure an alternative with:\n  server.feature-flags += (“server.graceful-shutdown-timeout” =\u003e 8)\n* deprecated modules (previously announced) have been removed:\n  mod_authn_mysql, mod_mysql_vhost, mod_cml, mod_flv_streaming,\n  mod_geoip, mod_trigger_b4_dl\n\nupdate to 1.4.63:\n\n* import xxHash v0.8.1\n* fix reqpool mem corruption in 1.4.62\n\nincludes changes in 1.4.62:\n\n* [mod_alias] fix use-after-free bug\n* many developer visible bug fixes\n\nupdate to 1.4.61:\n\n* mod_dirlisting: sort '../' to top\n* fix HTTP/2 upload \u003e 64k w/ max-request-size\n* code level and developer visible bug fixes\n\nupdate to 1.4.60:\n\n* HTTP/2 smoother and lower memory use (in general)\n* HTTP/2 tuning to better handle aggressive client initial\n  requests\n* reduce memory footprint; workaround poor glibc behavior;\n  jemalloc is better\n* mod_magnet lua performance improvements\n* mod_dirlisting performance improvements and new caching option\n* memory constraints for extreme edge cases in mod_dirlisting,\n  mod_ssi, mod_webdav\n* connect(), write(), read() time limits on backends (separate\n  from client timeouts)\n* lighttpd restarts if large discontinuity in time occurs\n  (embedded systems)\n* RFC7233 Range support for all non-streaming responses, not\n  only static files\n* connect() to backend now has default 8 second timeout\n  (configurable)\n\n- Added hardening to systemd service(s) (boo#1181400).\n\nupdate to 1.4.59:\n\n* HTTP/2 enabled by default\n* mod_deflate zstd suppport\n* new mod_ajp13\n\nUpdate to 1.4.58: \n\n* [mod_wolfssl] use wolfSSL TLS version defines\n* [mod_wolfssl] compile with earlier wolfSSL vers\n* [core] prefer IPv6+IPv4 func vs IPv4-specific func\n* [core] reuse large mem chunks (fix mem usage) (fixes #3033)\n* [core] add comment for FastCGI mem use in hctx-\u003erb (#3033)\n* [mod_proxy] fix sending of initial reqbody chunked\n* [multiple] fdevent_waitpid() wrapper\n* [core] sys-time.h - localtime_r,gmtime_r macros\n* [core] http_date.[ch] encapsulate HTTP-date parse\n* [core] specialized strptime() for HTTP date fmts\n* [multiple] employ http_date.h, sys-time.h\n* [core] http_date_timegm() (portable timegm())\n* buffer_append_path_len() to join paths\n* [core] inet_ntop_cache -\u003e sock_addr_cache\n* [multiple] etag.[ch] -\u003e http_etag.[ch]; better imp\n* [core] fix crash after specific err in config file\n* [core] fix bug in FastCGI uploads (#3033)\n* [core] http_response_match_if_range()\n* [mod_webdav] typedef off_t loff_t for FreeBSD\n* [multiple] chunkqueue_write_chunk()\n* [build] add GNUMAKEFLAGS=--no-print-directory\n* [core] fix bug in read retry found by coverity\n* [core] attempt to quiet some coverity warnings\n* [mod_webdav] compile fix for Mac OSX/11\n* [core] handle U+00A0 in config parser\n* [core] fix lighttpd -1 one-shot with pipes\n* [core] quiet start/shutdown trace in one-shot mode\n* [core] allow keep-alives in one-shot mode (#3042)\n* [mod_webdav] define _ATFILE_SOURCE if AT_FDCWD\n* [core] setsockopt IPV6_V6ONLY if server.v4mapped\n* [core] prefer inet_aton() over inet_addr()\n* [core] add missing mod_wolfssl to ssl compat list\n* [mod_openssl] remove ancient preprocessor logic\n* [core] SHA512_Init, SHA512_Update, SHA512_Final\n* [mod_wolfssl] add complex preproc logic for SNI\n* [core] wrap a macro value with parens\n* [core] fix handling chunked response from backend (fixes #3044)\n* [core] always set file.fd = -1 on FILE_CHUNK reset (fixes #3044)\n* [core] skip some trace if backend Upgrade (#3044)\n* [TLS] cert-staple.sh POSIX sh compat (fixes #3043)\n* [core] portability fix if st_mtime not defined\n* [mod_nss] portability fix\n* [core] warn if mod_authn_file needed in conf\n* [core] fix chunked decoding from backend (fixes #3044)\n* [core] reject excess data after chunked encoding (#3046)\n* [core] track chunked encoding state from backend (fixes #3046)\n* [core] li_restricted_strtoint64()\n* [core] track Content-Length from backend (fixes #3046)\n* [core] enhance config parsing debugging (#3047)\n* [core] reorder srv-\u003econfig_context to match ndx (fixes #3047)\n* [mod_proxy] proxy.header = ('force-http10' =\u003e ...)\n* [mod_authn_ldap] fix crash (fixes #3048)\n* [mod_authn_ldap, mod_vhostdb_ldap] default cafile\n* [core] fix array_copy_array() sorted[]\n* [multiple] replace fall through comment with attr\n* [core] fix crash printing trace if backend is down\n* [core] fix decoding chunked from backend (fixes #3049)\n* [core] attempt to quiet some coverity warnings\n* [core] perf: request processing\n* [core] http_header_str_contains_token()\n* [mod_flv_streaming] parse query string w/o copying\n* [mod_evhost] use local array to split values\n* [core] remove srv-\u003esplit_vals\n* [core] add User-Agent to http_header_e enum\n* [core] store struct server * in struct connection\n* [core] use func rc to indicate done reading header\n* [core] replace connection_set_state w/ assignment\n* [core] do not pass srv to http header parsing func\n* [core] cold buffer_string_prepare_append_resize()\n* [core] chunkqueue_compact_mem()\n* [core] connection_chunkqueue_compact()\n* [core] pass con around request, not srv and con\n* [core] reduce use of struct parse_header_state\n* [core] perf: HTTP header parsing using \\n offsets\n* [core] no need to pass srv to connection_set_state\n* [core] perf: connection_read_header_more()\n* [core] perf: connection_read_header_hoff() hot\n* [core] inline connection_read_header()\n* [core] pass ptr to http_request_parse()\n* [core] more 'const' in request.c prototypes\n* [core] handle common case of alnum or - field-name\n* [mod_extforward] simplify code: use light_isxdigit\n* [core] perf: array.c performance enhancements\n* [core] mark some data_* funcs cold\n* [core] http_header.c internal inline funcs\n* [core] remove unused array_reset()\n* [core] prefer uint32_t to size_t in base.h\n* [core] uint32_t for struct buffer sizes\n* [core] remove unused members of struct server\n* [core] short-circuit path to clear request.headers\n* [core] array keys are non-empty in key-value list\n* [core] keep a-\u003edata[] sorted; remove a-\u003esorted[]\n* [core] __attribute_returns_nonnull__\n* [core] differentiate array_get_* for ro and rw\n* [core] (const buffer *) in (struct burl_parts_t)\n* [core] (const buffer *) for con-\u003eserver_name\n* [core] perf: initialize con-\u003econf using memcpy()\n* [core] run config_setup_connection() fewer times\n* [core] isolate data_config.c, vector.c\n* [core] treat con-\u003econditional_is_valid as bitfield\n* [core] http_header_hkey_get() over const array\n* [core] inline buffer as part of DATA_UNSET key\n* [core] inline buffer key for *_patch_connection()\n* [core] (data_unset *) from array_get_element_klen\n* [core] inline buffer as part of data_string value\n* [core] add const to callers of http_header_*_get()\n* [core] inline array as part of data_array value\n* [core] const char *op in data_config\n* [core] buffer string in data_config\n* [core] streamline config_check_cond()\n* [core] keep a-\u003edata[] sorted (REVERT)\n* [core] array a-\u003esorted[] as ptrs rather than pos\n* [core] inline header and env arrays into con\n* [mod_accesslog] avoid alloc for parsing cookie val\n* [core] simpler config_check_cond()\n* [mod_redirect,mod_rewrite] store context_ndx\n* [core] const char *name in struct plugin\n* [core] srv-\u003eplugin_slots as compact list\n* [core] rearrange server_config, server members\n* [core] macros CONST_LEN_STR and CONST_STR_LEN\n* [core] struct plugin_data_base\n* [core] improve condition caching perf\n* [core] config_plugin_values_init() new interface\n* [mod_access] use config_plugin_values_init()\n* [core] (const buffer *) from strftime_cache_get()\n* [core] mv config_setup_connection to connections.c\n* [core] use (const char *) in config file parsing\n* [mod_staticfile] use config_plugin_values_init()\n* [mod_skeleton] use config_plugin_values_init()\n* [mod_setenv] use config_plugin_values_init()\n* [mod_alias] use config_plugin_values_init()\n* [mod_indexfile] use config_plugin_values_init()\n* [mod_expire] use config_plugin_values_init()\n* [mod_flv_streaming] use config_plugin_values_init()\n* [mod_magnet] use config_plugin_values_init()\n* [mod_usertrack] use config_plugin_values_init()\n* [mod_userdir] split policy from userdir path build\n* [mod_userdir] use config_plugin_values_init()\n* [mod_ssi] use config_plugin_values_init()\n* [mod_uploadprogress] use config_plugin_values_init()\n* [mod_status] use config_plugin_values_init()\n* [mod_cml] use config_plugin_values_init()\n* [mod_secdownload] use config_plugin_values_init()\n* [mod_geoip] use config_plugin_values_init()\n* [mod_evasive] use config_plugin_values_init()\n* [mod_trigger_b4_dl] use config_plugin_values_init()\n* [mod_accesslog] use config_plugin_values_init()\n* [mod_simple_vhost] use config_plugin_values_init()\n* [mod_evhost] use config_plugin_values_init()\n* [mod_vhostdb*] use config_plugin_values_init()\n* [mod_mysql_vhost] use config_plugin_values_init()\n* [mod_maxminddb] use config_plugin_values_init()\n* [mod_auth*] use config_plugin_values_init()\n* [mod_deflate] use config_plugin_values_init()\n* [mod_compress] use config_plugin_values_init()\n* [core] add xsendfile* check if xdocroot is NULL\n* [mod_cgi] use config_plugin_values_init()\n* [mod_dirlisting] use config_plugin_values_init()\n* [mod_extforward] use config_plugin_values_init()\n* [mod_webdav] use config_plugin_values_init()\n* [core] store addtl data in pcre_keyvalue_buffer\n* [mod_redirect] use config_plugin_values_init()\n* [mod_rewrite] use config_plugin_values_init()\n* [mod_rrdtool] use config_plugin_values_init()\n* [multiple] gw_backends config_plugin_values_init()\n* [core] config_get_config_cond_info()\n* [mod_openssl] use config_plugin_values_init()\n* [core] use config_plugin_values_init()\n* [core] collect more config logic into configfile.c\n* [core] config_plugin_values_init_block()\n* [core] gw_backend config_plugin_values_init_block\n* [core] remove old config_insert_values_*() funcs\n* [multiple] plugin.c handles common FREE_FUNC code\n* [core] run all trigger and sighup handlers\n* [mod_wstunnel] change DEBUG_LOG to use log_error()\n* [core] stat_cache_path_contains_symlink use errh\n* [core] isolate use of data_config, configfile.h\n* [core] split cond cache from cond matches\n* [mod_auth] inline arrays in http_auth_require_t\n* [core] array_init() arg for initial size\n* [core] gw_exts_clear_check_local()\n* [core] gw_backend less pointer chasing\n* [core] connection_handle_errdoc() separate func\n* [multiple] prefer (connection *) to (srv *)\n* [core] create http chunk header on the stack\n* [multiple] connection hooks no longer get (srv *)\n* [multiple] plugin_stats array\n* [core] read up-to fixed size chunk before fionread\n* [core] default chunk size 8k (was 4k)\n* [core] pass con around gw_backend instead of srv\n* [core] log_error_multiline_buffer()\n* [multiple] reduce direct use of srv-\u003ecur_ts\n* [multiple] extern log_epoch_secs\n* [multiple] reduce direct use of srv-\u003eerrh\n* [multiple] stat_cache singleton\n* [mod_expire] parse config into structured data\n* [multiple] generic config array type checking\n* [multiple] rename r to rc rv rd wr to be different\n* [core] (minor) config_plugin_keys_t data packing\n* [core] inline buffer in log_error_st errh\n* [multiple] store srv-\u003etmp_buf in tb var\n* [multiple] quiet clang compiler warnings\n* [core] http_status_set_error_close()\n* [core] http_request_host_policy w/ http_parseopts\n* [multiple] con-\u003eproto_default_port\n* [core] store log filename in (log_error_st *)\n* [core] separate log_error_open* funcs\n* [core] fdevent uses uint32_t instead of size_t\n* [mod_webdav] large buffer reuse\n* [mod_accesslog] flush file log buffer at 8k size\n* [core] include settings.h where used\n* [core] static buffers for mtime_cache\n* [core] convenience macros to check req methods\n* [core] support multiple error logs\n* [multiple] omit passing srv to fdevent_handler\n* [core] remove unused arg to fdevent_fcntl_set_nb*\n* [core] slightly simpify server_(over)load_check()\n* [core] isolate fdevent subsystem\n* [core] isolate stat_cache subsystem\n* [core] remove include base.h where unused\n* [core] restart dead piped loggers every 64 sec\n* [mod_webdav] use copy_file_range() if available\n* [core] perf: buffer copy and append\n* [core] copy some srv-\u003esrvconf into con-\u003econf\n* [core] move keep_alive flag into request_st\n* [core] pass scheme port to http_request_parse()\n* [core] pass http_parseopts around request.c\n* [core] rename specific_config to request_config\n* [core] move request_st,request_config to request.h\n* [core] pass (request_st *) to request.c funcs\n* [core] remove unused request_st member 'request'\n* [core] rename content_length to reqbody_length\n* [core] t/test_request.c using (request_st *)\n* [core] (const connection *) in http_header_*_get()\n* [mod_accesslog] log_access_record() fmt log record\n* [core] move request start ts into (request_st *)\n* [core] move addtl request-specific struct members\n* [core] move addtl request-specific struct members\n* [core] move plugin_ctx into (request_st *)\n* [core] move addtl request-specific struct members\n* [core] move request state into (request_st *)\n* [core] store (plugin *) in p-\u003edata\n* [core] store subrequest_handler instead of mode\n* [multiple] copy small struct instead of memcpy()\n* [multiple] split con, request (very large change)\n* [core] r-\u003euri.path always set, though might be ''\n* [core] C99 restrict on some base funcs\n* [core] dispatch handler in handle_request func\n* [core] http_request_parse_target()\n* [mod_magnet] modify r-\u003etarget with 'uri.path-raw'\n* [core] remove r-\u003euri.path_raw; generate as needed\n* [core] http_response_comeback()\n* [core] http_response_config()\n* [tests] use buffer_eq_slen() for str comparison\n* [core] http_status_append() short-circuit 200 OK\n* [core] mark some chunk.c funcs as pure\n* [core] use uint32_t in http_header.[ch]\n* [core] perf: tighten some code in some hot paths\n* [core] parse header label before end of line\n* [mod_auth] 'nonce_secret' option to validate nonce (fixes #2976)\n* [build] fix build on MacOS X Tiger\n* [doc] lighttpd.conf: lighttpd choose event-handler\n* [config] blank server.tag if whitespace-only\n* [mod_proxy] stream request using HTTP/1.1 chunked (fixes #3006)\n* [multiple] correct misspellings in comments\n* [multiple] fix some cc warnings in 32-bit, powerpc\n* [tests] fix skip count in mod-fastcgi w/o php-cgi\n* [multiple] ./configure --with-nettle to use Nettle\n* [core] skip excess close() when FD_CLOEXEC defined\n* [mod_cgi] remove redundant calls to set FD_CLOEXEC\n* [core] return EINVAL if stat_cache_get_entry w/o /\n* [mod_webdav] define PATH_MAX if not defined\n* [mod_accesslog] process backslash-escapes in fmt\n* [mod_openssl] disable cert vrfy if ALPN acme-tls/1\n* [core] add seed before openssl RAND_pseudo_bytes()\n* [mod_mbedtls] mbedTLS option for TLS\n* [core] prefer getxattr() instead of get_attr()\n* [multiple] use *(unsigned char *) with ctypes\n* [mod_openssl] do not log ECONNRESET unless debug\n* [mod_openssl] SSL_R_UNEXPECTED_EOF_WHILE_READING\n* [mod_gnutls] GnuTLS option for TLS (fixes #109)\n* [mod_openssl] rotate session ticket encryption key\n* [mod_openssl] set cert from callback in 1.0.2+ (fixes #2842)\n* [mod_openssl] set chains from callback in 1.0.2+ (#2842)\n* [core] RFC-strict parse of Content-Length\n* [build] point ./configure --help to support forum\n* [core] stricter parse of numerical digits\n* [multiple] add summaries to top of some modules\n* [core] sys-crypto-md.h w/ inline message digest fn\n* [mod_openssl] enable read-ahead, if set, after SNI\n* [mod_openssl] issue warning for deprecated options\n* [mod_openssl] use SSL_OP_NO_RENEGOTIATION if avail\n* [mod_openssl] use openssl feature define for ALPN\n* [mod_openssl] update default DH params\n* [core] SecureZeroMemory() on _WIN32\n* [core] safe memset calls memset() through volatile\n* [doc] update comments in doc/config/modules.conf\n* [core] more precise check for request stream flags\n* [mod_openssl] rotate session ticket encryption key\n* [mod_openssl] ssl.stek-file to specify encrypt key\n* [mod_mbedtls] ssl.stek-file to specify encrypt key\n* [mod_gnutls] ssl.stek-file to specify encrypt key\n* [mod_openssl] disable session cache; prefer ticket\n* [mod_openssl] compat with LibreSSL\n* [mod_openssl] compat with WolfSSL\n* [mod_openssl] set SSL_OP_PRIORITIZE_CHACHA\n* [mod_openssl] move SSL_CTX curve conf to new func\n* [mod_openssl] basic SSL_CONF_cmd for alt TLS libs\n* [mod_openssl] OCSP stapling (fixes #2469)\n* [TLS] cert-staple.sh - refresh OCSP responses (#2469)\n* [mod_openssl] compat with BoringSSL\n* [mod_gnutls] option to override GnuTLS priority\n* [mod_gnutls] OCSP stapling (#2469)\n* [mod_extforward] config warning for module order\n* [mod_webdav] store webdav.opts as bitflags\n* [mod_webdav] limit webdav_propfind_dir() recursion\n* [mod_webdav] unsafe-propfind-follow-symlink option\n* [mod_webdav] webdav.opts 'propfind-depth-infinity'\n* [mod_openssl] detect certs marked OCSP Must-Staple\n* [mod_gnutls] detect certs marked OCSP Must-Staple\n* [mod_openssl] default to set MinProtocol TLSv1.2\n* [mod_nss] NSS option for TLS (fixes #1218)\n* [core] fdevent_load_file() shared code\n* [mod_openssl,mbedtls,gnutls,nss] fdevent_load_file\n* [core] error if s-\u003esocket_perms chmod() fails\n* [mod_openssl] prefer some WolfSSL native APIs\n* quiet clang analyzer scan-build warnings\n* [core] uint32_t is plenty large for path names\n* [mod_mysql_vhost] deprecated; use mod_vhostdb_mysql\n* [core] splaytree_djbhash() in splaytree.h (reuse)\n* [cmake] update deps for src/t/test_*\n* [cmake] update deps for src/t/test_*\n* [build] remove tests/mod-userdir.t from builds\n* [build] fix typo in src/Makefile.am EXTRA_DIST\n* [core] remove unused mbedtls_enabled flag\n* [core] store fd in srv-\u003estdin_fd during setup\n* [multiple] address coverity warnings\n* [mod_webdav] fix theoretical NULL dereference\n* [mod_webdav] update rc for PROPFIND allprop\n* [mod_webdav] build fix: ifdef live_properties\n* [multiple] address coverity warnings\n* [meson] fix libmariadb dependency\n* [meson] add missing libmaxminddb section\n* [mod_auth,mod_vhostdb] add caching option (fixes #2805)\n* [mod_authn_ldap,mod_vhostdb_ldap] add timeout opt (#2805)\n* [mod_auth] accept 'nonce-secret' \u0026 'nonce_secret'\n* [mod_openssl] fix build warnings on MacOS X\n* [core] Nettle assert()s if buffer len \u003e digest sz\n* [mod_authn_dbi] authn backend employing DBI\n* [mod_authn_mysql,file] use crypt() to save stack\n* [mod_vhostdb_dbi] allow strings and ints in config\n* add ci-build.sh\n* move ci-build.sh to scripts\n* [build] build fixes for AIX\n* [mod_deflate] Brotli support\n* [build] bzip2 default to not-enabled in build\n* [mod_deflate] fix typo in config option\n* [mod_deflate] propagate errs from internal funcs\n* [mod_deflate] deflate.cache-dir compressed cache\n* [mod_deflate] mod_deflate subsumes mod_compress\n* [doc] mod_compress -\u003e mod_deflate\n* [tests] mod_compress -\u003e mod_deflate\n* [mod_compress] remove mod_compress\n* [build] add --with-brotli to CI build\n* [core] server.feature-flags extensible config\n* [core] con layer plugin_ctx separate from request\n* [multiple] con hooks store ctx in con-\u003eplugin_ctx\n* [core] separate funcs to reset (request_st *)\n* [multiple] rename connection_reset hook to request\n* [mod_nss] func renames for consistency\n* [core] detect and reject TLS connect to cleartext\n* [mod_deflate] quicker check for Content-Encoding\n* [mod_openssl] read secret data w/ BIO_new_mem_buf\n* [core] decode Transfer-Encoding: chunked from gw\n* [mod_fastcgi] decode Transfer-Encoding: chunked\n* [core] stricter parsing of POST chunked block hdr\n* [mod_proxy] send HTTP/1.1 requests to backends\n* [tests] test_base64.c clear buf vs reset\n* [core] http_header_remove_token()\n* [mod_webdav] fix inadvertent string truncation\n* [core] add some missing standard includes\n* [mod_extforward] attempt to quiet Coverity warning\n* [mod_authn_dbi,mod_authn_mysql] fix coverity issue\n* scons: fix check environment\n* Add avahi service file under doc/avahi/\n* [mod_webdav] fix fallback if linkat() fails\n* [mod_proxy] do not forward Expect: 100-continue\n* [core] chunkqueue_compact_mem() must upd cq-\u003elast\n* [core] dlsym for FAMNoExists() for compat w/ fam\n* [core] disperse settings.h to appropriate headers\n* [core] inline buffer_reset()\n* [mod_extforward] save proto per connection\n* [mod_extforward] skip after HANDLER_COMEBACK\n* [core] server.feature-flags to enable h2\n* [core] HTTP_VERSION_2\n* [multiple] allow TLS ALPN 'h2' if 'server.h2proto'\n* [mod_extforward] preserve changed addr for h2 con\n* [core] do not send Connection: close if h2\n* [core] lowercase response hdr field names for h2\n* [core] recognize status: 421 Misdirected Request\n* [core] parse h2 pseudo-headers\n* [core] request_headers_process()\n* [core] connection_state_machine_loop()\n* [core] reset connection counters per connection\n* [mod_accesslog,mod_rrdtool] HTTP/2 basic accounting\n* [core] connection_set_fdevent_interest()\n* [core] HTTP2-Settings\n* [core] adjust http_request_headers_process()\n* [core] http_header_parse_hoff()\n* [core] move http_request_headers_process()\n* [core] reqpool.[ch] for (request_st *)\n* [multiple] modules read reqbody via fn ptr\n* [multiple] isolate more con code in connections.c\n* [core] isolate more resp code in response.c\n* [core] h2.[ch] with stub funcs (incomplete)\n* [core] alternate between two joblists\n* [core] connection transition to HTTP/2; incomplete\n* [core] mark some error paths with attribute cold\n* [core] discard 100 102 103 responses from backend\n* [core] skip write throttle for 100 Continue\n* [core] adjust (disabled) debug code\n* [core] update comment\n* [core] link in ls-hpack (EXPERIMENTAL)\n* [core] HTTP/2 HPACK using LiteSpeed ls-hpack\n* [core] h2_send_headers() specialized for resp hdrs\n* [core] http_request_parse_header() specialized\n* [core] comment possible future ls-hpack optimize\n* [mod_status] separate funcs to print request table\n* [mod_status] adjust to print HTTP/2 requests\n* [core] redirect to dir using relative-path\n* [core] ignore empty field-name from backends\n* [mod_auth] fix crash if auth.require misconfigured (fixes #3023)\n* [core] fix 1-char trunc of default server.tag\n* [core] request_acquire(), request_release()\n* [core] keep pool of (request_st *) for HTTP/2\n* [mod_status] dedicated funcs for r-\u003estate labels\n* [core] move connections_get_state to connections.c\n* [core] fix crash on master after graceful restart\n* [core] defer optimization to read small files\n* [core] do not require '\\0' term for k,v hdr parse\n* [scripts] cert-staple.sh enhancements\n* [core] document algorithm used in lighttpd etag\n* [core] ls-hpack optimizations\n* [core] fix crash on master if blank line request\n* [core] use djbhash in gw_backend to choose host\n* [core] rename md5.[ch] to algo_md5.[ch]\n* [core] move djbhash(), dekhash() to algo_md.h\n* [core] rename splaytree.[ch] to algo_splaytree.[ch]\n* [core] import xxHash v0.8.0\n* [build] modify build, includes for xxHash v0.8.0\n* [build] remove ls-hpack/deps\n* [core] xxhash no inline hints; let compiler choose\n* [mod_dirlisting] fix config parsing crash\n* [mod_openssl] clarify trace w/ deprecated options\n* [doc] refresh doc/config/*/*\n* [core] code size: disable XXH64(), XXH3()\n* [doc] update README and INSTALL\n* [core] combine Cookie request headers with ';'\n* [core] log stream id with debug.log-state-handling\n* [core] set r-\u003estate in h2.c\n* [mod_ssi] update chunk after shell output redirect\n* [mod_webdav] preserve bytes_out when chunks merged\n* [multiple] inline chunkqueue_length()\n* [core] cold h2_log_response_header*() funcs\n* [core] update HTTP status codes list from IANA\n* [mod_wolfssl] standalone module\n* [core] Content-Length in http_response_send_file()\n* [core] adjust response header prep for common case\n* [core] light_isupper(), light_islower()\n* [core] tst,set,clr macros for r-\u003e{rqst,resp}_htags\n* [core] separate http_header_e from _htags bitmask\n* [core] http_header_hkey_get_lc() for HTTP/2\n* [core] array.[ch] using uint32_t instead of size_t\n* [core] extend (data_string *) to store header id\n* [multiple] extend enum http_header_e list\n* [core] http_header_e \u003c=\u003e lshpack_static_hdr_idx\n* [core] skip ls-hpack decode work unused by lighttpd\n* [TLS] error if inherit empty TLS cfg from globals\n* [core] connection_check_expect_100()\n* [core] support multiple 1xx responses from backend\n* [core] reload c after chunkqueue_compact_mem()\n* [core] relay 1xx from backend over HTTP/2\n* [core] relay 1xx from backend over HTTP/1.1\n* [core] chunkqueue_{peek,read}_data(), squash\n* [multiple] TLS modules use chunkqueue_peek_data()\n* [mod_magnet] magnet.attract-response-start-to\n* [multiple] code reuse chunkqueue_peek_data()\n* [core] reuse r-\u003estart_hp.tv_sec for r-\u003estart_ts\n* [core] config_plugin_value_tobool() accept '0','1'\n* [core] graceful and immediate restart option\n* [mod_ssi] init status var before waitpid()\n* [core] graceful shutdown timeout option\n* [core] lighttpd -1 supports pipes (e.g. netcat)\n* [core] perf adjustments to avoid load miss\n* [multiple] use sock_addr_get_family in more places\n* [multiple] inline chunkqueue where always alloc'd\n* [core] propagate state after writing\n* [core] server_run_con_queue()\n* [core] defer handling FDEVENT_HUP and FDEVENT_ERR\n* [core] handle unexpected EOF reading FILE_CHUNK\n* [core] short-circuit connection_write_throttle()\n* [core] walk queue in connection_write_chunkqueue()\n* [core] connection_joblist global\n* [core] be more precise checking streaming flags\n* [core] fdevent_load_file_bytes()\n* [TLS] use fdevent_load_file_bytes() for STEK file\n* [core] allow symlinks under /dev for rand devices\n* [multiple] use light_btst() for hdr existence chk\n* [mod_deflate] fix potential NULL deref in err case\n* [core] save errno around close() if fstat() fails\n* [mod_ssi] use stat_cache_open_rdonly_fstat()\n* [core] fdevent_dup_cloexec()\n* [core] dup FILE_CHUNK fd when splitting FILE_CHUNK\n* [core] stat_cache_path_isdir()\n* [multiple] use stat_cache_path_isdir()\n* [mod_mbedtls] quiet CLOSE_NOTIFY after conn reset\n* [mod_gnutls] quiet CLOSE_NOTIFY after conn reset\n* [core] limit num ranges in Range requests\n* [core] remove unused r-\u003econtent_length\n* [core] http_response_parse_range() const file sz\n* [core] pass open fd to http_response_parse_range\n* [core] stat_cache_get_entry_open()\n* [core,mod_deflate] leverage cache of open fd\n* [doc] comment out config disabling Range for .pdf\n* [core] coalesce nearby ranges in Range requests\n* [mod_fastcgi] decode chunked is cold code path\n* [core] fix chunkqueue_compact_mem w/ partial chunk\n* [core] alloc optim reading file, sending chunked\n* [core] reuse chunkqueue_compact_mem*()\n* [mod_cgi] use splice() to send input to CGI\n* [multiple] ignore openssl 3.0.0 deprecation warns\n* [mod_openssl] migrate ticket cb to openssl 3.0.0\n* [mod_openssl] construct OSSL_PARAM on stack\n* [mod_openssl] merge ssl_tlsext_ticket_key_cb impls\n* [multiple] openssl 3.0.0 digest interface migrate\n* [tests] detect multiple SSL/TLS/crypto providers\n* [core] sys-crypto-md.h consistent interfaces\n* [wolfssl] wolfSSL_CTX_set_mode differs from others\n* [multiple] use NSS crypto if no other crypto avail\n* [multiple] stat_cache_path_stat() for struct st\n* [TLS] ignore empty 'CipherString' in ssl-conf-cmd\n* [multiple] remove chunk file.start member\n* [core] modify use of getrlimit() to not be fatal\n* [mod_webdav] add missing update to cq accounting\n* [mod_webdav] update defaults after worker_init\n* [mod_openssl] use newer openssl 3.0.0 func\n* [core] config_plugin_value_to_int32()\n* [core] minimize pause during graceful restart\n* [mod_deflate] use large mmap chunks to compress\n* [core] stat_cache_entry reference counting\n* [core] FILE_CHUNK can hold stat_cache_entry ref\n* [core] http_chunk_append_file_ref_range()\n* [multiple] use http_chunk_append_file_ref()\n* [core] always lseek() with shared fd\n* [core] silence coverity warnings (false positives)\n* [core] silence coverity warnings in ls-hpack\n* [core] silence coverity warnings (another try)\n* [core] fix fd sharing when splitting file chunk\n* [mod_mbedtls] quiet unused variable warning\n* [core] use inline funcs in sys-crypto-md.h\n* [core] add missing declaration for NSS rand\n* [core] init NSS lib for basic crypto algorithms\n* [doc] change mod_compress refs to mod_deflate\n* [doc] replace bzip2 refs with brotli\n* [build] remove svnversion from versionstamp rule\n* [doc] /var/run -\u003e /run\n* [multiple] test for nss includes\n* [mod_nss] more nss includes fixes\n* [mod_webdav] define _NETBSD_SOURCE on NetBSD\n* [core] silence coverity warnings (another try)\n* [mod_mbedtls] newer mbedTLS vers support TLSv1.3\n* [mod_accesslog] update defaults after cycling log\n* [multiple] add some missing config cleanup\n* [core] fix (startup) mem leaks in configparser.y\n* [core] STAILQ_* -\u003e SIMPLEQ_* on OpenBSD\n* [mod_wolfssl] use more wolfssl/options.h defines\n* [mod_wolfssl] cripple SNI if not built OPENSSL_ALL\n* [mod_wolfssl] need to build --enable-alpn for ALPN\n* [mod_secdownload] fix compile w/ NSS on FreeBSD\n* [mod_mbedtls] wrap addtl code in preproc defines\n* [TLS] server.feature-flags 'ssl.session-cache'\n* [core] workaround fragile code in wolfssl types.h\n* [core] move misplaced error trace to match option\n* [core] adjust wolfssl workaround for another case\n* [multiple] consistent order for crypto lib select\n* [multiple] include mbedtls/config.h after select\n* [multiple] include wolfssl/options.h after select\n* [core] set NSS_VER_INCLUDE after crypto lib select\n* [core] use system xxhash lib if available\n* [doc] refresh doc/config/conf.d/mime.conf\n* [meson] add matching -I for lua lib version\n* [build] prepend search for lua version 5.4\n* [core] use inotify in stat_cache.[ch] on Linux\n* [build] detect inotify header \u003csys/inotify.h\u003e\n* [mod_nss] update session ticket NSS devel comment\n* [core] set last_used on rd/wr from backend (fixes #3029)\n* [core] cold func for gw_recv_response error case\n* [core] use kqueue() instead of FAM/gamin on *BSD\n* [core] no graceful-restart-bg on OpenBSD, NetBSD\n* [mod_openssl] add LIBRESSL_VERSION_NUMBER checks\n* [core] use struct kevent on stack in stat_cache\n* [core] stat_cache preprocessor paranoia\n* [mod_openssl] adjust LIBRESSL_VERSION_NUMBER check\n* [mod_maxminddb] fix config validation typo\n* [tests] allow LIGHTTPD_EXE_PATH override\n* [multiple] handle NULL val as empty in *_env_add (fixes #3030)\n* [core] accept 'HTTP/2.0', 'HTTP/3.0' from backends (fixes #3031)\n* [build] check for xxhash in more ways\n* [core] accept 'HTTP/2.0', 'HTTP/3.0' from backends (#3031)\n* [core] http_response_buffer_append_authority()\n* [core] define SHA*_DIGEST_LENGTH macros if missing\n* [doc] update optional pkg dependencies in INSTALL\n* [mod_alias] validate given order, not sorted order\n* [core] filter out duplicate modules\n* [mod_cgi] fix crash if initial write to CGI fails\n* [mod_cgi] ensure tmp file open() before splice()\n* [multiple] add back-pressure gw data pump (fixes #3033)\n* [core] fix bug when HTTP/2 frames span chunks\n* [multiple] more forgiving config str to boolean (fixes #3036)\n* [core] check for __builtin_expect() availability\n* [core] quiet more request parse errs unless debug\n* [core] consolidate chunk size checks\n* [mod_flv_streaming] use stat_cache_get_entry_open\n* [mod_webdav] pass full path to webdav_unlinkat()\n* [mod_webdav] fallbacks if _ATFILE_SOURCE not avail\n* [mod_fastcgi] move src/fastcgi.h into src/compat/\n* [mod_status] add additional HTML-encoding\n* [core] server.v4mapped option\n* [mod_webdav] workaround for gvfs dir redir bug\n\n- Remove SuSEfirewall2 service files, SuSEfirewall2 does not exist\n  anymore\n\n- Changed /etc/logrotate.d/lighttpd from init.d to systemd\n  fix boo#1146452. \n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "openSUSE-2022-24",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "lighttpd-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_gssapi-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_ldap-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_pam-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_sasl-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_magnet-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_maxminddb-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_rrdtool-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_dbi-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_ldap-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_mysql-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_pgsql-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_webdav-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_gssapi-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_ldap-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_pam-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_authn_sasl-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_magnet-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_maxminddb-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_rrdtool-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_dbi-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_ldap-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_mysql-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_vhostdb_pgsql-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "lighttpd-mod_webdav-1.4.64-bp153.2.3.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/6P5G6MJW4Q5RKKPO7TS5CLAAEQ2QUYBE/",
      "Description": "E-Mail link for openSUSE-SU-2022:0024-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1146452",
      "Description": "SUSE Bug 1146452"
    },
    {
      "URL": "https://bugzilla.suse.com/1181400",
      "Description": "SUSE Bug 1181400"
    },
    {
      "URL": "https://bugzilla.suse.com/1194376",
      "Description": "SUSE Bug 1194376"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-22707/",
      "Description": "SUSE CVE CVE-2022-22707 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-22707",
      "Description": "In lighttpd 1.4.46 through 1.4.63, the mod_extforward_Forwarded function of the mod_extforward plugin has a stack-based buffer overflow (4 bytes representing -1), as demonstrated by remote denial of service (daemon crash) in a non-default configuration. The non-default configuration requires handling of the Forwarded header in a somewhat unusual manner. Also, a 32-bit system is much more likely to be affected than a 64-bit system.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-22707.html",
          "Description": "CVE-2022-22707"
        },
        {
          "URL": "https://bugzilla.suse.com/1194376",
          "Description": "SUSE Bug 1194376"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Package Hub 15 SP3:lighttpd-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_authn_gssapi-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_authn_ldap-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_authn_pam-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_authn_sasl-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_magnet-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_maxminddb-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_rrdtool-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_vhostdb_dbi-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_vhostdb_ldap-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_vhostdb_mysql-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_vhostdb_pgsql-1.4.64-bp153.2.3.1",
            "SUSE Package Hub 15 SP3:lighttpd-mod_webdav-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_authn_gssapi-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_authn_ldap-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_authn_pam-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_authn_sasl-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_magnet-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_maxminddb-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_rrdtool-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_vhostdb_dbi-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_vhostdb_ldap-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_vhostdb_mysql-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_vhostdb_pgsql-1.4.64-bp153.2.3.1",
            "openSUSE Leap 15.3:lighttpd-mod_webdav-1.4.64-bp153.2.3.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}