{
  "Title": "Security update for nextcloud",
  "Tracking": {
    "ID": "openSUSE-SU-2021:1602-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2021-12-20T10:28:56Z",
    "CurrentReleaseDate": "2021-12-20T10:28:56Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2021-12-20T10:28:56Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for nextcloud",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "\nThis update for nextcloud fixes the following issues:\n\nUpdate to 20.0.14\n\nSecurity issues fixed:\n\n* CVE-2021-41179: Fix boo#1192028 - (CWE-304): Two-Factor Authentication not enforced for pages marked as public\n* CVE-2021-41178: Fix boo#1192030 - (CWE-434): File Traversal affecting SVG files on Nextcloud Server\n* CVE-2021-41177: Fix boo#1192031 - (CWE-799): Rate-limits not working on instances without configured memory cache backend\n\nChanges:\n\n- Add command to repair broken filesystem trees (server#26630)\n- Ensure that user and group IDs in LDAP's tables are also max 64chars (server#28971)\n- Change output format of Psalm to Github (server#29048)\n- File-upload: Correctly handle error responses for HTTP2 (server#29069)\n- Allow 'TwoFactor Nextcloud Notifications' to pull the state of the 2Fâ€¦ (server#29072)\n- Add a few sensitive config keys (server#29085)\n- Fix path of file_get_contents (server#29095)\n- Update the certificate bundle (server#29098)\n- Keep pw based auth tokens valid when pw-less login happens (server#29131)\n- Properly handle folder deletion on external s3 storage (server#29158)\n- Tokens without password should not trigger changed password invalidation (server#29166)\n- Don't further setup disabled users when logging in with apache (server#29167)\n- Add 'supported'-label to all supported apps (server#29181)\n- 21] generate a better optimized query for path prefix search filters (server#29192)\n- Keep group restrictions when reenabling apps after an update (server#29198)\n- Add proper message to created share not found (server#29205)\n- Add documentation for files_no_background_scan (server#29219)\n- Don't setup the filesystem to check for a favicon we don't use anyway (server#29223)\n- Fix background scan doc in config (server#29253)\n- Get `filesize()` if `file_exists()` (server#29290)\n- Fix unable to login errors due to file system not being initialized (server#29291)\n- Update 3rdparty ref (server#29297)\n- Bump icewind/streams from 0.7.3 to 0.7.5 in files_external (server#29298)\n- Fix app upgrade (server#29303)\n- Avoid PHP errors when the LDAP attribute is not found (server#29314)\n- Fix security issues when copying groupfolder with advanced ACL (server#29366)\n- Scheduling plugin not updating responding attendee status (server#29387)\n- Make calendar schedule options translatable (server#29388)\n- Add whitelist for apps inside of the server repo (server#29396)\n- Handle files with `is_file` instead of `file_exists` (server#29417)\n- Fixes an undefined index when getAccessList returns an empty array (server#29421)\n- Extra fixes needed for icewind/streams update to 0.7.2 (server#29426)\n- Backport #29260: Respect user enumeration settings in user status lists (server#29429)\n- Implement local filtering in file list (server#29441)\n- Detect mimetype by content only with content (server#29457)\n- Update CRL (server#29505)\n- Update update-psalm-baseline workflow (server#29548)\n- Bump icewind/streams from 0.7.1 to 0.7.5 (3rdparty#855)\n- Bump version (files_pdfviewer#512)\n- Fix deleting notifications with numeric user ID (notifications#1090)\n- Add integration tests for push registration (notifications#1097)\n- Restore old device signature so the proxy works again (notifications#1105)\n- Bump vue and vue-template-compiler (photos#864)\n- Bump prosemirror-schema-list from 1.1.5 to 1.1.6 (text#1868)\n- Additional checks for workspace controller (text#1887)\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "openSUSE-2021-1602",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 12",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 12",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP2",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP2",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "SUSE Package Hub 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "openSUSE Leap 15.2",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "openSUSE Leap 15.2",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "nextcloud-apache-20.0.14-bp153.2.9.1",
        "RelatesToProductReference": "openSUSE Leap 15.3",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/YPS4NA73653ZFLPRD3JJVTUZZ4PYGDUS/",
      "Description": "E-Mail link for openSUSE-SU-2021:1602-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1192028",
      "Description": "SUSE Bug 1192028"
    },
    {
      "URL": "https://bugzilla.suse.com/1192030",
      "Description": "SUSE Bug 1192030"
    },
    {
      "URL": "https://bugzilla.suse.com/1192031",
      "Description": "SUSE Bug 1192031"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2021-41177/",
      "Description": "SUSE CVE CVE-2021-41177 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2021-41178/",
      "Description": "SUSE CVE CVE-2021-41178 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2021-41179/",
      "Description": "SUSE CVE CVE-2021-41179 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2021-41177",
      "Description": "Nextcloud is an open-source, self-hosted productivity platform. Prior to versions 20.0.13, 21.0.5, and 22.2.0, Nextcloud Server did not implement a database backend for rate-limiting purposes. Any component of Nextcloud using rate-limits (as as `AnonRateThrottle` or `UserRateThrottle`) was thus not rate limited on instances not having a memory cache backend configured. In the case of a default installation, this would notably include the rate-limits on the two factor codes. It is recommended that the Nextcloud Server be upgraded to 20.0.13, 21.0.5, or 22.2.0. As a workaround, enable a memory cache backend in `config.php`.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2021-41177.html",
          "Description": "CVE-2021-41177"
        },
        {
          "URL": "https://bugzilla.suse.com/1192031",
          "Description": "SUSE Bug 1192031"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Package Hub 12:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 12:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-apache-20.0.14-bp153.2.9.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2021-41178",
      "Description": "Nextcloud is an open-source, self-hosted productivity platform. Prior to versions 20.0.13, 21.0.5, and 22.2.0, a file traversal vulnerability makes an attacker able to download arbitrary SVG images from the host system, including user provided files. This could also be leveraged into a XSS/phishing attack, an attacker could upload a malicious SVG file that mimics the Nextcloud login form and send a specially crafted link to victims. The XSS risk here is mitigated due to the fact that Nextcloud employs a strict Content-Security-Policy disallowing execution of arbitrary JavaScript. It is recommended that the Nextcloud Server be upgraded to 20.0.13, 21.0.5 or 22.2.0. There are no known workarounds aside from upgrading.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2021-41178.html",
          "Description": "CVE-2021-41178"
        },
        {
          "URL": "https://bugzilla.suse.com/1192030",
          "Description": "SUSE Bug 1192030"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Package Hub 12:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 12:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-apache-20.0.14-bp153.2.9.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2021-41179",
      "Description": "Nextcloud is an open-source, self-hosted productivity platform. Prior to Nextcloud Server versions 20.0.13, 21.0.5, and 22.2.0, the Two-Factor Authentication wasn't enforced for pages marked as public. Any page marked as `@PublicPage` could thus be accessed with a valid user session that isn't authenticated. This particularly affects the Nextcloud Talk application, as this could be leveraged to gain access to any private chat channel without going through the Two-Factor flow. It is recommended that the Nextcloud Server be upgraded to 20.0.13, 21.0.5 or 22.2.0. There are no known workarounds aside from upgrading.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2021-41179.html",
          "Description": "CVE-2021-41179"
        },
        {
          "URL": "https://bugzilla.suse.com/1192028",
          "Description": "SUSE Bug 1192028"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Package Hub 12:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 12:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP1:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-20.0.14-bp153.2.9.1",
            "SUSE Package Hub 15 SP3:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.2:nextcloud-apache-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-20.0.14-bp153.2.9.1",
            "openSUSE Leap 15.3:nextcloud-apache-20.0.14-bp153.2.9.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}