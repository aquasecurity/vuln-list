{
  "Title": "Security update for xen",
  "Tracking": {
    "ID": "SUSE-SU-2023:4184-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2023-10-24T14:52:50Z",
    "CurrentReleaseDate": "2023-10-24T14:52:50Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2023-10-24T14:52:50Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for xen",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for xen fixes the following issues:\n\n- CVE-2023-34323: Fixed a potential crash in C Xenstored due to an\n  incorrect assertion (XSA-440) (bsc#1215744).\n- CVE-2023-34326: Fixed a missing IOMMU TLB flush on x86 AMD systems\n  with IOMMU hardware and PCI passthrough enabled (XSA-442)\n  (bsc#1215746).\n- CVE-2023-34325: Fixed multiple parsing issues in libfsimage\n  (XSA-443) (bsc#1215747).\n- CVE-2023-34327, CVE-2023-34328: Fixed multiple issues with AMD x86\n  debugging functionality for guests (XSA-444) (bsc#1215748).\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-2023-4184,SUSE-SLE-Product-HPC-15-SP1-LTSS-2023-4184,SUSE-SLE-Product-SLES-15-SP1-LTSS-2023-4184,SUSE-SLE-Product-SLES_SAP-15-SP1-2023-4184",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "xen-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-devel-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-devel-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-devel-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.12.4_40-150100.3.95.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2023/suse-su-20234184-1/",
      "Description": "Link for SUSE-SU-2023:4184-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-security-updates/2023-October/016830.html",
      "Description": "E-Mail link for SUSE-SU-2023:4184-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1215744",
      "Description": "SUSE Bug 1215744"
    },
    {
      "URL": "https://bugzilla.suse.com/1215746",
      "Description": "SUSE Bug 1215746"
    },
    {
      "URL": "https://bugzilla.suse.com/1215747",
      "Description": "SUSE Bug 1215747"
    },
    {
      "URL": "https://bugzilla.suse.com/1215748",
      "Description": "SUSE Bug 1215748"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2023-34323/",
      "Description": "SUSE CVE CVE-2023-34323 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2023-34325/",
      "Description": "SUSE CVE CVE-2023-34325 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2023-34326/",
      "Description": "SUSE CVE CVE-2023-34326 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2023-34327/",
      "Description": "SUSE CVE CVE-2023-34327 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2023-34328/",
      "Description": "SUSE CVE CVE-2023-34328 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2023-34323",
      "Description": "When a transaction is committed, C Xenstored will first check\nthe quota is correct before attempting to commit any nodes.  It would\nbe possible that accounting is temporarily negative if a node has\nbeen removed outside of the transaction.\n\nUnfortunately, some versions of C Xenstored are assuming that the\nquota cannot be negative and are using assert() to confirm it.  This\nwill lead to C Xenstored crash when tools are built without -DNDEBUG\n(this is the default).\n",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2023-34323.html",
          "Description": "CVE-2023-34323"
        },
        {
          "URL": "https://bugzilla.suse.com/1215744",
          "Description": "SUSE Bug 1215744"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-domU-4.12.4_40-150100.3.95.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2023-34325",
      "Description": "\n[This CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nlibfsimage contains parsing code for several filesystems, most of them based on\ngrub-legacy code.  libfsimage is used by pygrub to inspect guest disks.\n\nPygrub runs as the same user as the toolstack (root in a priviledged domain).\n\nAt least one issue has been reported to the Xen Security Team that allows an\nattacker to trigger a stack buffer overflow in libfsimage.  After further\nanalisys the Xen Security Team is no longer confident in the suitability of\nlibfsimage when run against guest controlled input with super user priviledges.\n\nIn order to not affect current deployments that rely on pygrub patches are\nprovided in the resolution section of the advisory that allow running pygrub in\ndeprivileged mode.\n\nCVE-2023-4949 refers to the original issue in the upstream grub\nproject (\"An attacker with local access to a system (either through a\ndisk or external drive) can present a modified XFS partition to\ngrub-legacy in such a way to exploit a memory corruption in grub’s XFS\nfile system implementation.\")  CVE-2023-34325 refers specifically to\nthe vulnerabilities in Xen's copy of libfsimage, which is decended\nfrom a very old version of grub.\n",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2023-34325.html",
          "Description": "CVE-2023-34325"
        },
        {
          "URL": "https://bugzilla.suse.com/1215747",
          "Description": "SUSE Bug 1215747"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-domU-4.12.4_40-150100.3.95.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2023-34326",
      "Description": "The caching invalidation guidelines from the AMD-Vi specification (48882—Rev\n3.07-PUB—Oct 2022) is incorrect on some hardware, as devices will malfunction\n(see stale DMA mappings) if some fields of the DTE are updated but the IOMMU\nTLB is not flushed.\n\nSuch stale DMA mappings can point to memory ranges not owned by the guest, thus\nallowing access to unindented memory regions.\n",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2023-34326.html",
          "Description": "CVE-2023-34326"
        },
        {
          "URL": "https://bugzilla.suse.com/1215746",
          "Description": "SUSE Bug 1215746"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-domU-4.12.4_40-150100.3.95.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2023-34327",
      "Description": "\n[This CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nAMD CPUs since ~2014 have extensions to normal x86 debugging functionality.\nXen supports guests using these extensions.\n\nUnfortunately there are errors in Xen's handling of the guest state, leading\nto denials of service.\n\n 1) CVE-2023-34327 - An HVM vCPU can end up operating in the context of\n    a previous vCPUs debug mask state.\n\n 2) CVE-2023-34328 - A PV vCPU can place a breakpoint over the live GDT.\n    This allows the PV vCPU to exploit XSA-156 / CVE-2015-8104 and lock\n    up the CPU entirely.\n",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2023-34327.html",
          "Description": "CVE-2023-34327"
        },
        {
          "URL": "https://bugzilla.suse.com/1215748",
          "Description": "SUSE Bug 1215748"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-domU-4.12.4_40-150100.3.95.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2023-34328",
      "Description": "\n[This CNA information record relates to multiple CVEs; the\ntext explains which aspects/vulnerabilities correspond to which CVE.]\n\nAMD CPUs since ~2014 have extensions to normal x86 debugging functionality.\nXen supports guests using these extensions.\n\nUnfortunately there are errors in Xen's handling of the guest state, leading\nto denials of service.\n\n 1) CVE-2023-34327 - An HVM vCPU can end up operating in the context of\n    a previous vCPUs debug mask state.\n\n 2) CVE-2023-34328 - A PV vCPU can place a breakpoint over the live GDT.\n    This allows the PV vCPU to exploit XSA-156 / CVE-2015-8104 and lock\n    up the CPU entirely.\n",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2023-34328.html",
          "Description": "CVE-2023-34328"
        },
        {
          "URL": "https://bugzilla.suse.com/1215748",
          "Description": "SUSE Bug 1215748"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:xen-tools-domU-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-devel-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-libs-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-4.12.4_40-150100.3.95.1",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:xen-tools-domU-4.12.4_40-150100.3.95.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}