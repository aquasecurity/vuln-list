{
  "Title": "Security update for kernel-livepatch-MICRO-6-0_Update_7",
  "Tracking": {
    "ID": "SUSE-SU-2025:20701-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2025-09-11T15:44:34Z",
    "CurrentReleaseDate": "2025-09-11T15:44:34Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2025-09-11T15:44:34Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for kernel-livepatch-MICRO-6-0_Update_7",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for kernel-livepatch-MICRO-6-0_Update_7 fixes the following issues:\n\n- CVE-2025-38087: net/sched: fix use-after-free in taprio_dev_notifier (bsc#1245505)\n- CVE-2025-38001: net_sched: hfsc: Address reentrant enqueue adding class to eltree twice (bsc#1244235)\n- CVE-2025-38000: sch_hfsc: Fix qlen accounting bug when using peek in hfsc_enqueue() (bsc#1245775)\n- CVE-2025-38212: ipc: fix to protect IPCS lookups using RCU (bsc#1246030)\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-SLE-Micro-6.0-kernel-107",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "kernel-livepatch-6_4_0-29-default-4-1.2",
        "RelatesToProductReference": "SUSE Linux Micro 6.0",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2025/suse-su-202520701-1/",
      "Description": "Link for SUSE-SU-2025:20701-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-updates/2025-September/041753.html",
      "Description": "E-Mail link for SUSE-SU-2025:20701-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1244235",
      "Description": "SUSE Bug 1244235"
    },
    {
      "URL": "https://bugzilla.suse.com/1245505",
      "Description": "SUSE Bug 1245505"
    },
    {
      "URL": "https://bugzilla.suse.com/1245775",
      "Description": "SUSE Bug 1245775"
    },
    {
      "URL": "https://bugzilla.suse.com/1246030",
      "Description": "SUSE Bug 1246030"
    },
    {
      "URL": "https://bugzilla.suse.com/1248108",
      "Description": "SUSE Bug 1248108"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-38000/",
      "Description": "SUSE CVE CVE-2025-38000 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-38001/",
      "Description": "SUSE CVE CVE-2025-38001 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-38087/",
      "Description": "SUSE CVE CVE-2025-38087 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-38212/",
      "Description": "SUSE CVE CVE-2025-38212 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2025-38000",
      "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsch_hfsc: Fix qlen accounting bug when using peek in hfsc_enqueue()\n\nWhen enqueuing the first packet to an HFSC class, hfsc_enqueue() calls the\nchild qdisc's peek() operation before incrementing sch-\u003eq.qlen and\nsch-\u003eqstats.backlog. If the child qdisc uses qdisc_peek_dequeued(), this may\ntrigger an immediate dequeue and potential packet drop. In such cases,\nqdisc_tree_reduce_backlog() is called, but the HFSC qdisc's qlen and backlog\nhave not yet been updated, leading to inconsistent queue accounting. This\ncan leave an empty HFSC class in the active list, causing further\nconsequences like use-after-free.\n\nThis patch fixes the bug by moving the increment of sch-\u003eq.qlen and\nsch-\u003eqstats.backlog before the call to the child qdisc's peek() operation.\nThis ensures that queue length and backlog are always accurate when packet\ndrops or dequeues are triggered during the peek.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-38000.html",
          "Description": "CVE-2025-38000"
        },
        {
          "URL": "https://bugzilla.suse.com/1244277",
          "Description": "SUSE Bug 1244277"
        },
        {
          "URL": "https://bugzilla.suse.com/1245775",
          "Description": "SUSE Bug 1245775"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Micro 6.0:kernel-livepatch-6_4_0-29-default-4-1.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2025-38001",
      "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet_sched: hfsc: Address reentrant enqueue adding class to eltree twice\n\nSavino says:\n    \"We are writing to report that this recent patch\n    (141d34391abbb315d68556b7c67ad97885407547) [1]\n    can be bypassed, and a UAF can still occur when HFSC is utilized with\n    NETEM.\n\n    The patch only checks the cl-\u003ecl_nactive field to determine whether\n    it is the first insertion or not [2], but this field is only\n    incremented by init_vf [3].\n\n    By using HFSC_RSC (which uses init_ed) [4], it is possible to bypass the\n    check and insert the class twice in the eltree.\n    Under normal conditions, this would lead to an infinite loop in\n    hfsc_dequeue for the reasons we already explained in this report [5].\n\n    However, if TBF is added as root qdisc and it is configured with a\n    very low rate,\n    it can be utilized to prevent packets from being dequeued.\n    This behavior can be exploited to perform subsequent insertions in the\n    HFSC eltree and cause a UAF.\"\n\nTo fix both the UAF and the infinite loop, with netem as an hfsc child,\ncheck explicitly in hfsc_enqueue whether the class is already in the eltree\nwhenever the HFSC_RSC flag is set.\n\n[1] https://web.git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=141d34391abbb315d68556b7c67ad97885407547\n[2] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L1572\n[3] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L677\n[4] https://elixir.bootlin.com/linux/v6.15-rc5/source/net/sched/sch_hfsc.c#L1574\n[5] https://lore.kernel.org/netdev/8DuRWwfqjoRDLDmBMlIfbrsZg9Gx50DHJc1ilxsEBNe2D6NMoigR_eIRIG0LOjMc3r10nUUZtArXx4oZBIdUfZQrwjcQhdinnMis_0G7VEk=@willsroot.io/T/#u",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-38001.html",
          "Description": "CVE-2025-38001"
        },
        {
          "URL": "https://bugzilla.suse.com/1244234",
          "Description": "SUSE Bug 1244234"
        },
        {
          "URL": "https://bugzilla.suse.com/1244235",
          "Description": "SUSE Bug 1244235"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Micro 6.0:kernel-livepatch-6_4_0-29-default-4-1.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2025-38087",
      "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/sched: fix use-after-free in taprio_dev_notifier\n\nSince taprio's taprio_dev_notifier() isn't protected by an\nRCU read-side critical section, a race with advance_sched()\ncan lead to a use-after-free.\n\nAdding rcu_read_lock() inside taprio_dev_notifier() prevents this.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-38087.html",
          "Description": "CVE-2025-38087"
        },
        {
          "URL": "https://bugzilla.suse.com/1245504",
          "Description": "SUSE Bug 1245504"
        },
        {
          "URL": "https://bugzilla.suse.com/1245505",
          "Description": "SUSE Bug 1245505"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Micro 6.0:kernel-livepatch-6_4_0-29-default-4-1.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2025-38212",
      "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nipc: fix to protect IPCS lookups using RCU\n\nsyzbot reported that it discovered a use-after-free vulnerability, [0]\n\n[0]: https://lore.kernel.org/all/67af13f8.050a0220.21dd3.0038.GAE@google.com/\n\nidr_for_each() is protected by rwsem, but this is not enough.  If it is\nnot protected by RCU read-critical region, when idr_for_each() calls\nradix_tree_node_free() through call_rcu() to free the radix_tree_node\nstructure, the node will be freed immediately, and when reading the next\nnode in radix_tree_for_each_slot(), the already freed memory may be read.\n\nTherefore, we need to add code to make sure that idr_for_each() is\nprotected within the RCU read-critical region when we call it in\nshm_destroy_orphaned().",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-38212.html",
          "Description": "CVE-2025-38212"
        },
        {
          "URL": "https://bugzilla.suse.com/1246029",
          "Description": "SUSE Bug 1246029"
        },
        {
          "URL": "https://bugzilla.suse.com/1246030",
          "Description": "SUSE Bug 1246030"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Micro 6.0:kernel-livepatch-6_4_0-29-default-4-1.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}