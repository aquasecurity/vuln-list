{
  "Title": "Security update for rubygem-rack",
  "Tracking": {
    "ID": "SUSE-SU-2025:4273-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2025-11-27T08:12:25Z",
    "CurrentReleaseDate": "2025-11-27T08:12:25Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2025-11-27T08:12:25Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for rubygem-rack",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for rubygem-rack fixes the following issues:\n\n- Update to version 2.2.20 (bsc#1251936)\n- CVE-2025-61919: Fixed application/x-www-form-urlencoded`, calling `rack.input.read(nil)` without enforcing a length or cap (bsc#1251936)\n- CVE-2025-61780: Fixed improper handling of headers in `Rack::Sendfile` allows for bypass of proxy-level access restrictions (bsc#1253951)\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-2025-4273,SUSE-SLE-Product-HA-15-SP3-2025-4273,SUSE-SLE-Product-HA-15-SP4-2025-4273,SUSE-SLE-Product-HA-15-SP5-2025-4273,SUSE-SLE-Product-HA-15-SP6-2025-4273,SUSE-SLE-Product-HA-15-SP7-2025-4273,openSUSE-SLE-15.6-2025-4273",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Availability Extension 15 SP3",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Availability Extension 15 SP4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Availability Extension 15 SP5",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Availability Extension 15 SP6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "SUSE Linux Enterprise High Availability Extension 15 SP7",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "openSUSE Leap 15.6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "ruby2.5-rubygem-rack-doc-2.2.20-150000.3.34.1",
        "RelatesToProductReference": "openSUSE Leap 15.6",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2025/suse-su-20254273-1/",
      "Description": "Link for SUSE-SU-2025:4273-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-security-updates/2025-November/023401.html",
      "Description": "E-Mail link for SUSE-SU-2025:4273-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1251936",
      "Description": "SUSE Bug 1251936"
    },
    {
      "URL": "https://bugzilla.suse.com/1253951",
      "Description": "SUSE Bug 1253951"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-61780/",
      "Description": "SUSE CVE CVE-2025-61780 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2025-61919/",
      "Description": "SUSE CVE CVE-2025-61919 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2025-61780",
      "Description": "Rack is a modular Ruby web server interface. Prior to versions 2.2.20, 3.1.18, and 3.2.3, a possible information disclosure vulnerability existed in `Rack::Sendfile` when running behind a proxy that supports `x-sendfile` headers (such as Nginx). Specially crafted headers could cause `Rack::Sendfile` to miscommunicate with the proxy and trigger unintended internal requests, potentially bypassing proxy-level access restrictions. When `Rack::Sendfile` received untrusted `x-sendfile-type` or `x-accel-mapping` headers from a client, it would interpret them as proxy configuration directives. This could cause the middleware to send a \"redirect\" response to the proxy, prompting it to reissue a new internal request that was not subject to the proxy's access controls. An attacker could exploit this by setting a crafted `x-sendfile-type: x-accel-redirect` header, setting a crafted `x-accel-mapping` header, and requesting a path that qualifies for proxy-based acceleration. Attackers could bypass proxy-enforced restrictions and access internal endpoints intended to be protected (such as administrative pages). The vulnerability did not allow arbitrary file reads but could expose sensitive application routes. This issue only affected systems meeting all of the following conditions: The application used `Rack::Sendfile` with a proxy that supports `x-accel-redirect` (e.g., Nginx); the proxy did **not** always set or remove the `x-sendfile-type` and `x-accel-mapping` headers; and the application exposed an endpoint that returned a body responding to `.to_path`. Users should upgrade to Rack versions 2.2.20, 3.1.18, or 3.2.3, which require explicit configuration to enable `x-accel-redirect`. Alternatively, configure the proxy to always set or strip the header, or in Rails applications, disable sendfile completely.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-61780.html",
          "Description": "CVE-2025-61780"
        },
        {
          "URL": "https://bugzilla.suse.com/1251896",
          "Description": "SUSE Bug 1251896"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Availability Extension 15 SP3:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP4:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP5:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP6:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP7:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "openSUSE Leap 15.6:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "openSUSE Leap 15.6:ruby2.5-rubygem-rack-doc-2.2.20-150000.3.34.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2025-61919",
      "Description": "Rack is a modular Ruby web server interface. Prior to versions 2.2.20, 3.1.18, and 3.2.3, `Rack::Request#POST` reads the entire request body into memory for `Content-Type: application/x-www-form-urlencoded`, calling `rack.input.read(nil)` without enforcing a length or cap. Large request bodies can therefore be buffered completely into process memory before parsing, leading to denial of service (DoS) through memory exhaustion. Users should upgrade to Rack version 2.2.20, 3.1.18, or 3.2.3, anu of which enforces form parameter limits using `query_parser.bytesize_limit`, preventing unbounded reads of `application/x-www-form-urlencoded` bodies. Additionally, enforce strict maximum body size at the proxy or web server layer (e.g., Nginx `client_max_body_size`, Apache `LimitRequestBody`).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2025-61919.html",
          "Description": "CVE-2025-61919"
        },
        {
          "URL": "https://bugzilla.suse.com/1251934",
          "Description": "SUSE Bug 1251934"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise High Availability Extension 15 SP3:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP4:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP5:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP6:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "SUSE Linux Enterprise High Availability Extension 15 SP7:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "openSUSE Leap 15.6:ruby2.5-rubygem-rack-2.2.20-150000.3.34.1",
            "openSUSE Leap 15.6:ruby2.5-rubygem-rack-doc-2.2.20-150000.3.34.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}