{
  "Title": "Security update for flatpak",
  "Tracking": {
    "ID": "SUSE-SU-2022:2990-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2022-09-01T13:47:39Z",
    "CurrentReleaseDate": "2022-09-01T13:47:39Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2022-09-01T13:47:39Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for flatpak",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for flatpak fixes the following issues:\n\n- CVE-2021-21381: Fixed an issue where a sandboxed application could\n  read and write arbitrary host files via special tokens in the\n  .desktop file (bsc#1183459).\n- CVE-2021-21261: Fixed a sandbox escape issue via the flatpak-portal\n  service (bsc#1180996).\n\nNon-security fixes:\n\n- openh264 extension needs to use 'extra_data'. (bsc#1155688)\n  The update will provide the support for extra_data' in extensions\n  and will provide a list of versions that are supported. This will\n  be useful for the extra_data for extensions because that will require\n  it to say that it is supported for version \u003e 1.2.5 in the 1.2 series \n  and \u003e 1.4.2 otherwise.\n  The update  will includes fixes for a segfault in the function that \n  lists the installed references (flatpak_installation_list_installed_refs).\n  When an appstream update is cancelled while downloading icons, the update\n  will show a proper fail. Before this fix the next update attempt will see\n  an up-to-date timestamp, think everyhing is ok and not download the missing icons.\n  The update will introduce checks in the OCI (Open Container Initiative format)\n  updates for validating if it is gpg verified.\n  The update will install the required runtime for the installed extension.\n  The update will prevent a crash if the 'FlatpakDir' can't ensure it has a repo configured.\n  The update will prevent the removal of local extensions considered remote and not locally related.\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-2022-2990,SUSE-SLE-Product-HPC-15-SP1-ESPOS-2022-2990,SUSE-SLE-Product-HPC-15-SP1-LTSS-2022-2990,SUSE-SLE-Product-SLES-15-SP1-BCL-2022-2990,SUSE-SLE-Product-SLES-15-SP1-LTSS-2022-2990,SUSE-SLE-Product-SLES_SAP-15-SP1-2022-2990,SUSE-Storage-6-2022-2990",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Enterprise Storage 6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Enterprise Storage 6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Enterprise Storage 6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Enterprise Storage 6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Enterprise Storage 6",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-BCL",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-BCL",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-BCL",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-BCL",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-BCL",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server 15 SP1-LTSS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-devel-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "flatpak-zsh-completion-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libflatpak0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
        "RelatesToProductReference": "SUSE Linux Enterprise Server for SAP Applications 15 SP1",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2022/suse-su-20222990-1/",
      "Description": "Link for SUSE-SU-2022:2990-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-security-updates/2022-September/012061.html",
      "Description": "E-Mail link for SUSE-SU-2022:2990-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1155688",
      "Description": "SUSE Bug 1155688"
    },
    {
      "URL": "https://bugzilla.suse.com/1180996",
      "Description": "SUSE Bug 1180996"
    },
    {
      "URL": "https://bugzilla.suse.com/1183459",
      "Description": "SUSE Bug 1183459"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2021-21261/",
      "Description": "SUSE CVE CVE-2021-21261 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2021-21381/",
      "Description": "SUSE CVE CVE-2021-21381 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2021-21261",
      "Description": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. A bug was discovered in the `flatpak-portal` service that can allow sandboxed applications to execute arbitrary code on the host system (a sandbox escape). This sandbox-escape bug is present in versions from 0.11.4 and before fixed versions 1.8.5 and 1.10.0. The Flatpak portal D-Bus service (`flatpak-portal`, also known by its D-Bus service name `org.freedesktop.portal.Flatpak`) allows apps in a Flatpak sandbox to launch their own subprocesses in a new sandbox instance, either with the same security settings as the caller or with more restrictive security settings. For example, this is used in Flatpak-packaged web browsers such as Chromium to launch subprocesses that will process untrusted web content, and give those subprocesses a more restrictive sandbox than the browser itself. In vulnerable versions, the Flatpak portal service passes caller-specified environment variables to non-sandboxed processes on the host system, and in particular to the `flatpak run` command that is used to launch the new sandbox instance. A malicious or compromised Flatpak app could set environment variables that are trusted by the `flatpak run` command, and use them to execute arbitrary code that is not in a sandbox. As a workaround, this vulnerability can be mitigated by preventing the `flatpak-portal` service from starting, but that mitigation will prevent many Flatpak apps from working correctly. This is fixed in versions 1.8.5 and 1.10.0.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2021-21261.html",
          "Description": "CVE-2021-21261"
        },
        {
          "URL": "https://bugzilla.suse.com/1180996",
          "Description": "SUSE Bug 1180996"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Enterprise Storage 6:flatpak-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2021-21381",
      "Description": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. In Flatpack since version 0.9.4 and before version 1.10.2 has a vulnerability in the \"file forwarding\" feature which can be used by an attacker to gain access to files that would not ordinarily be allowed by the app's permissions. By putting the special tokens `@@` and/or `@@u` in the Exec field of a Flatpak app's .desktop file, a malicious app publisher can trick flatpak into behaving as though the user had chosen to open a target file with their Flatpak app, which automatically makes that file available to the Flatpak app. This is fixed in version 1.10.2. A minimal solution is the first commit \"`Disallow @@ and @@U usage in desktop files`\". The follow-up commits \"`dir: Reserve the whole @@ prefix`\" and \"`dir: Refuse to export .desktop files with suspicious uses of @@ tokens`\" are recommended, but not strictly required. As a workaround, avoid installing Flatpak apps from untrusted sources, or check the contents of the exported `.desktop` files in `exports/share/applications/*.desktop` (typically `~/.local/share/flatpak/exports/share/applications/*.desktop` and `/var/lib/flatpak/exports/share/applications/*.desktop`) to make sure that literal filenames do not follow `@@` or `@@u`.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2021-21381.html",
          "Description": "CVE-2021-21381"
        },
        {
          "URL": "https://bugzilla.suse.com/1183459",
          "Description": "SUSE Bug 1183459"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Enterprise Storage 6:flatpak-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Enterprise Storage 6:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-BCL:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server 15 SP1-LTSS:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-devel-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:flatpak-zsh-completion-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:libflatpak0-1.2.3-150100.4.5.2",
            "SUSE Linux Enterprise Server for SAP Applications 15 SP1:typelib-1_0-Flatpak-1_0-1.2.3-150100.4.5.2"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}