{
  "Title": "Security update for openssl-3",
  "Tracking": {
    "ID": "SUSE-SU-2022:2306-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2022-07-06T11:49:35Z",
    "CurrentReleaseDate": "2022-07-06T11:49:35Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2022-07-06T11:49:35Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for openssl-3",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for openssl-3 fixes the following issues:\n\n- CVE-2022-2068: Fixed more shell code injection issues in c_rehash. (bsc#1200550)\n- CVE-2022-1292: Properly sanitise shell metacharacters in c_rehash script. (bsc#1199166) \n- CVE-2022-1343: Fixed incorrect signature verification in OCSP_basic_verify (bsc#1199167).\n- CVE-2022-2097: Fixed partial missing encryption in AES OCB mode (bsc#1201099).\n- CVE-2022-1434: Fixed incorrect MAC key used in the RC4-MD5 ciphersuite (bsc#1199168).\n- CVE-2022-1473: Fixed resource leakage when decoding certificates and keys (bsc#1199169).\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-2022-2306,SUSE-SLE-Module-Basesystem-15-SP4-2022-2306,openSUSE-SLE-15.4-2022-2306",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "libopenssl-3-devel-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Basesystem 15 SP4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libopenssl3-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Basesystem 15 SP4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "openssl-3-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Basesystem 15 SP4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libopenssl-3-devel-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libopenssl3-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "libopenssl3-32bit-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "openssl-3-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "openssl-3-doc-3.0.1-150400.4.7.1",
        "RelatesToProductReference": "openSUSE Leap 15.4",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2022/suse-su-20222306-1/",
      "Description": "Link for SUSE-SU-2022:2306-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-updates/2022-July/023781.html",
      "Description": "E-Mail link for SUSE-SU-2022:2306-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1185637",
      "Description": "SUSE Bug 1185637"
    },
    {
      "URL": "https://bugzilla.suse.com/1199166",
      "Description": "SUSE Bug 1199166"
    },
    {
      "URL": "https://bugzilla.suse.com/1199167",
      "Description": "SUSE Bug 1199167"
    },
    {
      "URL": "https://bugzilla.suse.com/1199168",
      "Description": "SUSE Bug 1199168"
    },
    {
      "URL": "https://bugzilla.suse.com/1199169",
      "Description": "SUSE Bug 1199169"
    },
    {
      "URL": "https://bugzilla.suse.com/1200550",
      "Description": "SUSE Bug 1200550"
    },
    {
      "URL": "https://bugzilla.suse.com/1201099",
      "Description": "SUSE Bug 1201099"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-1292/",
      "Description": "SUSE CVE CVE-2022-1292 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-1343/",
      "Description": "SUSE CVE CVE-2022-1343 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-1434/",
      "Description": "SUSE CVE CVE-2022-1434 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-1473/",
      "Description": "SUSE CVE CVE-2022-1473 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-2068/",
      "Description": "SUSE CVE CVE-2022-2068 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2022-2097/",
      "Description": "SUSE CVE CVE-2022-2097 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2022-1292",
      "Description": "The c_rehash script does not properly sanitise shell metacharacters to prevent command injection. This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script. Use of the c_rehash script is considered obsolete and should be replaced by the OpenSSL rehash command line tool. Fixed in OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2). Fixed in OpenSSL 1.1.1o (Affected 1.1.1-1.1.1n). Fixed in OpenSSL 1.0.2ze (Affected 1.0.2-1.0.2zd).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-1292.html",
          "Description": "CVE-2022-1292"
        },
        {
          "URL": "https://bugzilla.suse.com/1199166",
          "Description": "SUSE Bug 1199166"
        },
        {
          "URL": "https://bugzilla.suse.com/1200550",
          "Description": "SUSE Bug 1200550"
        },
        {
          "URL": "https://bugzilla.suse.com/1200650",
          "Description": "SUSE Bug 1200650"
        },
        {
          "URL": "https://bugzilla.suse.com/1200758",
          "Description": "SUSE Bug 1200758"
        },
        {
          "URL": "https://bugzilla.suse.com/1202688",
          "Description": "SUSE Bug 1202688"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2022-1343",
      "Description": "The function `OCSP_basic_verify` verifies the signer certificate on an OCSP response. In the case where the (non-default) flag OCSP_NOCHECKS is used then the response will be positive (meaning a successful verification) even in the case where the response signing certificate fails to verify. It is anticipated that most users of `OCSP_basic_verify` will not use the OCSP_NOCHECKS flag. In this case the `OCSP_basic_verify` function will return a negative value (indicating a fatal error) in the case of a certificate verification failure. The normal expected return value in this case would be 0. This issue also impacts the command line OpenSSL \"ocsp\" application. When verifying an ocsp response with the \"-no_cert_checks\" option the command line application will report that the verification is successful even though it has in fact failed. In this case the incorrect successful response will also be accompanied by error messages showing the failure and contradicting the apparently successful result. Fixed in OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-1343.html",
          "Description": "CVE-2022-1343"
        },
        {
          "URL": "https://bugzilla.suse.com/1199167",
          "Description": "SUSE Bug 1199167"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2022-1434",
      "Description": "The OpenSSL 3.0 implementation of the RC4-MD5 ciphersuite incorrectly uses the AAD data as the MAC key. This makes the MAC key trivially predictable. An attacker could exploit this issue by performing a man-in-the-middle attack to modify data being sent from one endpoint to an OpenSSL 3.0 recipient such that the modified data would still pass the MAC integrity check. Note that data sent from an OpenSSL 3.0 endpoint to a non-OpenSSL 3.0 endpoint will always be rejected by the recipient and the connection will fail at that point. Many application protocols require data to be sent from the client to the server first. Therefore, in such a case, only an OpenSSL 3.0 server would be impacted when talking to a non-OpenSSL 3.0 client. If both endpoints are OpenSSL 3.0 then the attacker could modify data being sent in both directions. In this case both clients and servers could be affected, regardless of the application protocol. Note that in the absence of an attacker this bug means that an OpenSSL 3.0 endpoint communicating with a non-OpenSSL 3.0 endpoint will fail to complete the handshake when using this ciphersuite. The confidentiality of data is not impacted by this issue, i.e. an attacker cannot decrypt data that has been encrypted using this ciphersuite - they can only modify it. In order for this attack to work both endpoints must legitimately negotiate the RC4-MD5 ciphersuite. This ciphersuite is not compiled by default in OpenSSL 3.0, and is not available within the default provider or the default ciphersuite list. This ciphersuite will never be used if TLSv1.3 has been negotiated. In order for an OpenSSL 3.0 endpoint to use this ciphersuite the following must have occurred: 1) OpenSSL must have been compiled with the (non-default) compile time option enable-weak-ssl-ciphers 2) OpenSSL must have had the legacy provider explicitly loaded (either through application code or via configuration) 3) The ciphersuite must have been explicitly added to the ciphersuite list 4) The libssl security level must have been set to 0 (default is 1) 5) A version of SSL/TLS below TLSv1.3 must have been negotiated 6) Both endpoints must negotiate the RC4-MD5 ciphersuite in preference to any others that both endpoints have in common Fixed in OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-1434.html",
          "Description": "CVE-2022-1434"
        },
        {
          "URL": "https://bugzilla.suse.com/1199168",
          "Description": "SUSE Bug 1199168"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2022-1473",
      "Description": "The OPENSSL_LH_flush() function, which empties a hash table, contains a bug that breaks reuse of the memory occuppied by the removed hash table entries. This function is used when decoding certificates or keys. If a long lived process periodically decodes certificates or keys its memory usage will expand without bounds and the process might be terminated by the operating system causing a denial of service. Also traversing the empty hash table entries will take increasingly more time. Typically such long lived processes might be TLS clients or TLS servers configured to accept client certificate authentication. The function was added in the OpenSSL 3.0 version thus older releases are not affected by the issue. Fixed in OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-1473.html",
          "Description": "CVE-2022-1473"
        },
        {
          "URL": "https://bugzilla.suse.com/1199168",
          "Description": "SUSE Bug 1199168"
        },
        {
          "URL": "https://bugzilla.suse.com/1199169",
          "Description": "SUSE Bug 1199169"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2022-2068",
      "Description": "In addition to the c_rehash shell command injection identified in CVE-2022-1292, further circumstances where the c_rehash script does not properly sanitise shell metacharacters to prevent command injection were found by code review. When the CVE-2022-1292 was fixed it was not discovered that there are other places in the script where the file names of certificates being hashed were possibly passed to a command executed through the shell. This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script. Use of the c_rehash script is considered obsolete and should be replaced by the OpenSSL rehash command line tool. Fixed in OpenSSL 3.0.4 (Affected 3.0.0,3.0.1,3.0.2,3.0.3). Fixed in OpenSSL 1.1.1p (Affected 1.1.1-1.1.1o). Fixed in OpenSSL 1.0.2zf (Affected 1.0.2-1.0.2ze).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-2068.html",
          "Description": "CVE-2022-2068"
        },
        {
          "URL": "https://bugzilla.suse.com/1200550",
          "Description": "SUSE Bug 1200550"
        },
        {
          "URL": "https://bugzilla.suse.com/1207568",
          "Description": "SUSE Bug 1207568"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2022-2097",
      "Description": "AES OCB mode for 32-bit x86 platforms using the AES-NI assembly optimised implementation will not encrypt the entirety of the data under some circumstances. This could reveal sixteen bytes of data that was preexisting in the memory that wasn't written. In the special case of \"in place\" encryption, sixteen bytes of the plaintext would be revealed. Since OpenSSL does not support OCB based cipher suites for TLS and DTLS, they are both unaffected. Fixed in OpenSSL 3.0.5 (Affected 3.0.0-3.0.4). Fixed in OpenSSL 1.1.1q (Affected 1.1.1-1.1.1p).",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2022-2097.html",
          "Description": "CVE-2022-2097"
        },
        {
          "URL": "https://bugzilla.suse.com/1201099",
          "Description": "SUSE Bug 1201099"
        },
        {
          "URL": "https://bugzilla.suse.com/1201332",
          "Description": "SUSE Bug 1201332"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:libopenssl3-3.0.1-150400.4.7.1",
            "SUSE Linux Enterprise Module for Basesystem 15 SP4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl-3-devel-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:libopenssl3-32bit-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-3.0.1-150400.4.7.1",
            "openSUSE Leap 15.4:openssl-3-doc-3.0.1-150400.4.7.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}