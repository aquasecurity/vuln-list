{
  "Title": "Security update for dovecot23",
  "Tracking": {
    "ID": "SUSE-SU-2019:0414-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2019-02-15T06:04:40Z",
    "CurrentReleaseDate": "2019-02-15T06:04:40Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2019-02-15T06:04:40Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for dovecot23",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "\nThis update for dovecot23 fixes the following issues:\n\ndovecot was updated to 2.3.3 release, bringing lots of bugfixes (bsc#1124356).\n\nAlso the following security issue was fixed:\n\n- CVE-2019-3814: A vulnerability in Dovecot related to SSL client certificate authentication  was fixed (bsc#1123022)\n\nThe package changes:\n\nUpdated pigeonhole to 0.5.3:\n\n- Fix assertion panic occurring when managesieve service fails to\n  open INBOX while saving a Sieve script. This was caused by a\n  lack of cleanup after failure.\n- Fix specific messages causing an assert panic with actions that\n  compose a reply (e.g. vacation). With some rather weird input\n  from the original message, the header folding algorithm (as\n  used for composing the References header for the reply) got\n  confused, causing the panic.\n- IMAP FILTER=SIEVE capability: Fix FILTER SIEVE SCRIPT command\n  parsing.  After finishing reading the Sieve script, the command\n  parsing sometimes didn't continue with the search arguments.\n  This is a time- critical bug that likely only occurs when the\n  Sieve script is sent in the next TCP frame.\n\ndovecot23 was updated to 2.3.3:\n\n- doveconf hides more secrets now in the default output.\n- ssl_dh setting is no longer enforced at startup. If it's not\n  set and non-ECC DH key exchange happens, error is logged and\n  client is disconnected.\n- Added log_debug=\u003cfilter\u003e setting.\n- Added log_core_filter=\u003clog filter\u003e setting.\n- quota-clone: Write to dict asynchronously\n- --enable-hardening attempts to use retpoline Spectre 2\n  mitigations\n- lmtp proxy: Support source_ip passdb extra field.\n- doveadm stats dump: Support more fields and output stddev\n  by default.\n- push-notification: Add SSL support for OX backend.\n- NUL bytes in mail headers can cause truncated replies when fetched.\n- director: Conflicting host up/down state changes may in some\n  rare situations ended up in a loop of two directors constantly\n  overwriting each others' changes.\n- director: Fix hang/crash when multiple doveadm commands are\n  being handled concurrently.\n- director: Fix assert-crash if doveadm disconnects too early\n- virtual plugin: Some searches used 100% CPU for many seconds\n- dsync assert-crashed with acl plugin in some situations. (bsc#1119850)\n- mail_attachment_detection_options=add-flags-on-save\n  assert-crashed with some specific Sieve scripts.\n- Mail snippet generation crashed with mails containing invalid\n  Content-Type:multipart header.\n- Log prefix ordering was different for some log lines.\n- quota: With noenforcing option current quota usage wasn't\n  updated.\n- auth: Kerberos authentication against Samba assert-crashed.\n- stats clients were unnecessarily chatty with the stats server.\n- imapc: Fixed various assert-crashes when reconnecting to\n  server.\n- lmtp, submission: Fix potential crash if client disconnects\n  while handling a command.\n- quota: Fixed compiling with glibc-2.26 / support libtirpc.\n- fts-solr: Empty search values resulted in 400 Bad Request\n  errors\n- fts-solr: default_ns parameter couldn't be used\n- submission server crashed if relay server returned over 7 lines\n  in a reply (e.g. to EHLO)\n\ndovecot was updated to 2.3.2.1:\n\n- SSL/TLS servers may have crashed during client disconnection\n- lmtp: With lmtp_rcpt_check_quota=yes mail deliveries may have\n  sometimes assert-crashed.\n- v2.3.2: 'make check' may have crashed with 32bit systems\n\ndovecot was updated to 2.3.2:\n\n- old-stats plugin: Don't temporarily enable PR_SET_DUMPABLE\n  while opening /proc/self/io. This may still cause security\n  problems if the process is ptrace()d at the same time.\n  Instead, open it while still running as root.\n- doveadm: Added mailbox cache decision\u0026remove commands. See\n  doveadm-mailbox(1) man page for details.\n- doveadm: Added rebuild attachments command for rebuilding\n  $HasAttachment or $HasNoAttachment flags for matching mails.\n  See doveadm-rebuild(1) man page for details.\n- cassandra: Use fallback_consistency on more types of errors\n- lmtp proxy: Support outgoing SSL/TLS connections\n- lmtp: Add lmtp_rawlog_dir and lmtp_proxy_rawlog_dir settings.\n- submission: Add support for rawlog_dir\n- submission: Add submission_client_workarounds setting.\n- lua auth: Add password_verify() function and additional fields\n  in auth request.\n- doveadm-server: TCP connections are hanging when there is a lot\n  of network output. This especially caused hangs in\n  dsync-replication.\n- Using multiple type=shared mdbox namespaces crashed\n- mail_fsync setting was ignored. It was always set to\n  'optimized'.\n- lua auth: Fix potential crash at deinit\n- SSL/TLS servers may have crashed if client disconnected during\n  handshake.\n- SSL/TLS servers: Don't send extraneous certificates to client\n  when alt certs are used.\n- lda, lmtp: Return-Path header without '\u003c' may have\n  assert-crashed.\n- lda, lmtp: Unencoded UTF-8 in email address headers may\n  assert-crash\n- lda: -f parameter didn't allow empty/null/domainless address\n- lmtp, submission: Message size limit was hardcoded to 40 MB.\n  Exceeding it caused the connection to get dropped during\n  transfer.\n- lmtp: Fix potential crash when delivery fails at DATA stage\n- lmtp: login_greeting setting was ignored\n- Fix to work with OpenSSL v1.0.2f\n- systemd unit restrictions were too strict by default\n- Fix potential crashes when a lot of log output was produced\n- SMTP client may have assert-crashed when sending mail\n- IMAP COMPRESS: Send 'end of compression' marker when\n  disconnecting.\n- cassandra: Fix consistency=quorum to work\n- dsync: Lock file generation failed if home directory didn't\n  exist\n- Snippet generation for HTML mails didn't ignore \u0026entities\n  inside blockquotes, producing strange looking snippets.\n- imapc: Fix assert-crash if getting disconnected and after\n  reconnection all mails in the selected mailbox are gone.\n- pop3c: Handle unexpected server disconnections without\n  assert-crash\n- fts: Fixes to indexing mails via virtual mailboxes.\n- fts: If mails contained NUL characters, the text around it\n  wasn't indexed.\n- Obsolete dovecot.index.cache offsets were sometimes used.\n  Trying to fetch a field that was just added to cache file may\n  not have always found it.\n\npigeonhole was updated to 0.5.2:\n\n- Implement plugin for the a vendor-defined IMAP capability\n  called 'FILTER=SIEVE'. It adds the ability to manually invoke\n  Sieve filtering in IMAP. More information can be found in\n  doc/plugins/imap_filter_sieve.txt.\n- The Sieve addess test caused an assertion panic for invalid\n  addresses with UTF-8 codepoints in the localpart. Fixed by\n  properly detecting invalid addresses with UTF-8 codepoints in\n  the localpart and skipping these like other invalid addresses\n  while iterating addresses for the address test.\n- Make the length of the subject header for the vacation response\n  configurable and enforce the limit in UTF-8 codepoints rather\n  than bytes. The subject header for a vacation response was\n  statically truncated to 256 bytes, which is too limited for\n  multi-byte UTF-8 characters.\n- Sieve editheader extension: Fix assertion panic occurring when\n  it is used to manipulate a message header with a very large\n  header field.\n- Properly abort execution of the sieve_discard script upon\n  error.  Before, the LDA Sieve plugin attempted to execute the\n  sieve_discard script when an error occurs. This can lead to the\n  message being lost.\n- Fix the interaction between quota and the sieve_discard script.\n  When quota was used together with a sieve_discard script, the\n  message delivery did not bounce when the quota was exceeded.\n- Fix crash for over quota users\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "SUSE-2019-414,SUSE-SLE-Module-Server-Applications-15-2019-414",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "dovecot23-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-backend-mysql-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-backend-pgsql-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-backend-sqlite-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-devel-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-fts-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-fts-lucene-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-fts-solr-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "dovecot23-fts-squat-2.3.3-4.7.4",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2019/suse-su-20190414-1/",
      "Description": "Link for SUSE-SU-2019:0414-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-security-updates/2019-February/005124.html",
      "Description": "E-Mail link for SUSE-SU-2019:0414-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1119850",
      "Description": "SUSE Bug 1119850"
    },
    {
      "URL": "https://bugzilla.suse.com/1123022",
      "Description": "SUSE Bug 1123022"
    },
    {
      "URL": "https://bugzilla.suse.com/1124356",
      "Description": "SUSE Bug 1124356"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-3814/",
      "Description": "SUSE CVE CVE-2019-3814 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2019-3814",
      "Description": "It was discovered that Dovecot before versions 2.2.36.1 and 2.3.4.1 incorrectly handled client certificates. A remote attacker in possession of a valid certificate with an empty username field could possibly use this issue to impersonate other users.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-3814.html",
          "Description": "CVE-2019-3814"
        },
        {
          "URL": "https://bugzilla.suse.com/1123022",
          "Description": "SUSE Bug 1123022"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-backend-mysql-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-backend-pgsql-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-backend-sqlite-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-devel-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-fts-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-fts-lucene-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-fts-solr-2.3.3-4.7.4",
            "SUSE Linux Enterprise Module for Server Applications 15:dovecot23-fts-squat-2.3.3-4.7.4"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}