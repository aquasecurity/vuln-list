{
  "Title": "Security update for xen",
  "Tracking": {
    "ID": "SUSE-SU-2019:3309-1",
    "Status": "Final",
    "Version": "1",
    "InitialReleaseDate": "2019-12-16T13:52:39Z",
    "CurrentReleaseDate": "2019-12-16T13:52:39Z",
    "RevisionHistory": [
      {
        "Number": "1",
        "Date": "2019-12-16T13:52:39Z",
        "Description": "current"
      }
    ]
  },
  "Notes": [
    {
      "Text": "Security update for xen",
      "Title": "Topic",
      "Type": "Summary"
    },
    {
      "Text": "This update for xen fixes the following issues:\n\n- CVE-2019-19581: Fixed a potential out of bounds on 32-bit Arm (bsc#1158003 XSA-307).\n- CVE-2019-19582: Fixed a potential infinite loop when x86 accesses to bitmaps with \n  a compile time known size of 64 (bsc#1158003 XSA-307).\n- CVE-2019-19583: Fixed improper checks which could have allowed HVM/PVH guest userspace \n  code to crash the guest,leading to a guest denial of service (bsc#1158004 XSA-308).\n- CVE-2019-19578: Fixed an issue where a malicious or buggy PV guest could have caused\n  hypervisor crash resulting in denial of service affecting the entire host (bsc#1158005 XSA-309).\n- CVE-2019-19580: Fixed a privilege escalation where a malicious PV guest administrator \n  could have been able to escalate their privilege to that of the host (bsc#1158006 XSA-310).\n- CVE-2019-19577: Fixed an issue where a malicious guest administrator could have caused Xen \n  to access data structures while they are being modified leading to a crash (bsc#1158007 XSA-311). \n- CVE-2019-19579: Fixed a privilege escaltion where an untrusted domain with access \n  to a physical device can DMA into host memory (bsc#1157888 XSA-306).\n- CVE-2019-18423: A malicious guest administrator may cause a hypervisor crash,\n  resulting in a Denial of Service (DoS) (bsc#1154460 XSA-301). \n- CVE-2019-18422: A malicious ARM guest might contrive to arrange for critical \n  Xen code to run with interrupts erroneously enabled. This could lead to data\n  corruption, denial of service, or possibly even privilege escalation. However\n  a precise attack technique has not been identified. (bsc#1154464 XSA-303)\n",
      "Title": "Details",
      "Type": "General"
    },
    {
      "Text": "The CVRF data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
      "Title": "Terms of Use",
      "Type": "Legal Disclaimer"
    },
    {
      "Text": "Image SLES15-EC2-CHOST-HVM-BYOS-2019-3309,Image SLES15-EC2-HVM-BYOS-2019-3309,Image SLES15-SAP-EC2-HVM-2019-3309,Image SLES15-SAP-EC2-HVM-BYOS-2019-3309,SUSE-2019-3309,SUSE-SLE-Module-Basesystem-15-2019-3309,SUSE-SLE-Module-Server-Applications-15-2019-3309",
      "Title": "Patchnames",
      "Type": "Details"
    }
  ],
  "ProductTree": {
    "Relationships": [
      {
        "ProductReference": "xen-libs-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-EC2-CHOST-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-EC2-CHOST-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-EC2-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-EC2-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-SAP-EC2-HVM",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-SAP-EC2-HVM",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-SAP-EC2-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.10.4_08-3.28.1",
        "RelatesToProductReference": "Image SLES15-SAP-EC2-HVM-BYOS",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-libs-4.10.4_08-3.28.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Basesystem 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-domU-4.10.4_08-3.28.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Basesystem 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-4.10.4_08-3.28.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-devel-4.10.4_08-3.28.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      },
      {
        "ProductReference": "xen-tools-4.10.4_08-3.28.1",
        "RelatesToProductReference": "SUSE Linux Enterprise Module for Server Applications 15",
        "RelationType": "Default Component Of"
      }
    ]
  },
  "References": [
    {
      "URL": "https://www.suse.com/support/update/announcement/2019/suse-su-20193309-1/",
      "Description": "Link for SUSE-SU-2019:3309-1"
    },
    {
      "URL": "https://lists.suse.com/pipermail/sle-security-updates/2019-December/006260.html",
      "Description": "E-Mail link for SUSE-SU-2019:3309-1"
    },
    {
      "URL": "https://www.suse.com/support/security/rating/",
      "Description": "SUSE Security Ratings"
    },
    {
      "URL": "https://bugzilla.suse.com/1154460",
      "Description": "SUSE Bug 1154460"
    },
    {
      "URL": "https://bugzilla.suse.com/1154464",
      "Description": "SUSE Bug 1154464"
    },
    {
      "URL": "https://bugzilla.suse.com/1157888",
      "Description": "SUSE Bug 1157888"
    },
    {
      "URL": "https://bugzilla.suse.com/1158003",
      "Description": "SUSE Bug 1158003"
    },
    {
      "URL": "https://bugzilla.suse.com/1158004",
      "Description": "SUSE Bug 1158004"
    },
    {
      "URL": "https://bugzilla.suse.com/1158005",
      "Description": "SUSE Bug 1158005"
    },
    {
      "URL": "https://bugzilla.suse.com/1158006",
      "Description": "SUSE Bug 1158006"
    },
    {
      "URL": "https://bugzilla.suse.com/1158007",
      "Description": "SUSE Bug 1158007"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-18422/",
      "Description": "SUSE CVE CVE-2019-18422 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-18423/",
      "Description": "SUSE CVE CVE-2019-18423 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19577/",
      "Description": "SUSE CVE CVE-2019-19577 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19578/",
      "Description": "SUSE CVE CVE-2019-19578 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19579/",
      "Description": "SUSE CVE CVE-2019-19579 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19580/",
      "Description": "SUSE CVE CVE-2019-19580 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19581/",
      "Description": "SUSE CVE CVE-2019-19581 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19582/",
      "Description": "SUSE CVE CVE-2019-19582 page"
    },
    {
      "URL": "https://www.suse.com/security/cve/CVE-2019-19583/",
      "Description": "SUSE CVE CVE-2019-19583 page"
    }
  ],
  "Vulnerabilities": [
    {
      "CVE": "CVE-2019-18422",
      "Description": "An issue was discovered in Xen through 4.12.x allowing ARM guest OS users to cause a denial of service or gain privileges by leveraging the erroneous enabling of interrupts. Interrupts are unconditionally unmasked in exception handlers. When an exception occurs on an ARM system which is handled without changing processor level, some interrupts are unconditionally enabled during exception entry. So exceptions which occur when interrupts are masked will effectively unmask the interrupts. A malicious guest might contrive to arrange for critical Xen code to run with interrupts erroneously enabled. This could lead to data corruption, denial of service, or possibly even privilege escalation. However a precise attack technique has not been identified.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-18422.html",
          "Description": "CVE-2019-18422"
        },
        {
          "URL": "https://bugzilla.suse.com/1154464",
          "Description": "SUSE Bug 1154464"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-18423",
      "Description": "An issue was discovered in Xen through 4.12.x allowing ARM guest OS users to cause a denial of service via a XENMEM_add_to_physmap hypercall. p2m-\u003emax_mapped_gfn is used by the functions p2m_resolve_translation_fault() and p2m_get_entry() to sanity check guest physical frame. The rest of the code in the two functions will assume that there is a valid root table and check that with BUG_ON(). The function p2m_get_root_pointer() will ignore the unused top bits of a guest physical frame. This means that the function p2m_set_entry() will alias the frame. However, p2m-\u003emax_mapped_gfn will be updated using the original frame. It would be possible to set p2m-\u003emax_mapped_gfn high enough to cover a frame that would lead p2m_get_root_pointer() to return NULL in p2m_get_entry() and p2m_resolve_translation_fault(). Additionally, the sanity check on p2m-\u003emax_mapped_gfn is off-by-one allowing \"highest mapped + 1\" to be considered valid. However, p2m_get_root_pointer() will return NULL. The problem could be triggered with a specially crafted hypercall XENMEM_add_to_physmap{, _batch} followed by an access to an address (via hypercall or direct access) that passes the sanity check but cause p2m_get_root_pointer() to return NULL. A malicious guest administrator may cause a hypervisor crash, resulting in a Denial of Service (DoS). Xen version 4.8 and newer are vulnerable. Only Arm systems are vulnerable. x86 systems are not affected.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-18423.html",
          "Description": "CVE-2019-18423"
        },
        {
          "URL": "https://bugzilla.suse.com/1154460",
          "Description": "SUSE Bug 1154460"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19577",
      "Description": "An issue was discovered in Xen through 4.12.x allowing x86 AMD HVM guest OS users to cause a denial of service or possibly gain privileges by triggering data-structure access during pagetable-height updates. When running on AMD systems with an IOMMU, Xen attempted to dynamically adapt the number of levels of pagetables (the pagetable height) in the IOMMU according to the guest's address space size. The code to select and update the height had several bugs. Notably, the update was done without taking a lock which is necessary for safe operation. A malicious guest administrator can cause Xen to access data structures while they are being modified, causing Xen to crash. Privilege escalation is thought to be very difficult but cannot be ruled out. Additionally, there is a potential memory leak of 4kb per guest boot, under memory pressure. Only Xen on AMD CPUs is vulnerable. Xen running on Intel CPUs is not vulnerable. ARM systems are not vulnerable. Only systems where guests are given direct access to physical devices are vulnerable. Systems which do not use PCI pass-through are not vulnerable. Only HVM guests can exploit the vulnerability. PV and PVH guests cannot. All versions of Xen with IOMMU support are vulnerable.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19577.html",
          "Description": "CVE-2019-19577"
        },
        {
          "URL": "https://bugzilla.suse.com/1158007",
          "Description": "SUSE Bug 1158007"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19578",
      "Description": "An issue was discovered in Xen through 4.12.x allowing x86 PV guest OS users to cause a denial of service via degenerate chains of linear pagetables, because of an incorrect fix for CVE-2017-15595. \"Linear pagetables\" is a technique which involves either pointing a pagetable at itself, or to another pagetable of the same or higher level. Xen has limited support for linear pagetables: A page may either point to itself, or point to another pagetable of the same level (i.e., L2 to L2, L3 to L3, and so on). XSA-240 introduced an additional restriction that limited the \"depth\" of such chains by allowing pages to either *point to* other pages of the same level, or *be pointed to* by other pages of the same level, but not both. To implement this, we keep track of the number of outstanding times a page points to or is pointed to another page table, to prevent both from happening at the same time. Unfortunately, the original commit introducing this reset this count when resuming validation of a partially-validated pagetable, incorrectly dropping some \"linear_pt_entry\" counts. If an attacker could engineer such a situation to occur, they might be able to make loops or other arbitrary chains of linear pagetables, as described in XSA-240. A malicious or buggy PV guest may cause the hypervisor to crash, resulting in Denial of Service (DoS) affecting the entire host. Privilege escalation and information leaks cannot be excluded. All versions of Xen are vulnerable. Only x86 systems are affected. Arm systems are not affected. Only x86 PV guests can leverage the vulnerability. x86 HVM and PVH guests cannot leverage the vulnerability. Only systems which have enabled linear pagetables are vulnerable. Systems which have disabled linear pagetables, either by selecting CONFIG_PV_LINEAR_PT=n when building the hypervisor, or adding pv-linear-pt=false on the command-line, are not vulnerable.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19578.html",
          "Description": "CVE-2019-19578"
        },
        {
          "URL": "https://bugzilla.suse.com/1158005",
          "Description": "SUSE Bug 1158005"
        },
        {
          "URL": "https://bugzilla.suse.com/1178658",
          "Description": "SUSE Bug 1178658"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19579",
      "Description": "An issue was discovered in Xen through 4.12.x allowing attackers to gain host OS privileges via DMA in a situation where an untrusted domain has access to a physical device (and assignable-add is not used), because of an incomplete fix for CVE-2019-18424. XSA-302 relies on the use of libxl's \"assignable-add\" feature to prepare devices to be assigned to untrusted guests. Unfortunately, this is not considered a strictly required step for device assignment. The PCI passthrough documentation on the wiki describes alternate ways of preparing devices for assignment, and libvirt uses its own ways as well. Hosts where these \"alternate\" methods are used will still leave the system in a vulnerable state after the device comes back from a guest. An untrusted domain with access to a physical device can DMA into host memory, leading to privilege escalation. Only systems where guests are given direct access to physical devices capable of DMA (PCI pass-through) are vulnerable. Systems which do not use PCI pass-through are not vulnerable.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19579.html",
          "Description": "CVE-2019-19579"
        },
        {
          "URL": "https://bugzilla.suse.com/1157888",
          "Description": "SUSE Bug 1157888"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19580",
      "Description": "An issue was discovered in Xen through 4.12.x allowing x86 PV guest OS users to gain host OS privileges by leveraging race conditions in pagetable promotion and demotion operations, because of an incomplete fix for CVE-2019-18421. XSA-299 addressed several critical issues in restartable PV type change operations. Despite extensive testing and auditing, some corner cases were missed. A malicious PV guest administrator may be able to escalate their privilege to that of the host. All security-supported versions of Xen are vulnerable. Only x86 systems are affected. Arm systems are not affected. Only x86 PV guests can leverage the vulnerability. x86 HVM and PVH guests cannot leverage the vulnerability. Note that these attacks require very precise timing, which may be difficult to exploit in practice.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19580.html",
          "Description": "CVE-2019-19580"
        },
        {
          "URL": "https://bugzilla.suse.com/1158006",
          "Description": "SUSE Bug 1158006"
        },
        {
          "URL": "https://bugzilla.suse.com/1178658",
          "Description": "SUSE Bug 1178658"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19581",
      "Description": "An issue was discovered in Xen through 4.12.x allowing 32-bit Arm guest OS users to cause a denial of service (out-of-bounds access) because certain bit iteration is mishandled. In a number of places bitmaps are being used by the hypervisor to track certain state. Iteration over all bits involves functions which may misbehave in certain corner cases: On 32-bit Arm accesses to bitmaps with bit a count which is a multiple of 32, an out of bounds access may occur. A malicious guest may cause a hypervisor crash or hang, resulting in a Denial of Service (DoS). All versions of Xen are vulnerable. 32-bit Arm systems are vulnerable. 64-bit Arm systems are not vulnerable.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19581.html",
          "Description": "CVE-2019-19581"
        },
        {
          "URL": "https://bugzilla.suse.com/1158003",
          "Description": "SUSE Bug 1158003"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19582",
      "Description": "An issue was discovered in Xen through 4.12.x allowing x86 guest OS users to cause a denial of service (infinite loop) because certain bit iteration is mishandled. In a number of places bitmaps are being used by the hypervisor to track certain state. Iteration over all bits involves functions which may misbehave in certain corner cases: On x86 accesses to bitmaps with a compile time known size of 64 may incur undefined behavior, which may in particular result in infinite loops. A malicious guest may cause a hypervisor crash or hang, resulting in a Denial of Service (DoS). All versions of Xen are vulnerable. x86 systems with 64 or more nodes are vulnerable (there might not be any such systems that Xen would run on). x86 systems with less than 64 nodes are not vulnerable.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "moderate"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19582.html",
          "Description": "CVE-2019-19582"
        },
        {
          "URL": "https://bugzilla.suse.com/1158003",
          "Description": "SUSE Bug 1158003"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    },
    {
      "CVE": "CVE-2019-19583",
      "Description": "An issue was discovered in Xen through 4.12.x allowing x86 HVM/PVH guest OS users to cause a denial of service (guest OS crash) because VMX VMEntry checks mishandle a certain case. Please see XSA-260 for background on the MovSS shadow. Please see XSA-156 for background on the need for #DB interception. The VMX VMEntry checks do not like the exact combination of state which occurs when #DB in intercepted, Single Stepping is active, and blocked by STI/MovSS is active, despite this being a legitimate state to be in. The resulting VMEntry failure is fatal to the guest. HVM/PVH guest userspace code may be able to crash the guest, resulting in a guest Denial of Service. All versions of Xen are affected. Only systems supporting VMX hardware virtual extensions (Intel, Cyrix, or Zhaoxin CPUs) are affected. Arm and AMD systems are unaffected. Only HVM/PVH guests are affected. PV guests cannot leverage the vulnerability.",
      "Threats": [
        {
          "Type": "Impact",
          "Severity": "important"
        }
      ],
      "References": [
        {
          "URL": "https://www.suse.com/security/cve/CVE-2019-19583.html",
          "Description": "CVE-2019-19583"
        },
        {
          "URL": "https://bugzilla.suse.com/1158004",
          "Description": "SUSE Bug 1158004"
        },
        {
          "URL": "https://bugzilla.suse.com/1178658",
          "Description": "SUSE Bug 1178658"
        }
      ],
      "ProductStatuses": [
        {
          "Type": "Fixed",
          "ProductID": [
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-CHOST-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM-BYOS:xen-tools-domU-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-libs-4.10.4_08-3.28.1",
            "Image SLES15-SAP-EC2-HVM:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-libs-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Basesystem 15:xen-tools-domU-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-devel-4.10.4_08-3.28.1",
            "SUSE Linux Enterprise Module for Server Applications 15:xen-tools-4.10.4_08-3.28.1"
          ]
        }
      ],
      "CVSSScoreSets": {}
    }
  ]
}