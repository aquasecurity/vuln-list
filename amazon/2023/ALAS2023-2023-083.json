{
  "id": "ALAS2023-2023-083",
  "title": "Amazon Linux 2023 - ALAS2023-2023-083: Medium priority package update for curl",
  "issued": {
    "date": "2023-02-17 20:47:00"
  },
  "updated": {
    "date": "2023-02-22 23:29:00"
  },
  "severity": "Medium",
  "description": "Package updates are available for Amazon Linux 2023 that fix the following vulnerabilities:\nCVE-2022-43552:\n\tA vulnerability was found in curl. In this issue, curl can be asked to tunnel all protocols virtually it supports through an HTTP proxy. HTTP proxies can deny these tunnel operations using an appropriate HTTP error response code. When getting denied to tunnel the specific SMB or TELNET protocols, curl can use a heap-allocated struct after it has been freed and shut down the code path in its transfer.\n\nCVE-2022-43551:\n\tA vulnerability exists in curl \u003c7.87.0 HSTS check that could be bypassed to trick it to keep using HTTP. Using its HSTS support, curl can be instructed to use HTTPS instead of using an insecure clear-text HTTP step even when HTTP is provided in the URL. However, the HSTS mechanism could be bypassed if the host name in the given URL first uses IDN characters that get replaced to ASCII counterparts as part of the IDN conversion. Like using the character UTF-8 U+3002 (IDEOGRAPHIC FULL STOP) instead of the common ASCII full stop (U+002E) `.`. Then in a subsequent request, it does not detect the HSTS state and makes a clear text transfer. Because it would store the info IDN encoded but look for it IDN decoded.\n\nCVE-2022-42916:\n\tA vulnerability was found in curl. The issue occurs because curl's HSTS check can be bypassed to trick it to keep using HTTP. Using its HSTS support, it can instruct curl to use HTTPS directly instead of using an insecure clear-text HTTP step even when HTTP is provided in the URL. This mechanism can be bypassed if the hostname in the given URL uses IDN characters that get replaced with ASCII counterparts as part of the IDN conversion. Like using the character UTF-8 U+3002 (IDEOGRAPHIC FULL STOP) instead of the common ASCII full stop (U+002E) .\n\nCVE-2022-42915:\n\tA vulnerability was found in curl. The issue occurs if curl is told to use an HTTP proxy for a transfer with a non-HTTP(S) URL. It sets up the connection to the remote server by issuing a `CONNECT` request to the proxy and then tunnels the rest of the protocol through. An HTTP proxy might refuse this request (HTTP proxies often only allow outgoing connections to specific port numbers, like 443 for HTTPS) and instead return a non-200 response code to the client. Due to flaws in the error/cleanup handling, this could trigger a double-free issue in curl if using one of the following schemes in the URL for the transfer: `dict,` `gopher,` `gophers,` `ldap`, `ldaps`, `rtmp`, `rtmps`, `telnet.`\n\nCVE-2022-35260:\n\tA vulnerability was found in curl. The issue occurs when curl is told to parse a `.netrc` file for credentials. If that file ends in a line with consecutive non-white space letters and no newline, curl could read past the end of the stack-based buffer, and if the read works, it can write a zero byte beyond its boundary. This issue, in most cases, causes a segfault or similar problem. A denial of service can occur if a malicious user can provide a custom netrc file to an application or otherwise affect its contents.\n\nCVE-2022-35252:\n\tA vulnerability found in curl. This security flaw happens when curl is used to retrieve and parse cookies from an HTTP(S) server, where it accepts cookies using control codes (byte values below 32), and also when cookies that contain such control codes are later sent back to an HTTP(S) server, possibly causing the server to return a 400 response. This issue effectively allows a \"sister site\" to deny service to siblings and cause a denial of service attack.\n\nCVE-2022-32221:\n\tA vulnerability was found in curl. The issue occurs when doing HTTP(S) transfers, where curl might erroneously use the read callback () to ask for data to send, even when the  option has been set if it previously used the same handle to issue a  request which used that callback. This flaw may surprise the application and cause it to misbehave and either send off the wrong data or use memory after free or similar in the subsequent  request.\n\nCVE-2022-32208:\n\tA vulnerability was found in curl. This issue occurs because it mishandles message verification failures when curl does FTP transfers secured by krb5. This flaw makes it possible for a Man-in-the-middle attack to go unnoticed and allows data injection into the client.\n\nCVE-2022-32207:\n\tA vulnerability was found in curl. This issue occurs because when curl saves cookies, alt-svc, and HSTS data to local files, it makes the operation atomic by finalizing the process with a rename from a temporary name to the final target file name. This flaw leads to unpreserved file permissions, either by mistake or by a malicious actor.\n\nCVE-2022-32206:\n\tA vulnerability was found in curl. This issue occurs because the number of acceptable \"links\" in the \"decompression chain\" was unbounded, allowing a malicious server to insert a virtually unlimited number of compression steps. This flaw leads to a denial of service, either by mistake or by a malicious actor.\n\nCVE-2022-32205:\n\tA vulnerability was found in curl. This issue occurs because a malicious server can serve excessive amounts of `Set-Cookie:` headers in an HTTP response to curl, which stores all of them. This flaw leads to a denial of service, either by mistake or by a malicious actor.\n\nCVE-2022-30115:\n\tA vulnerability was found in curl. This issue occurs because when using its HTTP Strict Transport Security(HSTS) support, it can instruct curl to use HTTPS directly instead of using an insecure clear text HTTP step even when HTTP is provided in the URL. This flaw leads to a clear text transmission of sensitive information.\n\nCVE-2022-27782:\n\tA vulnerability was found in curl. This issue occurs because curl can reuse a previously created connection even when a TLS or SSH-related option is changed that should have prohibited reuse. This flaw leads to an authentication bypass, either by mistake or by a malicious actor.\n\nCVE-2022-27780:\n\tA vulnerability was found in curl. This issue occurs because the curl URL parser wrongly accepts percent-encoded URL separators like / when decoding the hostname part of a URL, making it a different URL using the wrong hostname when it is later retrieved. This flaw allows a malicious actor to make circumventing filters.\n\nCVE-2022-27779:\n\tA vulnerability was found in curl. The issue occurs because curl wrongly allows HTTP cookies to be set for Top Level Domains (TLDs) if the hostname is provided with a trailing dot. This flaw allows arbitrary sites to set cookies that get sent to a different and unrelated site or domain by a malicious actor.\n\nCVE-2022-27776:\n\tA vulnerability was found in curl. This security flaw allows leak authentication or cookie header data on HTTP redirects to the same host but another port number. Sending the same set of headers to a server on a different port number is a problem for applications that pass on custom `Authorization:` or `Cookie:`headers. Those headers often contain privacy-sensitive information or data.\n\nCVE-2022-27775:\n\tA vulnerability was found in curl. This security flaw occurs due to errors in the logic where the config matching function did not take the IPv6 address zone id into account. This issue can lead to curl reusing the wrong connection when one transfer uses a zone id, and the subsequent transfer uses another.\n\nCVE-2022-27774:\n\tA vulnerability was found in curl. This security flaw allows leaking credentials to other servers when it follows redirects from auth-protected HTTP(S) URLs to other protocols and port numbers.\n\nCVE-2022-22576:\n\tA vulnerability was found in curl. This security flaw allows reusing OAUTH2-authenticated connections without properly ensuring that the connection was authenticated with the same credentials set for this transfer. This issue leads to an authentication bypass, either by mistake or by a malicious actor.\n",
  "packages": [
    {
      "name": "curl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/curl-debuginfo-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libcurl-minimal-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "curl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/curl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "curl-debugsource",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/curl-debugsource-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libcurl-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "curl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/curl-minimal-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libcurl-debuginfo-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libcurl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "curl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/curl-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl-devel",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libcurl-devel-7.87.0-2.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libcurl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/libcurl-debuginfo-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "libcurl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/libcurl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "curl-debugsource",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/curl-debugsource-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "libcurl-devel",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/libcurl-devel-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "curl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/curl-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "libcurl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/libcurl-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "curl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/curl-debuginfo-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "libcurl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/libcurl-minimal-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "curl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/curl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "curl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "i686",
      "filename": "Packages/curl-minimal-7.87.0-2.amzn2023.0.2.i686.rpm"
    },
    {
      "name": "libcurl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libcurl-debuginfo-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "curl-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/curl-debuginfo-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "curl-debugsource",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/curl-debugsource-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libcurl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libcurl-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libcurl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libcurl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "curl",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/curl-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "curl-minimal-debuginfo",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/curl-minimal-debuginfo-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libcurl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libcurl-minimal-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "curl-minimal",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/curl-minimal-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libcurl-devel",
      "epoch": "0",
      "version": "7.87.0",
      "release": "2.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libcurl-devel-7.87.0-2.amzn2023.0.2.aarch64.rpm"
    }
  ],
  "references": [
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22576",
      "id": "CVE-2022-22576",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27774",
      "id": "CVE-2022-27774",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27775",
      "id": "CVE-2022-27775",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27776",
      "id": "CVE-2022-27776",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27779",
      "id": "CVE-2022-27779",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27780",
      "id": "CVE-2022-27780",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27782",
      "id": "CVE-2022-27782",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30115",
      "id": "CVE-2022-30115",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32205",
      "id": "CVE-2022-32205",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32206",
      "id": "CVE-2022-32206",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32207",
      "id": "CVE-2022-32207",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32208",
      "id": "CVE-2022-32208",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32221",
      "id": "CVE-2022-32221",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35252",
      "id": "CVE-2022-35252",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35260",
      "id": "CVE-2022-35260",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42915",
      "id": "CVE-2022-42915",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42916",
      "id": "CVE-2022-42916",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43551",
      "id": "CVE-2022-43551",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43552",
      "id": "CVE-2022-43552",
      "type": "cve"
    }
  ],
  "cveids": [
    "CVE-2022-22576",
    "CVE-2022-27774",
    "CVE-2022-27775",
    "CVE-2022-27776",
    "CVE-2022-27779",
    "CVE-2022-27780",
    "CVE-2022-27782",
    "CVE-2022-30115",
    "CVE-2022-32205",
    "CVE-2022-32206",
    "CVE-2022-32207",
    "CVE-2022-32208",
    "CVE-2022-32221",
    "CVE-2022-35252",
    "CVE-2022-35260",
    "CVE-2022-42915",
    "CVE-2022-42916",
    "CVE-2022-43551",
    "CVE-2022-43552"
  ]
}