{
  "id": "ALAS2023-2025-1155",
  "title": "Amazon Linux 2023 - ALAS2023-2025-1155: Medium priority package update for libssh",
  "issued": {
    "date": "2025-08-18 23:13:00"
  },
  "updated": {
    "date": "2025-09-08 11:07:00"
  },
  "severity": "Medium",
  "description": "Package updates are available for Amazon Linux 2023 that fix the following vulnerabilities:\nCVE-2025-5987:\n\tIf there is an error in initializing ChaCha20 cipher with OpenSSL, an invalid\nerror code is returned. This can happen if there is an heap exhaustion.  This\nerror is not correctly detected and could allow libssh to use partially\ninitialized cipher context.\n\nThis is caused by the mismatch of return value meaning from OpenSSL and libssh,\nwhere OpenSSL error (rv=0) aliases with SSH_OK (0) and is returned directly\nfrom the function chacha20_poly1305_set_key(). This will likely cause error\nsomewhere down the road.\n\nCVE-2025-5351:\n\tpki_key_to_blob() can cause a double free on certain errors when using OpenSSL\n\u003e= 3.0.  The function is used by different other functions which allow to\nexport public or private keys to blobs or base64.\n\nThe function is using the variable params without resetting it to NULL after\nfree.  In case of low-memory conditions when the allocation of string fails,\nthe libssh calls the OSSL_PARAM_free() with the same arguments, which will\nlikely crash.\n\nCVE-2025-5318:\n\tAn incorrect comparison check allows to read beyond bounds in the sftp_handle() in the sftp server implementation. Thus an invalid pointer is returned as the handle and we try to continue using that.\n\nCVE-2025-4878:\n\tThe privatekey_from_file() uses an uninitialized variable under certain\nconditions, such as if the file specified by the filename argument doesn't\nexist. This causes the code to return an invalid private key.\n\nThis defect, in turn, might cause signing failure. The bug might also cause a\nUse-After-Free or corrupt the heap.\n\nNote that privatekey_from_file() is a deprecated function and shouldn't be used\nanymore!\n",
  "packages": [
    {
      "name": "libssh-debugsource",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libssh-debugsource-0.10.6-1.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libssh-debuginfo",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libssh-debuginfo-0.10.6-1.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libssh",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libssh-0.10.6-1.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libssh-devel",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "x86_64",
      "filename": "Packages/libssh-devel-0.10.6-1.amzn2023.0.2.x86_64.rpm"
    },
    {
      "name": "libssh-config",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "noarch",
      "filename": "Packages/libssh-config-0.10.6-1.amzn2023.0.2.noarch.rpm"
    },
    {
      "name": "libssh-debugsource",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libssh-debugsource-0.10.6-1.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libssh-debuginfo",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libssh-debuginfo-0.10.6-1.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libssh",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libssh-0.10.6-1.amzn2023.0.2.aarch64.rpm"
    },
    {
      "name": "libssh-devel",
      "epoch": "0",
      "version": "0.10.6",
      "release": "1.amzn2023.0.2",
      "arch": "aarch64",
      "filename": "Packages/libssh-devel-0.10.6-1.amzn2023.0.2.aarch64.rpm"
    }
  ],
  "references": [
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-4878",
      "id": "CVE-2025-4878",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-5318",
      "id": "CVE-2025-5318",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-5351",
      "id": "CVE-2025-5351",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-5987",
      "id": "CVE-2025-5987",
      "type": "cve"
    }
  ],
  "cveids": [
    "CVE-2025-4878",
    "CVE-2025-5318",
    "CVE-2025-5351",
    "CVE-2025-5987"
  ]
}