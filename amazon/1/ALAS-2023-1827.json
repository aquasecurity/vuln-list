{
  "id": "ALAS-2023-1827",
  "title": "Amazon Linux AMI 2014.03 - ALAS-2023-1827: important priority package update for kernel",
  "issued": {
    "date": "2023-09-13 23:15"
  },
  "updated": {
    "date": "2023-09-27 22:15"
  },
  "severity": "important",
  "description": "Package updates are available for Amazon Linux AMI that fix the following vulnerabilities:\nCVE-2023-4208:\n\tA use-after-free vulnerability in the Linux kernel's net/sched: cls_u32 component can be exploited to achieve local privilege escalation.\n\nWhen u32_change() is called on an existing filter, the whole tcf_result struct is always copied into the new instance of the filter. This causes a problem when updating a filter bound to a class, as tcf_unbind_filter() is always called on the old instance in the success path, decreasing filter_cnt of the still referenced class and allowing it to be deleted, leading to a use-after-free.\n\nWe recommend upgrading past commit 3044b16e7c6fe5d24b1cdbcf1bd0a9d92d1ebd81.\n\nCVE-2023-4206:\n\tA use-after-free vulnerability in the Linux kernel's net/sched: cls_route component can be exploited to achieve local privilege escalation.\n\nWhen route4_change() is called on an existing filter, the whole tcf_result struct is always copied into the new instance of the filter. This causes a problem when updating a filter bound to a class, as tcf_unbind_filter() is always called on the old instance in the success path, decreasing filter_cnt of the still referenced class and allowing it to be deleted, leading to a use-after-free.\n\nWe recommend upgrading past commit b80b829e9e2c1b3f7aae34855e04d8f6ecaf13c8.\n\nCVE-2023-4128:\n\tA use-after-free flaw was found in net/sched/cls_fw.c in classifiers (cls_fw, cls_u32, and cls_route) in the Linux Kernel. This flaw allows a local attacker to perform a local privilege escalation due to incorrect handling of the existing filter, leading to a kernel information leak issue.\n\nCVE-2023-34319:\n\tA buffer overrun vulnerability was found in the netback driver in Xen due to an unusual split packet. This flaw allows an unprivileged guest to cause a denial of service (DoS) of the host by sending network packets to the backend, causing the backend to crash.\n\nCVE-2023-3390:\n\tA use-after-free vulnerability was found in the Linux kernel's netfilter subsystem in net/netfilter/nf_tables_api.c.\n\nMishandled error handling with NFT_MSG_NEWRULE makes it possible to use a dangling pointer in the same transaction causing a use-after-free vulnerability. This flaw allows a local attacker with user access to cause a privilege escalation issue.\n\nWe recommend upgrading past commit 1240eb93f0616b21c675416516ff3d74798fdc97.\n",
  "packages": [
    {
      "name": "kernel-debuginfo-common-x86_64",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-debuginfo-common-x86_64-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-debuginfo-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "perf-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/perf-debuginfo-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-devel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-devel-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "perf",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/perf-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-headers",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-headers-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-tools",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-tools-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-tools-devel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-tools-devel-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "kernel-tools-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "x86_64",
      "filename": "Packages/kernel-tools-debuginfo-4.14.322-170.535.amzn1.x86_64.rpm"
    },
    {
      "name": "perf-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/perf-debuginfo-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-devel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-devel-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-tools-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-tools-debuginfo-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-debuginfo",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-debuginfo-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-tools-devel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-tools-devel-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-debuginfo-common-i686",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-debuginfo-common-i686-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "perf",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/perf-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-tools",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-tools-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-4.14.322-170.535.amzn1.i686.rpm"
    },
    {
      "name": "kernel-headers",
      "epoch": "0",
      "version": "4.14.322",
      "release": "170.535.amzn1",
      "arch": "i686",
      "filename": "Packages/kernel-headers-4.14.322-170.535.amzn1.i686.rpm"
    }
  ],
  "references": [
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3390",
      "id": "CVE-2023-3390",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34319",
      "id": "CVE-2023-34319",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4128",
      "id": "CVE-2023-4128",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4206",
      "id": "CVE-2023-4206",
      "type": "cve"
    },
    {
      "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4208",
      "id": "CVE-2023-4208",
      "type": "cve"
    }
  ],
  "cveids": [
    "CVE-2023-3390",
    "CVE-2023-34319",
    "CVE-2023-4128",
    "CVE-2023-4206",
    "CVE-2023-4208"
  ]
}